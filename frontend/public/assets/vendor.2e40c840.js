var ft=Object.defineProperty,gt=Object.defineProperties;var pt=Object.getOwnPropertyDescriptors;var $e=Object.getOwnPropertySymbols;var at=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable;var ut=(e,t,i)=>t in e?ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Pe=(e,t)=>{for(var i in t||(t={}))at.call(t,i)&&ut(e,i,t[i]);if($e)for(var i of $e(t))lt.call(t,i)&&ut(e,i,t[i]);return e},et=(e,t)=>gt(e,pt(t));var ct=(e,t)=>{var i={};for(var n in e)at.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(e!=null&&$e)for(var n of $e(e))t.indexOf(n)<0&&lt.call(e,n)&&(i[n]=e[n]);return i};function noop$3(){}const identity=e=>e;function assign(e,t){for(const i in t)e[i]=t[i];return e}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return typeof e=="function"}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function is_empty(e){return Object.keys(e).length===0}function subscribe(e,...t){if(e==null)return noop$3;const i=e.subscribe(...t);return i.unsubscribe?()=>i.unsubscribe():i}function component_subscribe(e,t,i){e.$$.on_destroy.push(subscribe(t,i))}function create_slot(e,t,i,n){if(e){const r=get_slot_context(e,t,i,n);return e[0](r)}}function get_slot_context(e,t,i,n){return e[1]&&n?assign(i.ctx.slice(),e[1](n(t))):i.ctx}function get_slot_changes(e,t,i,n){if(e[2]&&n){const r=e[2](n(i));if(t.dirty===void 0)return r;if(typeof r=="object"){const o=[],s=Math.max(t.dirty.length,r.length);for(let a=0;a<s;a+=1)o[a]=t.dirty[a]|r[a];return o}return t.dirty|r}return t.dirty}function update_slot_base(e,t,i,n,r,o){if(r){const s=get_slot_context(t,i,n,o);e.p(s,r)}}function get_all_dirty_from_scope(e){if(e.ctx.length>32){const t=[],i=e.ctx.length/32;for(let n=0;n<i;n++)t[n]=-1;return t}return-1}function null_to_empty(e){return e==null?"":e}function action_destroyer(e){return e&&is_function(e.destroy)?e.destroy:noop$3}const is_client=typeof window!="undefined";let now=is_client?()=>window.performance.now():()=>Date.now(),raf=is_client?e=>requestAnimationFrame(e):noop$3;const tasks=new Set;function run_tasks(e){tasks.forEach(t=>{t.c(e)||(tasks.delete(t),t.f())}),tasks.size!==0&&raf(run_tasks)}function loop$1(e){let t;return tasks.size===0&&raf(run_tasks),{promise:new Promise(i=>{tasks.add(t={c:e,f:i})}),abort(){tasks.delete(t)}}}function append(e,t){e.appendChild(t)}function get_root_for_style(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function append_empty_stylesheet(e){const t=element("style");return append_stylesheet(get_root_for_style(e),t),t}function append_stylesheet(e,t){append(e.head||e,t)}function insert(e,t,i){e.insertBefore(t,i||null)}function detach(e){e.parentNode.removeChild(e)}function destroy_each(e,t){for(let i=0;i<e.length;i+=1)e[i]&&e[i].d(t)}function element(e){return document.createElement(e)}function svg_element(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,t,i,n){return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i,n)}function attr(e,t,i){i==null?e.removeAttribute(t):e.getAttribute(t)!==i&&e.setAttribute(t,i)}function set_svg_attributes(e,t){for(const i in t)attr(e,i,t[i])}function children(e){return Array.from(e.childNodes)}function set_data(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function set_input_value(e,t){e.value=t==null?"":t}function toggle_class(e,t,i){e.classList[i?"add":"remove"](t)}function custom_event(e,t,i=!1){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,i,!1,t),n}const active_docs=new Set;let active=0;function hash(e){let t=5381,i=e.length;for(;i--;)t=(t<<5)-t^e.charCodeAt(i);return t>>>0}function create_rule(e,t,i,n,r,o,s,a=0){const l=16.666/n;let c=`{
`;for(let u=0;u<=1;u+=l){const m=t+(i-t)*o(u);c+=u*100+`%{${s(m,1-m)}}
`}const g=c+`100% {${s(i,1-i)}}
}`,v=`__svelte_${hash(g)}_${a}`,p=get_root_for_style(e);active_docs.add(p);const w=p.__svelte_stylesheet||(p.__svelte_stylesheet=append_empty_stylesheet(e).sheet),E=p.__svelte_rules||(p.__svelte_rules={});E[v]||(E[v]=!0,w.insertRule(`@keyframes ${v} ${g}`,w.cssRules.length));const b=e.style.animation||"";return e.style.animation=`${b?`${b}, `:""}${v} ${n}ms linear ${r}ms 1 both`,active+=1,v}function delete_rule(e,t){const i=(e.style.animation||"").split(", "),n=i.filter(t?o=>o.indexOf(t)<0:o=>o.indexOf("__svelte")===-1),r=i.length-n.length;r&&(e.style.animation=n.join(", "),active-=r,active||clear_rules())}function clear_rules(){raf(()=>{active||(active_docs.forEach(e=>{const t=e.__svelte_stylesheet;let i=t.cssRules.length;for(;i--;)t.deleteRule(i);e.__svelte_rules={}}),active_docs.clear())})}function create_animation(e,t,i,n){if(!t)return noop$3;const r=e.getBoundingClientRect();if(t.left===r.left&&t.right===r.right&&t.top===r.top&&t.bottom===r.bottom)return noop$3;const{delay:o=0,duration:s=300,easing:a=identity,start:l=now()+o,end:c=l+s,tick:g=noop$3,css:v}=i(e,{from:t,to:r},n);let p=!0,w=!1,E;function b(){v&&(E=create_rule(e,0,1,s,o,a,v)),o||(w=!0)}function u(){v&&delete_rule(e,E),p=!1}return loop$1(m=>{if(!w&&m>=l&&(w=!0),w&&m>=c&&(g(1,0),u()),!p)return!1;if(w){const S=m-l,x=0+1*a(S/s);g(x,1-x)}return!0}),b(),g(0,1),u}function fix_position(e){const t=getComputedStyle(e);if(t.position!=="absolute"&&t.position!=="fixed"){const{width:i,height:n}=t,r=e.getBoundingClientRect();e.style.position="absolute",e.style.width=i,e.style.height=n,add_transform(e,r)}}function add_transform(e,t){const i=e.getBoundingClientRect();if(t.left!==i.left||t.top!==i.top){const n=getComputedStyle(e),r=n.transform==="none"?"":n.transform;e.style.transform=`${r} translate(${t.left-i.left}px, ${t.top-i.top}px)`}}let current_component;function set_current_component(e){current_component=e}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(e){get_current_component().$$.on_mount.push(e)}function afterUpdate(e){get_current_component().$$.after_update.push(e)}function onDestroy(e){get_current_component().$$.on_destroy.push(e)}function createEventDispatcher(){const e=get_current_component();return(t,i)=>{const n=e.$$.callbacks[t];if(n){const r=custom_event(t,i);n.slice().forEach(o=>{o.call(e,r)})}}}function setContext(e,t){get_current_component().$$.context.set(e,t)}function getContext(e){return get_current_component().$$.context.get(e)}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(e){render_callbacks.push(e)}function add_flush_callback(e){flush_callbacks.push(e)}let flushing=!1;const seen_callbacks=new Set;function flush(){if(!flushing){flushing=!0;do{for(let e=0;e<dirty_components.length;e+=1){const t=dirty_components[e];set_current_component(t),update(t.$$)}for(set_current_component(null),dirty_components.length=0;binding_callbacks.length;)binding_callbacks.pop()();for(let e=0;e<render_callbacks.length;e+=1){const t=render_callbacks[e];seen_callbacks.has(t)||(seen_callbacks.add(t),t())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,flushing=!1,seen_callbacks.clear()}}function update(e){if(e.fragment!==null){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}let promise;function wait(){return promise||(promise=Promise.resolve(),promise.then(()=>{promise=null})),promise}function dispatch(e,t,i){e.dispatchEvent(custom_event(`${t?"intro":"outro"}${i}`))}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,i,n){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push(()=>{outroing.delete(e),n&&(i&&e.d(1),n())}),e.o(t)}}const null_transition={duration:0};function create_in_transition(e,t,i){let n=t(e,i),r=!1,o,s,a=0;function l(){o&&delete_rule(e,o)}function c(){const{delay:v=0,duration:p=300,easing:w=identity,tick:E=noop$3,css:b}=n||null_transition;b&&(o=create_rule(e,0,1,p,v,w,b,a++)),E(0,1);const u=now()+v,m=u+p;s&&s.abort(),r=!0,add_render_callback(()=>dispatch(e,!0,"start")),s=loop$1(S=>{if(r){if(S>=m)return E(1,0),dispatch(e,!0,"end"),l(),r=!1;if(S>=u){const x=w((S-u)/p);E(x,1-x)}}return r})}let g=!1;return{start(){g||(g=!0,delete_rule(e),is_function(n)?(n=n(),wait().then(c)):c())},invalidate(){g=!1},end(){r&&(l(),r=!1)}}}function create_out_transition(e,t,i){let n=t(e,i),r=!0,o;const s=outros;s.r+=1;function a(){const{delay:l=0,duration:c=300,easing:g=identity,tick:v=noop$3,css:p}=n||null_transition;p&&(o=create_rule(e,1,0,c,l,g,p));const w=now()+l,E=w+c;add_render_callback(()=>dispatch(e,!1,"start")),loop$1(b=>{if(r){if(b>=E)return v(0,1),dispatch(e,!1,"end"),--s.r||run_all(s.c),!1;if(b>=w){const u=g((b-w)/c);v(1-u,u)}}return r})}return is_function(n)?wait().then(()=>{n=n(),a()}):a(),{end(l){l&&n.tick&&n.tick(1,0),r&&(o&&delete_rule(e,o),r=!1)}}}function create_bidirectional_transition(e,t,i,n){let r=t(e,i),o=n?0:1,s=null,a=null,l=null;function c(){l&&delete_rule(e,l)}function g(p,w){const E=p.b-o;return w*=Math.abs(E),{a:o,b:p.b,d:E,duration:w,start:p.start,end:p.start+w,group:p.group}}function v(p){const{delay:w=0,duration:E=300,easing:b=identity,tick:u=noop$3,css:m}=r||null_transition,S={start:now()+w,b:p};p||(S.group=outros,outros.r+=1),s||a?a=S:(m&&(c(),l=create_rule(e,o,p,E,w,b,m)),p&&u(0,1),s=g(S,E),add_render_callback(()=>dispatch(e,p,"start")),loop$1(x=>{if(a&&x>a.start&&(s=g(a,E),a=null,dispatch(e,s.b,"start"),m&&(c(),l=create_rule(e,o,s.b,s.duration,0,b,r.css))),s){if(x>=s.end)u(o=s.b,1-o),dispatch(e,s.b,"end"),a||(s.b?c():--s.group.r||run_all(s.group.c)),s=null;else if(x>=s.start){const D=x-s.start;o=s.a+s.d*b(D/s.duration),u(o,1-o)}}return!!(s||a)}))}return{run(p){is_function(r)?wait().then(()=>{r=r(),v(p)}):v(p)},end(){c(),s=a=null}}}const globals=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function destroy_block(e,t){e.d(1),t.delete(e.key)}function fix_and_destroy_block(e,t){e.f(),destroy_block(e,t)}function update_keyed_each(e,t,i,n,r,o,s,a,l,c,g,v){let p=e.length,w=o.length,E=p;const b={};for(;E--;)b[e[E].key]=E;const u=[],m=new Map,S=new Map;for(E=w;E--;){const M=v(r,o,E),R=i(M);let L=s.get(R);L?n&&L.p(M,t):(L=c(R,M),L.c()),m.set(R,u[E]=L),R in b&&S.set(R,Math.abs(E-b[R]))}const x=new Set,D=new Set;function I(M){transition_in(M,1),M.m(a,g),s.set(M.key,M),g=M.first,w--}for(;p&&w;){const M=u[w-1],R=e[p-1],L=M.key,G=R.key;M===R?(g=M.first,p--,w--):m.has(G)?!s.has(L)||x.has(L)?I(M):D.has(G)?p--:S.get(L)>S.get(G)?(D.add(L),I(M)):(x.add(G),p--):(l(R,s),p--)}for(;p--;){const M=e[p];m.has(M.key)||l(M,s)}for(;w;)I(u[w-1]);return u}function get_spread_update(e,t){const i={},n={},r={$$scope:1};let o=e.length;for(;o--;){const s=e[o],a=t[o];if(a){for(const l in s)l in a||(n[l]=1);for(const l in a)r[l]||(i[l]=a[l],r[l]=1);e[o]=a}else for(const l in s)r[l]=1}for(const s in n)s in i||(i[s]=void 0);return i}function bind$1(e,t,i){const n=e.$$.props[t];n!==void 0&&(e.$$.bound[n]=i,i(e.$$.ctx[n]))}function create_component(e){e&&e.c()}function mount_component(e,t,i,n){const{fragment:r,on_mount:o,on_destroy:s,after_update:a}=e.$$;r&&r.m(t,i),n||add_render_callback(()=>{const l=o.map(run).filter(is_function);s?s.push(...l):run_all(l),e.$$.on_mount=[]}),a.forEach(add_render_callback)}function destroy_component(e,t){const i=e.$$;i.fragment!==null&&(run_all(i.on_destroy),i.fragment&&i.fragment.d(t),i.on_destroy=i.fragment=null,i.ctx=[])}function make_dirty(e,t){e.$$.dirty[0]===-1&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,i,n,r,o,s,a=[-1]){const l=current_component;set_current_component(e);const c=e.$$={fragment:null,ctx:null,props:o,update:noop$3,not_equal:r,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:blank_object(),dirty:a,skip_bound:!1,root:t.target||l.$$.root};s&&s(c.root);let g=!1;if(c.ctx=i?i(e,t.props||{},(v,p,...w)=>{const E=w.length?w[0]:p;return c.ctx&&r(c.ctx[v],c.ctx[v]=E)&&(!c.skip_bound&&c.bound[v]&&c.bound[v](E),g&&make_dirty(e,v)),p}):[],c.update(),g=!0,run_all(c.before_update),c.fragment=n?n(c.ctx):!1,t.target){if(t.hydrate){const v=children(t.target);c.fragment&&c.fragment.l(v),v.forEach(detach)}else c.fragment&&c.fragment.c();t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor,t.customElement),flush()}set_current_component(l)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop$3}$on(t,i){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(i),()=>{const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}$set(t){this.$$set&&!is_empty(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const subscriber_queue=[];function writable(e,t=noop$3){let i;const n=new Set;function r(a){if(safe_not_equal(e,a)&&(e=a,i)){const l=!subscriber_queue.length;for(const c of n)c[1](),subscriber_queue.push(c,e);if(l){for(let c=0;c<subscriber_queue.length;c+=2)subscriber_queue[c][0](subscriber_queue[c+1]);subscriber_queue.length=0}}}function o(a){r(a(e))}function s(a,l=noop$3){const c=[a,l];return n.add(c),n.size===1&&(i=t(r)||noop$3),a(e),()=>{n.delete(c),n.size===0&&(i(),i=null)}}return{set:r,update:o,subscribe:s}}function cubicOut(e){const t=e-1;return t*t*t+1}function fade(e,{delay:t=0,duration:i=400,easing:n=identity}={}){const r=+getComputedStyle(e).opacity;return{delay:t,duration:i,easing:n,css:o=>`opacity: ${o*r}`}}function create_fragment$5(e){let t,i,n=[{id:i="path-"+e[0]},e[1]],r={};for(let o=0;o<n.length;o+=1)r=assign(r,n[o]);return{c(){t=svg_element("path"),set_svg_attributes(t,r)},m(o,s){insert(o,t,s)},p(o,[s]){set_svg_attributes(t,r=get_spread_update(n,[s&1&&i!==(i="path-"+o[0])&&{id:i},s&2&&o[1]]))},i:noop$3,o:noop$3,d(o){o&&detach(t)}}}function instance$5(e,t,i){let{id:n}=t,{data:r={}}=t;return e.$$set=o=>{"id"in o&&i(0,n=o.id),"data"in o&&i(1,r=o.data)},[n,r]}class Path extends SvelteComponent{constructor(t){super();init(this,t,instance$5,create_fragment$5,safe_not_equal,{id:0,data:1})}}function create_fragment$4(e){let t,i,n=[{id:i="polygon-"+e[0]},e[1]],r={};for(let o=0;o<n.length;o+=1)r=assign(r,n[o]);return{c(){t=svg_element("polygon"),set_svg_attributes(t,r)},m(o,s){insert(o,t,s)},p(o,[s]){set_svg_attributes(t,r=get_spread_update(n,[s&1&&i!==(i="polygon-"+o[0])&&{id:i},s&2&&o[1]]))},i:noop$3,o:noop$3,d(o){o&&detach(t)}}}function instance$4(e,t,i){let{id:n}=t,{data:r={}}=t;return e.$$set=o=>{"id"in o&&i(0,n=o.id),"data"in o&&i(1,r=o.data)},[n,r]}class Polygon extends SvelteComponent{constructor(t){super();init(this,t,instance$4,create_fragment$4,safe_not_equal,{id:0,data:1})}}function create_fragment$3(e){let t;return{c(){t=svg_element("g")},m(i,n){insert(i,t,n),t.innerHTML=e[0]},p(i,[n]){n&1&&(t.innerHTML=i[0])},i:noop$3,o:noop$3,d(i){i&&detach(t)}}}function instance$3(e,t,i){let n=870711;function r(){return n+=1,`fa-${n.toString(16)}`}let o,{data:s}=t;function a(l){if(!l||!l.raw)return null;let c=l.raw;const g={};return c=c.replace(/\s(?:xml:)?id=["']?([^"')\s]+)/g,(v,p)=>{const w=r();return g[p]=w,` id="${w}"`}),c=c.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,(v,p,w,E)=>{const b=p||E;return!b||!g[b]?v:`#${g[b]}`}),c}return e.$$set=l=>{"data"in l&&i(1,s=l.data)},e.$$.update=()=>{e.$$.dirty&2&&i(0,o=a(s))},[o,s]}class Raw extends SvelteComponent{constructor(t){super();init(this,t,instance$3,create_fragment$3,safe_not_equal,{data:1})}}var Svg_svelte_svelte_type_style_lang="";function create_fragment$2(e){let t,i,n,r;const o=e[13].default,s=create_slot(o,e,e[12],null);return{c(){t=svg_element("svg"),s&&s.c(),attr(t,"version","1.1"),attr(t,"class",i="fa-icon "+e[0]+" svelte-roizm6"),attr(t,"x",e[8]),attr(t,"y",e[9]),attr(t,"width",e[1]),attr(t,"height",e[2]),attr(t,"aria-label",e[11]),attr(t,"role",n=e[11]?"img":"presentation"),attr(t,"viewBox",e[3]),attr(t,"style",e[10]),toggle_class(t,"fa-spin",e[4]),toggle_class(t,"fa-pulse",e[6]),toggle_class(t,"fa-inverse",e[5]),toggle_class(t,"fa-flip-horizontal",e[7]==="horizontal"),toggle_class(t,"fa-flip-vertical",e[7]==="vertical")},m(a,l){insert(a,t,l),s&&s.m(t,null),r=!0},p(a,[l]){s&&s.p&&(!r||l&4096)&&update_slot_base(s,o,a,a[12],r?get_slot_changes(o,a[12],l,null):get_all_dirty_from_scope(a[12]),null),(!r||l&1&&i!==(i="fa-icon "+a[0]+" svelte-roizm6"))&&attr(t,"class",i),(!r||l&256)&&attr(t,"x",a[8]),(!r||l&512)&&attr(t,"y",a[9]),(!r||l&2)&&attr(t,"width",a[1]),(!r||l&4)&&attr(t,"height",a[2]),(!r||l&2048)&&attr(t,"aria-label",a[11]),(!r||l&2048&&n!==(n=a[11]?"img":"presentation"))&&attr(t,"role",n),(!r||l&8)&&attr(t,"viewBox",a[3]),(!r||l&1024)&&attr(t,"style",a[10]),l&17&&toggle_class(t,"fa-spin",a[4]),l&65&&toggle_class(t,"fa-pulse",a[6]),l&33&&toggle_class(t,"fa-inverse",a[5]),l&129&&toggle_class(t,"fa-flip-horizontal",a[7]==="horizontal"),l&129&&toggle_class(t,"fa-flip-vertical",a[7]==="vertical")},i(a){r||(transition_in(s,a),r=!0)},o(a){transition_out(s,a),r=!1},d(a){a&&detach(t),s&&s.d(a)}}}function instance$2(e,t,i){let{$$slots:n={},$$scope:r}=t,{class:o}=t,{width:s}=t,{height:a}=t,{box:l}=t,{spin:c=!1}=t,{inverse:g=!1}=t,{pulse:v=!1}=t,{flip:p=null}=t,{x:w=void 0}=t,{y:E=void 0}=t,{style:b=void 0}=t,{label:u=void 0}=t;return e.$$set=m=>{"class"in m&&i(0,o=m.class),"width"in m&&i(1,s=m.width),"height"in m&&i(2,a=m.height),"box"in m&&i(3,l=m.box),"spin"in m&&i(4,c=m.spin),"inverse"in m&&i(5,g=m.inverse),"pulse"in m&&i(6,v=m.pulse),"flip"in m&&i(7,p=m.flip),"x"in m&&i(8,w=m.x),"y"in m&&i(9,E=m.y),"style"in m&&i(10,b=m.style),"label"in m&&i(11,u=m.label),"$$scope"in m&&i(12,r=m.$$scope)},[o,s,a,l,c,g,v,p,w,E,b,u,r,n]}class Svg extends SvelteComponent{constructor(t){super();init(this,t,instance$2,create_fragment$2,safe_not_equal,{class:0,width:1,height:2,box:3,spin:4,inverse:5,pulse:6,flip:7,x:8,y:9,style:10,label:11})}}function get_each_context(e,t,i){const n=e.slice();return n[24]=t[i],n[26]=i,n}function get_each_context_1(e,t,i){const n=e.slice();return n[27]=t[i],n[26]=i,n}function create_if_block$1(e){let t,i,n,r,o=e[6].paths&&create_if_block_3(e),s=e[6].polygons&&create_if_block_2$1(e),a=e[6].raw&&create_if_block_1$1(e);return{c(){o&&o.c(),t=space(),s&&s.c(),i=space(),a&&a.c(),n=empty()},m(l,c){o&&o.m(l,c),insert(l,t,c),s&&s.m(l,c),insert(l,i,c),a&&a.m(l,c),insert(l,n,c),r=!0},p(l,c){l[6].paths?o?(o.p(l,c),c&64&&transition_in(o,1)):(o=create_if_block_3(l),o.c(),transition_in(o,1),o.m(t.parentNode,t)):o&&(group_outros(),transition_out(o,1,1,()=>{o=null}),check_outros()),l[6].polygons?s?(s.p(l,c),c&64&&transition_in(s,1)):(s=create_if_block_2$1(l),s.c(),transition_in(s,1),s.m(i.parentNode,i)):s&&(group_outros(),transition_out(s,1,1,()=>{s=null}),check_outros()),l[6].raw?a?(a.p(l,c),c&64&&transition_in(a,1)):(a=create_if_block_1$1(l),a.c(),transition_in(a,1),a.m(n.parentNode,n)):a&&(group_outros(),transition_out(a,1,1,()=>{a=null}),check_outros())},i(l){r||(transition_in(o),transition_in(s),transition_in(a),r=!0)},o(l){transition_out(o),transition_out(s),transition_out(a),r=!1},d(l){o&&o.d(l),l&&detach(t),s&&s.d(l),l&&detach(i),a&&a.d(l),l&&detach(n)}}}function create_if_block_3(e){let t,i,n=e[6].paths,r=[];for(let s=0;s<n.length;s+=1)r[s]=create_each_block_1(get_each_context_1(e,n,s));const o=s=>transition_out(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();t=empty()},m(s,a){for(let l=0;l<r.length;l+=1)r[l].m(s,a);insert(s,t,a),i=!0},p(s,a){if(a&64){n=s[6].paths;let l;for(l=0;l<n.length;l+=1){const c=get_each_context_1(s,n,l);r[l]?(r[l].p(c,a),transition_in(r[l],1)):(r[l]=create_each_block_1(c),r[l].c(),transition_in(r[l],1),r[l].m(t.parentNode,t))}for(group_outros(),l=n.length;l<r.length;l+=1)o(l);check_outros()}},i(s){if(!i){for(let a=0;a<n.length;a+=1)transition_in(r[a]);i=!0}},o(s){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)transition_out(r[a]);i=!1},d(s){destroy_each(r,s),s&&detach(t)}}}function create_each_block_1(e){let t,i;return t=new Path({props:{id:e[26],data:e[27]}}),{c(){create_component(t.$$.fragment)},m(n,r){mount_component(t,n,r),i=!0},p(n,r){const o={};r&64&&(o.data=n[27]),t.$set(o)},i(n){i||(transition_in(t.$$.fragment,n),i=!0)},o(n){transition_out(t.$$.fragment,n),i=!1},d(n){destroy_component(t,n)}}}function create_if_block_2$1(e){let t,i,n=e[6].polygons,r=[];for(let s=0;s<n.length;s+=1)r[s]=create_each_block(get_each_context(e,n,s));const o=s=>transition_out(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();t=empty()},m(s,a){for(let l=0;l<r.length;l+=1)r[l].m(s,a);insert(s,t,a),i=!0},p(s,a){if(a&64){n=s[6].polygons;let l;for(l=0;l<n.length;l+=1){const c=get_each_context(s,n,l);r[l]?(r[l].p(c,a),transition_in(r[l],1)):(r[l]=create_each_block(c),r[l].c(),transition_in(r[l],1),r[l].m(t.parentNode,t))}for(group_outros(),l=n.length;l<r.length;l+=1)o(l);check_outros()}},i(s){if(!i){for(let a=0;a<n.length;a+=1)transition_in(r[a]);i=!0}},o(s){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)transition_out(r[a]);i=!1},d(s){destroy_each(r,s),s&&detach(t)}}}function create_each_block(e){let t,i;return t=new Polygon({props:{id:e[26],data:e[24]}}),{c(){create_component(t.$$.fragment)},m(n,r){mount_component(t,n,r),i=!0},p(n,r){const o={};r&64&&(o.data=n[24]),t.$set(o)},i(n){i||(transition_in(t.$$.fragment,n),i=!0)},o(n){transition_out(t.$$.fragment,n),i=!1},d(n){destroy_component(t,n)}}}function create_if_block_1$1(e){let t,i,n;function r(s){e[15](s)}let o={};return e[6]!==void 0&&(o.data=e[6]),t=new Raw({props:o}),binding_callbacks.push(()=>bind$1(t,"data",r)),{c(){create_component(t.$$.fragment)},m(s,a){mount_component(t,s,a),n=!0},p(s,a){const l={};!i&&a&64&&(i=!0,l.data=s[6],add_flush_callback(()=>i=!1)),t.$set(l)},i(s){n||(transition_in(t.$$.fragment,s),n=!0)},o(s){transition_out(t.$$.fragment,s),n=!1},d(s){destroy_component(t,s)}}}function fallback_block(e){let t,i,n=e[6]&&create_if_block$1(e);return{c(){n&&n.c(),t=empty()},m(r,o){n&&n.m(r,o),insert(r,t,o),i=!0},p(r,o){r[6]?n?(n.p(r,o),o&64&&transition_in(n,1)):(n=create_if_block$1(r),n.c(),transition_in(n,1),n.m(t.parentNode,t)):n&&(group_outros(),transition_out(n,1,1,()=>{n=null}),check_outros())},i(r){i||(transition_in(n),i=!0)},o(r){transition_out(n),i=!1},d(r){n&&n.d(r),r&&detach(t)}}}function create_default_slot(e){let t;const i=e[14].default,n=create_slot(i,e,e[16],null),r=n||fallback_block(e);return{c(){r&&r.c()},m(o,s){r&&r.m(o,s),t=!0},p(o,s){n?n.p&&(!t||s&65536)&&update_slot_base(n,i,o,o[16],t?get_slot_changes(i,o[16],s,null):get_all_dirty_from_scope(o[16]),null):r&&r.p&&(!t||s&64)&&r.p(o,t?s:-1)},i(o){t||(transition_in(r,o),t=!0)},o(o){transition_out(r,o),t=!1},d(o){r&&r.d(o)}}}function create_fragment$1(e){let t,i;return t=new Svg({props:{label:e[5],width:e[7],height:e[8],box:e[10],style:e[9],spin:e[1],flip:e[4],inverse:e[2],pulse:e[3],class:e[0],$$slots:{default:[create_default_slot]},$$scope:{ctx:e}}}),{c(){create_component(t.$$.fragment)},m(n,r){mount_component(t,n,r),i=!0},p(n,[r]){const o={};r&32&&(o.label=n[5]),r&128&&(o.width=n[7]),r&256&&(o.height=n[8]),r&1024&&(o.box=n[10]),r&512&&(o.style=n[9]),r&2&&(o.spin=n[1]),r&16&&(o.flip=n[4]),r&4&&(o.inverse=n[2]),r&8&&(o.pulse=n[3]),r&1&&(o.class=n[0]),r&65600&&(o.$$scope={dirty:r,ctx:n}),t.$set(o)},i(n){i||(transition_in(t.$$.fragment,n),i=!0)},o(n){transition_out(t.$$.fragment,n),i=!1},d(n){destroy_component(t,n)}}}let outerScale=1;function normaliseData(e){if("iconName"in e&&"icon"in e){let t={},i=e.icon,n=e.iconName,r=i[0],o=i[1],s=i[4],a={width:r,height:o,paths:[{d:s}]};return t[n]=a,t}return e}function instance$1(e,t,i){let{$$slots:n={},$$scope:r}=t,{class:o=""}=t,{data:s}=t,{scale:a=1}=t,{spin:l=!1}=t,{inverse:c=!1}=t,{pulse:g=!1}=t,{flip:v=null}=t,{label:p=null}=t,w=null,{style:E=null}=t,b,u,m,S;function x(){if(typeof s=="undefined")return;const k=normaliseData(s),[J]=Object.keys(k),te=k[J];te.paths||(te.paths=[]),te.d&&te.paths.push({d:te.d}),te.polygons||(te.polygons=[]),te.points&&te.polygons.push({points:te.points}),i(6,w=te)}function D(){let k=1;return typeof a!="undefined"&&(k=Number(a)),isNaN(k)||k<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.'),outerScale):k*outerScale}function I(){return w?`0 0 ${w.width} ${w.height}`:`0 0 ${b} ${u}`}function M(){return w?Math.max(w.width,w.height)/16:1}function R(){return w?w.width/M()*D():0}function L(){return w?w.height/M()*D():0}function G(){let k="";E!==null&&(k+=E);let J=D();return J===1?k.length===0?void 0:k:(k!==""&&!k.endsWith(";")&&(k+="; "),`${k}font-size: ${J}em`)}function U(k){w=k,i(6,w)}return e.$$set=k=>{"class"in k&&i(0,o=k.class),"data"in k&&i(11,s=k.data),"scale"in k&&i(12,a=k.scale),"spin"in k&&i(1,l=k.spin),"inverse"in k&&i(2,c=k.inverse),"pulse"in k&&i(3,g=k.pulse),"flip"in k&&i(4,v=k.flip),"label"in k&&i(5,p=k.label),"style"in k&&i(13,E=k.style),"$$scope"in k&&i(16,r=k.$$scope)},e.$$.update=()=>{e.$$.dirty&14336&&(x(),i(7,b=R()),i(8,u=L()),i(9,m=G()),i(10,S=I()))},[o,l,c,g,v,p,w,b,u,m,S,s,a,E,n,U,r]}class Icon extends SvelteComponent{constructor(t){super();init(this,t,instance$1,create_fragment$1,safe_not_equal,{class:0,data:11,scale:12,spin:1,inverse:2,pulse:3,flip:4,label:5,style:13})}}var Modal_svelte_svelte_type_style_lang="";const{window:window_1}=globals;function create_if_block(e){let t,i,n,r,o,s,a,l,c,g,v,p=e[0].closeButton&&create_if_block_1(e);var w=e[1];function E(b){return{}}return w&&(s=new w(E())),{c(){t=element("div"),i=element("div"),n=element("div"),p&&p.c(),r=space(),o=element("div"),s&&create_component(s.$$.fragment),attr(o,"class","content svelte-yhsyln"),attr(o,"style",e[8]),attr(n,"class","window svelte-yhsyln"),attr(n,"role","dialog"),attr(n,"aria-modal","true"),attr(n,"style",e[7]),attr(i,"class","window-wrap svelte-yhsyln"),attr(i,"style",e[6]),attr(t,"class","bg svelte-yhsyln"),attr(t,"style",e[5])},m(b,u){insert(b,t,u),append(t,i),append(i,n),p&&p.m(n,null),append(n,r),append(n,o),s&&mount_component(s,o,null),e[39](n),e[40](i),e[41](t),c=!0,g||(v=[listen(n,"introstart",function(){is_function(e[12])&&e[12].apply(this,arguments)}),listen(n,"outrostart",function(){is_function(e[13])&&e[13].apply(this,arguments)}),listen(n,"introend",function(){is_function(e[14])&&e[14].apply(this,arguments)}),listen(n,"outroend",function(){is_function(e[15])&&e[15].apply(this,arguments)}),listen(t,"mousedown",e[19]),listen(t,"mouseup",e[20])],g=!0)},p(b,u){if(e=b,e[0].closeButton?p?(p.p(e,u),u[0]&1&&transition_in(p,1)):(p=create_if_block_1(e),p.c(),transition_in(p,1),p.m(n,r)):p&&(group_outros(),transition_out(p,1,1,()=>{p=null}),check_outros()),w!==(w=e[1])){if(s){group_outros();const m=s;transition_out(m.$$.fragment,1,0,()=>{destroy_component(m,1)}),check_outros()}w?(s=new w(E()),create_component(s.$$.fragment),transition_in(s.$$.fragment,1),mount_component(s,o,null)):s=null}(!c||u[0]&256)&&attr(o,"style",e[8]),(!c||u[0]&128)&&attr(n,"style",e[7]),(!c||u[0]&64)&&attr(i,"style",e[6]),(!c||u[0]&32)&&attr(t,"style",e[5])},i(b){c||(transition_in(p),s&&transition_in(s.$$.fragment,b),add_render_callback(()=>{a||(a=create_bidirectional_transition(n,e[11],e[0].transitionWindowProps,!0)),a.run(1)}),add_render_callback(()=>{l||(l=create_bidirectional_transition(t,e[10],e[0].transitionBgProps,!0)),l.run(1)}),c=!0)},o(b){transition_out(p),s&&transition_out(s.$$.fragment,b),a||(a=create_bidirectional_transition(n,e[11],e[0].transitionWindowProps,!1)),a.run(0),l||(l=create_bidirectional_transition(t,e[10],e[0].transitionBgProps,!1)),l.run(0),c=!1},d(b){b&&detach(t),p&&p.d(),s&&destroy_component(s),e[39](null),b&&a&&a.end(),e[40](null),e[41](null),b&&l&&l.end(),g=!1,run_all(v)}}}function create_if_block_1(e){let t,i,n,r,o;const s=[create_if_block_2,create_else_block],a=[];function l(c,g){return(t==null||g[0]&1)&&(t=!!c[16](c[0].closeButton)),t?0:1}return i=l(e,[-1,-1]),n=a[i]=s[i](e),{c(){n.c(),r=empty()},m(c,g){a[i].m(c,g),insert(c,r,g),o=!0},p(c,g){let v=i;i=l(c,g),i===v?a[i].p(c,g):(group_outros(),transition_out(a[v],1,1,()=>{a[v]=null}),check_outros(),n=a[i],n?n.p(c,g):(n=a[i]=s[i](c),n.c()),transition_in(n,1),n.m(r.parentNode,r))},i(c){o||(transition_in(n),o=!0)},o(c){transition_out(n),o=!1},d(c){a[i].d(c),c&&detach(r)}}}function create_else_block(e){let t,i,n;return{c(){t=element("button"),attr(t,"class","close svelte-yhsyln"),attr(t,"style",e[9])},m(r,o){insert(r,t,o),i||(n=listen(t,"click",e[17]),i=!0)},p(r,o){o[0]&512&&attr(t,"style",r[9])},i:noop$3,o:noop$3,d(r){r&&detach(t),i=!1,n()}}}function create_if_block_2(e){let t,i,n;var r=e[0].closeButton;function o(s){return{props:{onClose:s[17]}}}return r&&(t=new r(o(e))),{c(){t&&create_component(t.$$.fragment),i=empty()},m(s,a){t&&mount_component(t,s,a),insert(s,i,a),n=!0},p(s,a){if(r!==(r=s[0].closeButton)){if(t){group_outros();const l=t;transition_out(l.$$.fragment,1,0,()=>{destroy_component(l,1)}),check_outros()}r?(t=new r(o(s)),create_component(t.$$.fragment),transition_in(t.$$.fragment,1),mount_component(t,i.parentNode,i)):t=null}},i(s){n||(t&&transition_in(t.$$.fragment,s),n=!0)},o(s){t&&transition_out(t.$$.fragment,s),n=!1},d(s){s&&detach(i),t&&destroy_component(t,s)}}}function create_fragment(e){let t,i,n,r,o=e[1]&&create_if_block(e);const s=e[38].default,a=create_slot(s,e,e[37],null);return{c(){o&&o.c(),t=space(),a&&a.c()},m(l,c){o&&o.m(l,c),insert(l,t,c),a&&a.m(l,c),i=!0,n||(r=listen(window_1,"keydown",e[18]),n=!0)},p(l,c){l[1]?o?(o.p(l,c),c[0]&2&&transition_in(o,1)):(o=create_if_block(l),o.c(),transition_in(o,1),o.m(t.parentNode,t)):o&&(group_outros(),transition_out(o,1,1,()=>{o=null}),check_outros()),a&&a.p&&(!i||c[1]&64)&&update_slot_base(a,s,l,l[37],i?get_slot_changes(s,l[37],c,null):get_all_dirty_from_scope(l[37]),null)},i(l){i||(transition_in(o),transition_in(a,l),i=!0)},o(l){transition_out(o),transition_out(a,l),i=!1},d(l){o&&o.d(l),l&&detach(t),a&&a.d(l),n=!1,r()}}}function bind(e,t={}){return function(n){return new e(et(Pe({},n),{props:Pe(Pe({},t),n.props)}))}}function instance(e,t,i){let{$$slots:n={},$$scope:r}=t;const o=createEventDispatcher(),s=setContext;let{show:a=null}=t,{key:l="simple-modal"}=t,{closeButton:c=!0}=t,{closeOnEsc:g=!0}=t,{closeOnOuterClick:v=!0}=t,{styleBg:p={}}=t,{styleWindowWrap:w={}}=t,{styleWindow:E={}}=t,{styleContent:b={}}=t,{styleCloseButton:u={}}=t,{setContext:m=s}=t,{transitionBg:S=fade}=t,{transitionBgProps:x={duration:250}}=t,{transitionWindow:D=S}=t,{transitionWindowProps:I=x}=t;const M={closeButton:c,closeOnEsc:g,closeOnOuterClick:v,styleBg:p,styleWindowWrap:w,styleWindow:E,styleContent:b,styleCloseButton:u,transitionBg:S,transitionBgProps:x,transitionWindow:D,transitionWindowProps:I};let R=Pe({},M),L=null,G,U,k,J,te,ce,fe,he,Y,we,Ee,Ae,Ce,Me,xe;const Se=z=>z.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase(),be=z=>z?Object.keys(z).reduce((re,pe)=>`${re}; ${Se(pe)}: ${z[pe]}`,""):"",Le=z=>!!(z&&z.constructor&&z.call&&z.apply),ze=()=>{i(5,te=be(Object.assign({},{width:window.innerWidth,height:window.innerHeight},R.styleBg))),i(6,ce=be(R.styleWindowWrap)),i(7,fe=be(R.styleWindow)),i(8,he=be(R.styleContent)),i(9,Y=be(R.styleCloseButton)),i(10,we=R.transitionBg),i(11,Ee=R.transitionWindow)},Oe=()=>{};let Be=Oe,De=Oe,Ne=Oe,Ie=Oe;const h=(z,re={},pe={},ue={})=>{i(1,L=bind(z,re)),i(0,R=Pe(Pe({},M),pe)),ze(),ne(),i(12,Be=_e=>{ue.onOpen&&ue.onOpen(_e),o("open"),o("opening")}),i(13,De=_e=>{ue.onClose&&ue.onClose(_e),o("close"),o("closing")}),i(14,Ne=_e=>{ue.onOpened&&ue.onOpened(_e),o("opened")}),i(15,Ie=_e=>{ue.onClosed&&ue.onClosed(_e),o("closed")})},y=(z={})=>{i(13,De=z.onClose||De),i(15,Ie=z.onClosed||Ie),i(1,L=null),j()},O=z=>{if(R.closeOnEsc&&L&&z.key==="Escape"&&(z.preventDefault(),y()),L&&z.key==="Tab"){const re=k.querySelectorAll("*"),pe=Array.from(re).filter(_e=>_e.tabIndex>=0);let ue=pe.indexOf(document.activeElement);ue===-1&&z.shiftKey&&(ue=0),ue+=pe.length+(z.shiftKey?-1:1),ue%=pe.length,pe[ue].focus(),z.preventDefault()}},N=z=>{R.closeOnOuterClick&&(z.target===G||z.target===U)&&(xe=z.target)},H=z=>{R.closeOnOuterClick&&z.target===xe&&(z.preventDefault(),y())},ne=()=>{J=window.scrollY,Ae=document.body.style.position,Ce=document.body.style.overflow,Me=document.body.style.width,document.body.style.position="fixed",document.body.style.top=`-${J}px`,document.body.style.overflow="hidden",document.body.style.width="100%"},j=()=>{document.body.style.position=Ae||"",document.body.style.top="",document.body.style.overflow=Ce||"",document.body.style.width=Me||"",window.scrollTo(0,J)};m(l,{open:h,close:y});let le=!1;onDestroy(()=>{le&&y()}),onMount(()=>{i(36,le=!0)});function ge(z){binding_callbacks[z?"unshift":"push"](()=>{k=z,i(4,k)})}function ae(z){binding_callbacks[z?"unshift":"push"](()=>{U=z,i(3,U)})}function Q(z){binding_callbacks[z?"unshift":"push"](()=>{G=z,i(2,G)})}return e.$$set=z=>{"show"in z&&i(21,a=z.show),"key"in z&&i(22,l=z.key),"closeButton"in z&&i(23,c=z.closeButton),"closeOnEsc"in z&&i(24,g=z.closeOnEsc),"closeOnOuterClick"in z&&i(25,v=z.closeOnOuterClick),"styleBg"in z&&i(26,p=z.styleBg),"styleWindowWrap"in z&&i(27,w=z.styleWindowWrap),"styleWindow"in z&&i(28,E=z.styleWindow),"styleContent"in z&&i(29,b=z.styleContent),"styleCloseButton"in z&&i(30,u=z.styleCloseButton),"setContext"in z&&i(31,m=z.setContext),"transitionBg"in z&&i(32,S=z.transitionBg),"transitionBgProps"in z&&i(33,x=z.transitionBgProps),"transitionWindow"in z&&i(34,D=z.transitionWindow),"transitionWindowProps"in z&&i(35,I=z.transitionWindowProps),"$$scope"in z&&i(37,r=z.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&2097152|e.$$.dirty[1]&32&&le&&(Le(a)?h(a):y())},[R,L,G,U,k,te,ce,fe,he,Y,we,Ee,Be,De,Ne,Ie,Le,y,O,N,H,a,l,c,g,v,p,w,E,b,u,m,S,x,D,I,le,r,n,ge,ae,Q]}class Modal extends SvelteComponent{constructor(t){super();init(this,t,instance,create_fragment,safe_not_equal,{show:21,key:22,closeButton:23,closeOnEsc:24,closeOnOuterClick:25,styleBg:26,styleWindowWrap:27,styleWindow:28,styleContent:29,styleCloseButton:30,setContext:31,transitionBg:32,transitionBgProps:33,transitionWindow:34,transitionWindowProps:35},null,[-1,-1])}}var cog={cog:{width:1536,height:1792,paths:[{d:"M1024 896q0-106-75-181t-181-75-181 75-75 181 75 181 181 75 181-75 75-181zM1536 787v222q0 12-8 23t-20 13l-185 28q-19 54-39 91 35 50 107 138 10 12 10 25t-9 23q-27 37-99 108t-94 71q-12 0-26-9l-138-108q-44 23-91 38-16 136-29 186-7 28-36 28h-222q-14 0-24.5-8.5t-11.5-21.5l-28-184q-49-16-90-37l-141 107q-10 9-25 9-14 0-25-11-126-114-165-168-7-10-7-23 0-12 8-23 15-21 51-66.5t54-70.5q-27-50-41-99l-183-27q-13-2-21-12.5t-8-23.5v-222q0-12 8-23t19-13l186-28q14-46 39-92-40-57-107-138-10-12-10-24 0-10 9-23 26-36 98.5-107.5t94.5-71.5q13 0 26 10l138 107q44-23 91-38 16-136 29-186 7-28 36-28h222q14 0 24.5 8.5t11.5 21.5l28 184q49 16 90 37l142-107q9-9 24-9 13 0 25 10 129 119 165 170 7 8 7 22 0 12-8 23-15 21-51 66.5t-54 70.5q26 50 41 98l183 28q13 2 21 12.5t8 23.5z"}]}},home={home:{width:1664,height:1792,paths:[{d:"M1408 992v480q0 26-19 45t-45 19h-384v-384h-256v384h-384q-26 0-45-19t-19-45v-480q0-1 0.5-3t0.5-3l575-474 575 474q1 2 1 6zM1631 923l-62 74q-8 9-21 11h-3q-13 0-21-7l-692-577-692 577q-12 8-24 7-13-2-21-11l-62-74q-8-10-7-23.5t11-21.5l719-599q32-26 76-26t76 26l244 204v-195q0-14 9-23t23-9h192q14 0 23 9t9 23v408l219 182q10 8 11 21.5t-7 23.5z"}]}},photo={photo:{width:1920,height:1792,paths:[{d:"M640 576q0 80-56 136t-136 56-136-56-56-136 56-136 136-56 136 56 56 136zM1664 960v448h-1408v-192l320-320 160 160 512-512zM1760 256h-1600q-13 0-22.5 9.5t-9.5 22.5v1216q0 13 9.5 22.5t22.5 9.5h1600q13 0 22.5-9.5t9.5-22.5v-1216q0-13-9.5-22.5t-22.5-9.5zM1920 288v1216q0 66-47 113t-113 47h-1600q-66 0-113-47t-47-113v-1216q0-66 47-113t113-47h1600q66 0 113 47t47 113z"}]}},github={github:{width:1536,height:1792,paths:[{d:"M768 128q209 0 385.5 103t279.5 279.5 103 385.5q0 251-146.5 451.5t-378.5 277.5q-27 5-40-7t-13-30q0-3 0.5-76.5t0.5-134.5q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-119-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-85-13.5q-45 113-8 204-79 87-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-39 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 0.5 88.5t0.5 54.5q0 18-13 30t-40 7q-232-77-378.5-277.5t-146.5-451.5q0-209 103-385.5t279.5-279.5 385.5-103zM291 1231q3-7-7-12-10-3-13 2-3 7 7 12 9 6 13-2zM322 1265q7-5-2-16-10-9-16-3-7 5 2 16 10 10 16 3zM352 1310q9-7 0-19-8-13-17-6-9 5 0 18t17 7zM394 1352q8-8-4-19-12-12-20-3-9 8 4 19 12 12 20 3zM451 1377q3-11-13-16-15-4-19 7t13 15q15 6 19-6zM514 1382q0-13-17-11-16 0-16 11 0 13 17 11 16 0 16-11zM572 1372q-2-11-18-9-16 3-14 15t18 8 14-14z"}]}},angleDoubleDown={"angle-double-down":{width:1152,height:1792,paths:[{d:"M1075 864q0 13-10 23l-466 466q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l393 393 393-393q10-10 23-10t23 10l50 50q10 10 10 23zM1075 480q0 13-10 23l-466 466q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l393 393 393-393q10-10 23-10t23 10l50 50q10 10 10 23z"}]}},fileText={"file-text":{width:1536,height:1792,paths:[{d:"M1468 476q14 14 28 36h-472v-472q22 14 36 28zM992 640h544v1056q0 40-28 68t-68 28h-1344q-40 0-68-28t-28-68v-1600q0-40 28-68t68-28h800v544q0 40 28 68t68 28zM1152 1376v-64q0-14-9-23t-23-9h-704q-14 0-23 9t-9 23v64q0 14 9 23t23 9h704q14 0 23-9t9-23zM1152 1120v-64q0-14-9-23t-23-9h-704q-14 0-23 9t-9 23v64q0 14 9 23t23 9h704q14 0 23-9t9-23zM1152 864v-64q0-14-9-23t-23-9h-704q-14 0-23 9t-9 23v64q0 14 9 23t23 9h704q14 0 23-9t9-23z"}]}},fileImageO={"file-image-o":{width:1536,height:1792,paths:[{d:"M1468 380q28 28 48 76t20 88v1152q0 40-28 68t-68 28h-1344q-40 0-68-28t-28-68v-1600q0-40 28-68t68-28h896q40 0 88 20t76 48zM1024 136v376h376q-10-29-22-41l-313-313q-12-12-41-22zM1408 1664v-1024h-416q-40 0-68-28t-28-68v-416h-768v1536h1280zM1280 1216v320h-1024v-192l192-192 128 128 384-384zM448 1024q-80 0-136-56t-56-136 56-136 136-56 136 56 56 136-56 136-136 56z"}]}},eyedropper={eyedropper:{width:1792,height:1792,paths:[{d:"M1698 94q94 94 94 226.5t-94 225.5l-225 223 104 104q10 10 10 23t-10 23l-210 210q-10 10-23 10t-23-10l-105-105-603 603q-37 37-90 37h-203l-256 128-64-64 128-256v-203q0-53 37-90l603-603-105-105q-10-10-10-23t10-23l210-210q10-10 23-10t23 10l104 104 223-225q93-94 225.5-94t226.5 94zM512 1472l576-576-192-192-576 576v192h192z"}]}},commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},wheel$1={exports:{}};wheel$1.exports=addWheelListener;wheel$1.exports.addWheelListener=addWheelListener;wheel$1.exports.removeWheelListener=removeWheelListener;function addWheelListener(e,t,i){e.addEventListener("wheel",t,i)}function removeWheelListener(e,t,i){e.removeEventListener("wheel",t,i)}var amator={exports:{}},NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported=typeof Float32Array=="function";function A(e,t){return 1-3*t+3*e}function B(e,t){return 3*t-6*e}function C(e){return 3*e}function calcBezier(e,t,i){return((A(t,i)*e+B(t,i))*e+C(t))*e}function getSlope(e,t,i){return 3*A(t,i)*e*e+2*B(t,i)*e+C(t)}function binarySubdivide(e,t,i,n,r){var o,s,a=0;do s=t+(i-t)/2,o=calcBezier(s,n,r)-e,o>0?i=s:t=s;while(Math.abs(o)>SUBDIVISION_PRECISION&&++a<SUBDIVISION_MAX_ITERATIONS);return s}function newtonRaphsonIterate(e,t,i,n){for(var r=0;r<NEWTON_ITERATIONS;++r){var o=getSlope(t,i,n);if(o===0)return t;var s=calcBezier(t,i,n)-e;t-=s/o}return t}function LinearEasing(e){return e}var src=function(t,i,n,r){if(!(0<=t&&t<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===i&&n===r)return LinearEasing;for(var o=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize),s=0;s<kSplineTableSize;++s)o[s]=calcBezier(s*kSampleStepSize,t,n);function a(l){for(var c=0,g=1,v=kSplineTableSize-1;g!==v&&o[g]<=l;++g)c+=kSampleStepSize;--g;var p=(l-o[g])/(o[g+1]-o[g]),w=c+p*kSampleStepSize,E=getSlope(w,t,n);return E>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(l,w,t,n):E===0?w:binarySubdivide(l,c,c+kSampleStepSize,t,n)}return function(c){return c===0?0:c===1?1:calcBezier(a(c),i,r)}},BezierEasing=src,animations={ease:BezierEasing(.25,.1,.25,1),easeIn:BezierEasing(.42,0,1,1),easeOut:BezierEasing(0,0,.58,1),easeInOut:BezierEasing(.42,0,.58,1),linear:BezierEasing(0,0,1,1)};amator.exports=animate$1;amator.exports.makeAggregateRaf=makeAggregateRaf;amator.exports.sharedScheduler=makeAggregateRaf();function animate$1(e,t,i){var n=Object.create(null),r=Object.create(null);i=i||{};var o=typeof i.easing=="function"?i.easing:animations[i.easing];o||(i.easing&&console.warn("Unknown easing function in amator: "+i.easing),o=animations.ease);var s=typeof i.step=="function"?i.step:noop$2,a=typeof i.done=="function"?i.done:noop$2,l=getScheduler(i.scheduler),c=Object.keys(t);c.forEach(function(m){n[m]=e[m],r[m]=t[m]-e[m]});var g=typeof i.duration=="number"?i.duration:400,v=Math.max(1,g*.06),p,w=0;return p=l.next(b),{cancel:E};function E(){l.cancel(p),p=0}function b(){var m=o(w/v);w+=1,u(m),w<=v?(p=l.next(b),s(e)):(p=0,setTimeout(function(){a(e)},0))}function u(m){c.forEach(function(S){e[S]=r[S]*m+n[S]})}}function noop$2(){}function getScheduler(e){if(!e){var t=typeof window!="undefined"&&window.requestAnimationFrame;return t?rafScheduler():timeoutScheduler()}if(typeof e.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof e.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return e}function rafScheduler(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function timeoutScheduler(){return{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}}}function makeAggregateRaf(){var e=new Set,t=new Set,i=0;return{next:r,cancel:r,clearAll:n};function n(){e.clear(),t.clear(),cancelAnimationFrame(i),i=0}function r(a){t.add(a),o()}function o(){i||(i=requestAnimationFrame(s))}function s(){i=0;var a=t;t=e,e=a,e.forEach(function(l){l()}),e.clear()}}var ngraph_events=function(t){validateSubject(t);var i=createEventsStorage(t);return t.on=i.on,t.off=i.off,t.fire=i.fire,t};function createEventsStorage(e){var t=Object.create(null);return{on:function(i,n,r){if(typeof n!="function")throw new Error("callback is expected to be a function");var o=t[i];return o||(o=t[i]=[]),o.push({callback:n,ctx:r}),e},off:function(i,n){var r=typeof i=="undefined";if(r)return t=Object.create(null),e;if(t[i]){var o=typeof n!="function";if(o)delete t[i];else for(var s=t[i],a=0;a<s.length;++a)s[a].callback===n&&s.splice(a,1)}return e},fire:function(i){var n=t[i];if(!n)return e;var r;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var o=0;o<n.length;++o){var s=n[o];s.callback.apply(s.ctx,r)}return e}}}function validateSubject(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],i=0;i<t.length;++i)if(e.hasOwnProperty(t[i]))throw new Error("Subject cannot be eventified, since it already has property '"+t[i]+"'")}var kinetic_1=kinetic$1;function kinetic$1(e,t,i){typeof i!="object"&&(i={});var n=typeof i.minVelocity=="number"?i.minVelocity:5,r=typeof i.amplitude=="number"?i.amplitude:.25,o=typeof i.cancelAnimationFrame=="function"?i.cancelAnimationFrame:getCancelAnimationFrame(),s=typeof i.requestAnimationFrame=="function"?i.requestAnimationFrame:getRequestAnimationFrame(),a,l,c=342,g,v,p,w,E,b,u,m;return{start:x,stop:I,cancel:S};function S(){o(g),o(m)}function x(){a=e(),w=u=v=E=0,l=new Date,o(g),o(m),g=s(D)}function D(){var R=Date.now(),L=R-l;l=R;var G=e(),U=G.x-a.x,k=G.y-a.y;a=G;var J=1e3/(1+L);v=.8*U*J+.2*v,E=.8*k*J+.2*E,g=s(D)}function I(){o(g),o(m);var R=e();p=R.x,b=R.y,l=Date.now(),(v<-n||v>n)&&(w=r*v,p+=w),(E<-n||E>n)&&(u=r*E,b+=u),m=s(M)}function M(){var R=Date.now()-l,L=!1,G=0,U=0;w&&(G=-w*Math.exp(-R/c),G>.5||G<-.5?L=!0:G=w=0),u&&(U=-u*Math.exp(-R/c),U>.5||U<-.5?L=!0:U=u=0),L&&(t(p+G,b+U),m=s(M))}}function getCancelAnimationFrame(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function getRequestAnimationFrame(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(e){return setTimeout(e,16)}}var createTextSelectionInterceptor_1=createTextSelectionInterceptor$1;function createTextSelectionInterceptor$1(e){if(e)return{capture:noop$1,release:noop$1};var t,i,n,r=!1;return{capture:o,release:s};function o(a){r=!0,i=window.document.onselectstart,n=window.document.ondragstart,window.document.onselectstart=disabled,t=a,t.ondragstart=disabled}function s(){!r||(r=!1,window.document.onselectstart=i,t&&(t.ondragstart=n))}}function disabled(e){return e.stopPropagation(),!1}function noop$1(){}var transform=Transform$1;function Transform$1(){this.x=0,this.y=0,this.scale=1}var svgController={exports:{}};svgController.exports=makeSvgController$1;svgController.exports.canAttach=isSVGElement;function makeSvgController$1(e,t){if(!isSVGElement(e))throw new Error("svg element is required for svg.panzoom to work");var i=e.ownerSVGElement;if(!i)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");t.disableKeyboardInteraction||i.setAttribute("tabindex",0);var n={getBBox:o,getScreenCTM:s,getOwner:r,applyTransform:l,initTransform:a};return n;function r(){return i}function o(){var c=e.getBBox();return{left:c.x,top:c.y,width:c.width,height:c.height}}function s(){var c=i.getCTM();return c||i.getScreenCTM()}function a(c){var g=e.getCTM();g===null&&(g=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),c.x=g.e,c.y=g.f,c.scale=g.a,i.removeAttributeNS(null,"viewBox")}function l(c){e.setAttribute("transform","matrix("+c.scale+" 0 0 "+c.scale+" "+c.x+" "+c.y+")")}}function isSVGElement(e){return e&&e.ownerSVGElement&&e.getCTM}var domController={exports:{}};domController.exports=makeDomController$1;domController.exports.canAttach=isDomElement;function makeDomController$1(e,t){var i=isDomElement(e);if(!i)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var n=e.parentElement;e.scrollTop=0,t.disableKeyboardInteraction||n.setAttribute("tabindex",0);var r={getBBox:s,getOwner:o,applyTransform:a};return r;function o(){return n}function s(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}}function a(l){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+l.scale+", 0, 0, "+l.scale+", "+l.x+", "+l.y+")"}}function isDomElement(e){return e&&e.parentElement&&e.style}var wheel=wheel$1.exports,animate=amator.exports,eventify=ngraph_events,kinetic=kinetic_1,createTextSelectionInterceptor=createTextSelectionInterceptor_1,domTextSelectionInterceptor=createTextSelectionInterceptor(),fakeTextSelectorInterceptor=createTextSelectionInterceptor(!0),Transform=transform,makeSvgController=svgController.exports,makeDomController=domController.exports,defaultZoomSpeed=1,defaultDoubleTapZoomSpeed=1.75,doubleTapSpeedInMS=300;function createPanZoom(e,t){t=t||{};var i=t.controller;if(i||(makeSvgController.canAttach(e)?i=makeSvgController(e,t):makeDomController.canAttach(e)&&(i=makeDomController(e,t))),!i)throw new Error("Cannot create panzoom for the current type of dom element");var n=i.getOwner(),r={x:0,y:0},o=!1,s=new Transform;i.initTransform&&i.initTransform(s);var a=typeof t.filterKey=="function"?t.filterKey:noop,l=typeof t.pinchSpeed=="number"?t.pinchSpeed:1,c=t.bounds,g=typeof t.maxZoom=="number"?t.maxZoom:Number.POSITIVE_INFINITY,v=typeof t.minZoom=="number"?t.minZoom:0,p=typeof t.boundsPadding=="number"?t.boundsPadding:.05,w=typeof t.zoomDoubleClickSpeed=="number"?t.zoomDoubleClickSpeed:defaultDoubleTapZoomSpeed,E=t.beforeWheel||noop,b=t.beforeMouseDown||noop,u=typeof t.zoomSpeed=="number"?t.zoomSpeed:defaultZoomSpeed,m=parseTransformOrigin(t.transformOrigin),S=t.enableTextSelection?fakeTextSelectorInterceptor:domTextSelectionInterceptor;validateBounds(c),t.autocenter&&be();var x,D=0,I,M=!1,R=!1,L,G,U,k;"smoothScroll"in t&&!t.smoothScroll?k=rigidScroll():k=kinetic(O,_e,t.smoothScroll);var J,te,ce,fe=!1;qe();var he={dispose:He,moveBy:ue,moveTo:N,smoothMoveTo:pe,centerOn:re,zoomTo:Je,zoomAbs:z,smoothZoom:Ke,smoothZoomAbs:ht,showRectangle:xe,pause:Ae,resume:Ce,isPaused:Me,getTransform:Le,getMinZoom:ze,setMinZoom:Oe,getMaxZoom:Be,setMaxZoom:De,getTransformOrigin:Ne,setTransformOrigin:Ie,getZoomSpeed:h,setZoomSpeed:y};eventify(he);var Y=typeof t.initialX=="number"?t.initialX:s.x,we=typeof t.initialY=="number"?t.initialY:s.y,Ee=typeof t.initialZoom=="number"?t.initialZoom:s.scale;return(Y!=s.x||we!=s.y||Ee!=s.scale)&&z(Y,we,Ee),he;function Ae(){Xe(),fe=!0}function Ce(){fe&&(qe(),fe=!1)}function Me(){return fe}function xe(P){var W=n.getBoundingClientRect(),q=Se(W.width,W.height),X=P.right-P.left,de=P.bottom-P.top;if(!Number.isFinite(X)||!Number.isFinite(de))throw new Error("Invalid rectangle");var ve=q.x/X,ye=q.y/de,Te=Math.min(ve,ye);s.x=-(P.left+X/2)*Te+q.x/2,s.y=-(P.top+de/2)*Te+q.y/2,s.scale=Te}function Se(P,W){if(i.getScreenCTM){var q=i.getScreenCTM(),X=q.a,de=q.d,ve=q.e,ye=q.f;r.x=P*X-ve,r.y=W*de-ye}else r.x=P,r.y=W;return r}function be(){var P,W,q=0,X=0,de=j();if(de)q=de.left,X=de.top,P=de.right-de.left,W=de.bottom-de.top;else{var ve=n.getBoundingClientRect();P=ve.width,W=ve.height}var ye=i.getBBox();if(!(ye.width===0||ye.height===0)){var Te=W/ye.height,Ze=P/ye.width,We=Math.min(Ze,Te);s.x=-(ye.left+ye.width/2)*We+P/2+q,s.y=-(ye.top+ye.height/2)*We+W/2+X,s.scale=We}}function Le(){return s}function ze(){return v}function Oe(P){v=P}function Be(){return g}function De(P){g=P}function Ne(){return m}function Ie(P){m=parseTransformOrigin(P)}function h(){return u}function y(P){if(!Number.isFinite(P))throw new Error("Zoom speed should be a number");u=P}function O(){return{x:s.x,y:s.y}}function N(P,W){s.x=P,s.y=W,ne(),Ue("pan"),ae()}function H(P,W){N(s.x+P,s.y+W)}function ne(){var P=j();if(!!P){var W=!1,q=le(),X=P.left-q.right;return X>0&&(s.x+=X,W=!0),X=P.right-q.left,X<0&&(s.x+=X,W=!0),X=P.top-q.bottom,X>0&&(s.y+=X,W=!0),X=P.bottom-q.top,X<0&&(s.y+=X,W=!0),W}}function j(){if(!!c){if(typeof c=="boolean"){var P=n.getBoundingClientRect(),W=P.width,q=P.height;return{left:W*p,top:q*p,right:W*(1-p),bottom:q*(1-p)}}return c}}function le(){var P=i.getBBox(),W=ge(P.left,P.top);return{left:W.x,top:W.y,right:P.width*s.scale+W.x,bottom:P.height*s.scale+W.y}}function ge(P,W){return{x:P*s.scale+s.x,y:W*s.scale+s.y}}function ae(){o=!0,x=window.requestAnimationFrame(tt)}function Q(P,W,q){if(isNaN$1(P)||isNaN$1(W)||isNaN$1(q))throw new Error("zoom requires valid numbers");var X=s.scale*q;if(X<v){if(s.scale===v)return;q=v/s.scale}if(X>g){if(s.scale===g)return;q=g/s.scale}var de=Se(P,W);if(s.x=de.x-q*(de.x-s.x),s.y=de.y-q*(de.y-s.y),c&&p===1&&v===1)s.scale*=q,ne();else{var ve=ne();ve||(s.scale*=q)}Ue("zoom"),ae()}function z(P,W,q){var X=q/s.scale;Q(P,W,X)}function re(P){var W=P.ownerSVGElement;if(!W)throw new Error("ui element is required to be within the scene");var q=P.getBoundingClientRect(),X=q.left+q.width/2,de=q.top+q.height/2,ve=W.getBoundingClientRect(),ye=ve.width/2-X,Te=ve.height/2-de;ue(ye,Te,!0)}function pe(P,W){ue(P-s.x,W-s.y,!0)}function ue(P,W,q){if(!q)return H(P,W);J&&J.cancel();var X={x:0,y:0},de={x:P,y:W},ve=0,ye=0;J=animate(X,de,{step:function(Te){H(Te.x-ve,Te.y-ye),ve=Te.x,ye=Te.y}})}function _e(P,W){Qe(),N(P,W)}function He(){Xe()}function qe(){n.addEventListener("mousedown",se,{passive:!1}),n.addEventListener("dblclick",oe,{passive:!1}),n.addEventListener("touchstart",d,{passive:!1}),n.addEventListener("keydown",Ve,{passive:!1}),wheel.addWheelListener(n,Ge,{passive:!1}),ae()}function Xe(){wheel.removeWheelListener(n,Ge),n.removeEventListener("mousedown",se),n.removeEventListener("keydown",Ve),n.removeEventListener("dblclick",oe),n.removeEventListener("touchstart",d),x&&(window.cancelAnimationFrame(x),x=0),k.cancel(),ke(),Fe(),S.release(),it()}function tt(){o&&Ye()}function Ye(){o=!1,i.applyTransform(s),Ue("transform"),x=0}function Ve(P){var W=0,q=0,X=0;if(P.keyCode===38?q=1:P.keyCode===40?q=-1:P.keyCode===37?W=1:P.keyCode===39?W=-1:P.keyCode===189||P.keyCode===109?X=1:(P.keyCode===187||P.keyCode===107)&&(X=-1),!a(P,W,q,X)){if(W||q){P.preventDefault(),P.stopPropagation();var de=n.getBoundingClientRect(),ve=Math.min(de.width,de.height),ye=.05,Te=ve*ye*W,Ze=ve*ye*q;ue(Te,Ze)}if(X){var We=nt(X*100),ve=m?je():f();Je(ve.x,ve.y,We)}}}function f(){var P=n.getBoundingClientRect();return{x:P.width/2,y:P.height/2}}function d(P){if(T(P),P.touches.length===1)return F(P,P.touches[0]);P.touches.length===2&&(U=ee(P.touches[0],P.touches[1]),ce=!0,K())}function T(P){t.onTouch&&!t.onTouch(P)||(P.stopPropagation(),P.preventDefault())}function _(P){t.onDoubleClick&&!t.onDoubleClick(P)||(P.preventDefault(),P.stopPropagation())}function F(P){var W=P.touches[0],q=Re(W);I=q;var X=Se(q.x,q.y);L=X.x,G=X.y,k.cancel(),K()}function K(){M||(M=!0,document.addEventListener("touchmove",V),document.addEventListener("touchend",Z),document.addEventListener("touchcancel",Z))}function V(P){if(P.touches.length===1){P.stopPropagation();var W=P.touches[0],q=Re(W),X=Se(q.x,q.y),de=X.x-L,ve=X.y-G;de!==0&&ve!==0&&rt(),L=X.x,G=X.y,ue(de,ve)}else if(P.touches.length===2){ce=!0;var ye=P.touches[0],Te=P.touches[1],Ze=ee(ye,Te),We=1+(Ze/U-1)*l,ot=Re(ye),st=Re(Te);if(L=(ot.x+st.x)/2,G=(ot.y+st.y)/2,m){var q=je();L=q.x,G=q.y}Je(L,G,We),U=Ze,P.stopPropagation(),P.preventDefault()}}function Z(P){if(P.touches.length>0){var W=Re(P.touches[0]),q=Se(W.x,W.y);L=q.x,G=q.y}else{var X=new Date;if(X-D<doubleTapSpeedInMS)if(m){var W=je();Ke(W.x,W.y,w)}else Ke(I.x,I.y,w);D=X,it(),Fe()}}function ee(P,W){var q=P.clientX-W.clientX,X=P.clientY-W.clientY;return Math.sqrt(q*q+X*X)}function oe(P){_(P);var W=Re(P);m&&(W=je()),Ke(W.x,W.y,w)}function se(P){if(!b(P)){if(M)return P.stopPropagation(),!1;var W=P.button===1&&window.event!==null||P.button===0;if(!!W){k.cancel();var q=Re(P),X=Se(q.x,q.y);return L=X.x,G=X.y,document.addEventListener("mousemove",me),document.addEventListener("mouseup",ie),S.capture(P.target||P.srcElement),!1}}}function me(P){if(!M){rt();var W=Re(P),q=Se(W.x,W.y),X=q.x-L,de=q.y-G;L=q.x,G=q.y,ue(X,de)}}function ie(){S.release(),it(),ke()}function ke(){document.removeEventListener("mousemove",me),document.removeEventListener("mouseup",ie),R=!1}function Fe(){document.removeEventListener("touchmove",V),document.removeEventListener("touchend",Z),document.removeEventListener("touchcancel",Z),R=!1,ce=!1,M=!1}function Ge(P){if(!E(P)){k.cancel();var W=P.deltaY;P.deltaMode>0&&(W*=100);var q=nt(W);if(q!==1){var X=m?je():Re(P);Je(X.x,X.y,q),P.preventDefault()}}}function Re(P){var W,q,X=n.getBoundingClientRect();return W=P.clientX-X.left,q=P.clientY-X.top,{x:W,y:q}}function Ke(P,W,q){var X=s.scale,de={scale:X},ve={scale:q*X};k.cancel(),Qe(),te=animate(de,ve,{step:function(ye){z(P,W,ye.scale)},done:dt})}function ht(P,W,q){var X=s.scale,de={scale:X},ve={scale:q};k.cancel(),Qe(),te=animate(de,ve,{step:function(ye){z(P,W,ye.scale)}})}function je(){var P=n.getBoundingClientRect();return{x:P.width*m.x,y:P.height*m.y}}function Je(P,W,q){return k.cancel(),Qe(),Q(P,W,q)}function Qe(){te&&(te.cancel(),te=null)}function nt(P){var W=Math.sign(P),q=Math.min(.25,Math.abs(u*P/128));return 1-W*q}function rt(){R||(Ue("panstart"),R=!0,k.start())}function it(){R&&(ce||k.stop(),Ue("panend"))}function dt(){Ue("zoomend")}function Ue(P){he.fire(P,he)}}function parseTransformOrigin(e){if(!!e){if(typeof e=="object")return(!isNumber(e.x)||!isNumber(e.y))&&failTransformOrigin(e),e;failTransformOrigin()}}function failTransformOrigin(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function noop(){}function validateBounds(e){var t=typeof e;if(!(t==="undefined"||t==="boolean")){var i=isNumber(e.left)&&isNumber(e.top)&&isNumber(e.bottom)&&isNumber(e.right);if(!i)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function isNumber(e){return Number.isFinite(e)}function isNaN$1(e){return Number.isNaN?Number.isNaN(e):e!==e}function rigidScroll(){return{start:noop,stop:noop,cancel:noop}}function autoRun(){if(typeof document=="undefined")return;var e=document.getElementsByTagName("script");if(!e)return;for(var t,i=0;i<e.length;++i){var n=e[i];if(n.src&&n.src.match(/\bpanzoom(\.min)?\.js/)){t=n;break}}if(!t)return;var r=t.getAttribute("query");if(!r)return;var o=t.getAttribute("name")||"pz",s=Date.now();a();function a(){var g=document.querySelector(r);if(!g){var v=Date.now(),p=v-s;if(p<2e3){setTimeout(a,100);return}console.error("Cannot find the panzoom element",o);return}var w=l(t);console.log(w),window[o]=createPanZoom(g,w)}function l(g){for(var v=g.attributes,p={},w=0;w<v.length;++w){var E=v[w],b=c(E);b&&(p[b.name]=b.value)}return p}function c(g){if(!!g.name){var v=g.name[0]==="p"&&g.name[1]==="z"&&g.name[2]==="-";if(!!v){var p=g.name.substr(3),w=JSON.parse(g.value);return{name:p,value:w}}}}}autoRun();var openseadragon={exports:{}};(function(module){//! openseadragon 2.4.2
//! Built on 2020-03-05
//! Git commit: v2.4.2-0-c450749
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function OpenSeadragon(e){return new OpenSeadragon.Viewer(e)}(function(e){e.version={versionStr:"2.4.2",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("2",10)};var t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},i=Object.prototype.toString,n=Object.prototype.hasOwnProperty;e.isFunction=function(r){return e.type(r)==="function"},e.isArray=Array.isArray||function(r){return e.type(r)==="array"},e.isWindow=function(r){return r&&typeof r=="object"&&"setInterval"in r},e.type=function(r){return r==null?String(r):t[i.call(r)]||"object"},e.isPlainObject=function(r){if(!r||OpenSeadragon.type(r)!=="object"||r.nodeType||e.isWindow(r)||r.constructor&&!n.call(r,"constructor")&&!n.call(r.constructor.prototype,"isPrototypeOf"))return!1;var o;for(var s in r)o=s;return o===void 0||n.call(r,o)},e.isEmptyObject=function(r){for(var o in r)return!1;return!0},e.freezeObject=function(r){return Object.freeze?e.freezeObject=Object.freeze:e.freezeObject=function(o){return o},e.freezeObject(r)},e.supportsCanvas=function(){var r=document.createElement("canvas");return!!(e.isFunction(r.getContext)&&r.getContext("2d"))}(),e.isCanvasTainted=function(r){var o=!1;try{r.getContext("2d").getImageData(0,0,1,1)}catch{o=!0}return o},e.pixelDensityRatio=function(){if(e.supportsCanvas){var r=document.createElement("canvas").getContext("2d"),o=window.devicePixelRatio||1,s=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return Math.max(o,1)/s}else return 1}()})(OpenSeadragon),function($){$.extend=function(){var e,t,i,n,r,o,s=arguments[0]||{},a=arguments.length,l=!1,c=1;for(typeof s=="boolean"&&(l=s,s=arguments[1]||{},c=2),typeof s!="object"&&!OpenSeadragon.isFunction(s)&&(s={}),a===c&&(s=this,--c);c<a;c++)if(e=arguments[c],e!==null||e!==void 0)for(t in e)i=s[t],n=e[t],s!==n&&(l&&n&&(OpenSeadragon.isPlainObject(n)||(r=OpenSeadragon.isArray(n)))?(r?(r=!1,o=i&&OpenSeadragon.isArray(i)?i:[]):o=i&&OpenSeadragon.isPlainObject(i)?i:{},s[t]=OpenSeadragon.extend(l,o,n)):n!==void 0&&(s[t]=n));return s};var isIOSDevice=function(){if(typeof navigator!="object")return!1;var e=navigator.userAgent;return typeof e!="string"?!1:e.indexOf("iPhone")!==-1||e.indexOf("iPad")!==-1||e.indexOf("iPod")!==-1};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(e,t){return function(){var i=arguments;return i===void 0&&(i=[]),t.apply(e,i)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(e){return typeof e=="string"&&(e=document.getElementById(e)),e},getElementPosition:function(e){var t=new $.Point,i,n;for(e=$.getElement(e),i=$.getElementStyle(e).position=="fixed",n=getOffsetParent(e,i);n;)t.x+=e.offsetLeft,t.y+=e.offsetTop,i&&(t=t.plus($.getPageScroll())),e=n,i=$.getElementStyle(e).position=="fixed",n=getOffsetParent(e,i);return t},getElementOffset:function(e){e=$.getElement(e);var t=e&&e.ownerDocument,i,n,r={top:0,left:0};return t?(i=t.documentElement,typeof e.getBoundingClientRect!="undefined"&&(r=e.getBoundingClientRect()),n=t==t.window?t:t.nodeType===9?t.defaultView||t.parentWindow:!1,new $.Point(r.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0),r.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0))):new $.Point},getElementSize:function(e){return e=$.getElement(e),new $.Point(e.clientWidth,e.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(e){return e=$.getElement(e),e.currentStyle}:function(e){return e=$.getElement(e),window.getComputedStyle(e,"")},getCssPropertyWithVendorPrefix:function(e){var t={};return $.getCssPropertyWithVendorPrefix=function(i){if(t[i]!==void 0)return t[i];var n=document.createElement("div").style,r=null;if(n[i]!==void 0)r=i;else for(var o=["Webkit","Moz","MS","O","webkit","moz","ms","o"],s=$.capitalizeFirstLetter(i),a=0;a<o.length;a++){var l=o[a]+s;if(n[l]!==void 0){r=l;break}}return t[i]=r,r},$.getCssPropertyWithVendorPrefix(e)},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},positiveModulo:function(e,t){var i=e%t;return i<0&&(i+=t),i},pointInElement:function(e,t){e=$.getElement(e);var i=$.getElementOffset(e),n=$.getElementSize(e);return t.x>=i.x&&t.x<i.x+n.x&&t.y<i.y+n.y&&t.y>=i.y},getEvent:function(e){return e?$.getEvent=function(t){return t}:$.getEvent=function(){return window.event},$.getEvent(e)},getMousePosition:function(e){if(typeof e.pageX=="number")$.getMousePosition=function(t){var i=new $.Point;return t=$.getEvent(t),i.x=t.pageX,i.y=t.pageY,i};else if(typeof e.clientX=="number")$.getMousePosition=function(t){var i=new $.Point;return t=$.getEvent(t),i.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop,i};else throw new Error("Unknown event mouse position, no known technique.");return $.getMousePosition(e)},getPageScroll:function(){var e=document.documentElement||{},t=document.body||{};if(typeof window.pageXOffset=="number")$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(t.scrollLeft||t.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else if(e.scrollLeft||e.scrollTop)$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new $.Point(0,0);return $.getPageScroll()},setPageScroll:function(e){if(typeof window.scrollTo!="undefined")$.setPageScroll=function(n){window.scrollTo(n.x,n.y)};else{var t=$.getPageScroll();if(t.x===e.x&&t.y===e.y)return;document.body.scrollLeft=e.x,document.body.scrollTop=e.y;var i=$.getPageScroll();if(i.x!==t.x&&i.y!==t.y){$.setPageScroll=function(n){document.body.scrollLeft=n.x,document.body.scrollTop=n.y};return}if(document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y,i=$.getPageScroll(),i.x!==t.x&&i.y!==t.y){$.setPageScroll=function(n){document.documentElement.scrollLeft=n.x,document.documentElement.scrollTop=n.y};return}$.setPageScroll=function(n){}}return $.setPageScroll(e)},getWindowSize:function(){var e=document.documentElement||{},t=document.body||{};if(typeof window.innerWidth=="number")$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(e.clientWidth||e.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(t.clientWidth||t.clientHeight)$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return $.getWindowSize()},makeCenteredNode:function(e){e=$.getElement(e);var t=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(t[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(t[1].style,{display:"table-row"}),$.extend(t[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),t[0].appendChild(t[1]),t[1].appendChild(t[2]),t[2].appendChild(e),t[0]},makeNeutralElement:function(e){var t=document.createElement(e),i=t.style;return i.background="transparent none",i.border="none",i.margin="0px",i.padding="0px",i.position="static",t},now:function(){return Date.now?$.now=Date.now:$.now=function(){return new Date().getTime()},$.now()},makeTransparentImage:function(e){return $.makeTransparentImage=function(t){var i=$.makeNeutralElement("img");return i.src=t,i},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(t){var i=$.makeNeutralElement("img"),n=null;return n=$.makeNeutralElement("span"),n.style.display="inline-block",i.onload=function(){n.style.width=n.style.width||i.width+"px",n.style.height=n.style.height||i.height+"px",i.onload=null,i=null},i.src=t,n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')",n}),$.makeTransparentImage(e)},setElementOpacity:function(e,t,i){var n,r;e=$.getElement(e),i&&!$.Browser.alpha&&(t=Math.round(t)),$.Browser.opacity?e.style.opacity=t<1?t:"":t<1?(n=Math.round(100*t),r="alpha(opacity="+n+")",e.style.filter=r):e.style.filter=""},setElementTouchActionNone:function(e){e=$.getElement(e),typeof e.style.touchAction!="undefined"?e.style.touchAction="none":typeof e.style.msTouchAction!="undefined"&&(e.style.msTouchAction="none")},addClass:function(e,t){e=$.getElement(e),e.className?(" "+e.className+" ").indexOf(" "+t+" ")===-1&&(e.className+=" "+t):e.className=t},indexOf:function(e,t,i){return Array.prototype.indexOf?this.indexOf=function(n,r,o){return n.indexOf(r,o)}:this.indexOf=function(n,r,o){var s,a=o||0,l;if(!n)throw new TypeError;if(l=n.length,l===0||a>=l)return-1;for(a<0&&(a=l-Math.abs(a)),s=a;s<l;s++)if(n[s]===r)return s;return-1},this.indexOf(e,t,i)},removeClass:function(e,t){var i,n=[],r;for(e=$.getElement(e),i=e.className.split(/\s+/),r=0;r<i.length;r++)i[r]&&i[r]!==t&&n.push(i[r]);e.className=n.join(" ")},addEvent:function(){if(window.addEventListener)return function(e,t,i,n){e=$.getElement(e),e.addEventListener(t,i,n)};if(window.attachEvent)return function(e,t,i,n){e=$.getElement(e),e.attachEvent("on"+t,i)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(e,t,i,n){e=$.getElement(e),e.removeEventListener(t,i,n)};if(window.detachEvent)return function(e,t,i,n){e=$.getElement(e),e.detachEvent("on"+t,i)};throw new Error("No known event model.")}(),cancelEvent:function(e){e=$.getEvent(e),e.preventDefault?$.cancelEvent=function(t){t.preventDefault()}:$.cancelEvent=function(t){t=$.getEvent(t),t.cancel=!0,t.returnValue=!1},$.cancelEvent(e)},stopEvent:function(e){e=$.getEvent(e),e.stopPropagation?$.stopEvent=function(t){t.stopPropagation()}:$.stopEvent=function(t){t=$.getEvent(t),t.cancelBubble=!0},$.stopEvent(e)},createCallback:function(e,t){var i=[],n;for(n=2;n<arguments.length;n++)i.push(arguments[n]);return function(){var r=i.concat([]),o;for(o=0;o<arguments.length;o++)r.push(arguments[o]);return t.apply(e,r)}},getUrlParameter:function(e){var t=URLPARAMS[e];return t||null},getUrlProtocol:function(e){var t=e.match(/^([a-z]+:)\/\//i);return t===null?window.location.protocol:t[1].toLowerCase()},createAjaxRequest:function(e){var t;try{t=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{t=!1}if(t)window.XMLHttpRequest?$.createAjaxRequest=function(i){return i?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)$.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return $.createAjaxRequest(e)},makeAjaxRequest:function(e,t,i){var n,r,o;$.isPlainObject(e)&&(t=e.success,i=e.error,n=e.withCredentials,r=e.headers,o=e.responseType||null,e=e.url);var s=$.getUrlProtocol(e),a=$.createAjaxRequest(s==="file:");if(!$.isFunction(t))throw new Error("makeAjaxRequest requires a success callback");a.onreadystatechange=function(){a.readyState==4&&(a.onreadystatechange=function(){},a.status>=200&&a.status<300||a.status===0&&s!=="http:"&&s!=="https:"?t(a):($.console.log("AJAX request returned %d: %s",a.status,e),$.isFunction(i)&&i(a)))};try{if(a.open("GET",e,!0),o&&(a.responseType=o),r)for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&a.setRequestHeader(l,r[l]);n&&(a.withCredentials=!0),a.send(null)}catch(p){var c=p.message,g=$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10;if(g&&typeof p.number!="undefined"&&p.number==-2147024891&&(c+=`
See http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain`),$.console.log("%s while making AJAX request: %s",p.name,c),a.onreadystatechange=function(){},window.XDomainRequest){var v=new window.XDomainRequest;if(v){v.onload=function(w){$.isFunction(t)&&t({responseText:v.responseText,status:200,statusText:"OK"})},v.onerror=function(w){$.isFunction(i)&&i({responseText:v.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{v.open("GET",e),v.send()}catch{$.isFunction(i)&&i(a,p)}}}else $.isFunction(i)&&i(a,p)}return a},jsonp:function(e){var t,i=e.url,n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,r=e.callbackName||"openseadragon"+$.now(),o=window[r],s="$1"+r+"$2",a=e.param||"callback",l=e.callback;i=i.replace(/(\=)\?(&|$)|\?\?/i,s),i+=(/\?/.test(i)?"&":"?")+a+"="+r,window[r]=function(c){if(o)window[r]=o;else try{delete window[r]}catch{}l&&$.isFunction(l)&&l(c)},t=document.createElement("script"),(e.async!==void 0||e.async!==!1)&&(t.async="async"),e.scriptCharset&&(t.charset=e.scriptCharset),t.src=i,t.onload=t.onreadystatechange=function(c,g){(g||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,n&&t.parentNode&&n.removeChild(t),t=void 0)},n.insertBefore(t,n.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(e){if(window.DOMParser)$.parseXml=function(t){var i=null,n;return n=new DOMParser,i=n.parseFromString(t,"text/xml"),i};else if(window.ActiveXObject)$.parseXml=function(t){var i=null;return i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.loadXML(t),i};else throw new Error("Browser doesn't support XML DOM.");return $.parseXml(e)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(e){return e=e||"",!!FILEFORMATS[e.toLowerCase()]}});var nullfunction=function(e){};$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};(function(){var e=navigator.appVersion,t=navigator.userAgent,i;switch(navigator.appName){case"Microsoft Internet Explorer":!!window.attachEvent&&!!window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(t.substring(t.indexOf("MSIE")+5,t.indexOf(";",t.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(t.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(t.substring(t.indexOf("Firefox")+8))):t.indexOf("Safari")>=0?($.Browser.vendor=t.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(t.substring(t.substring(0,t.indexOf("Safari")).lastIndexOf("/")+1,t.indexOf("Safari")))):(i=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),i.exec(t)!==null&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(e);break}var n=window.location.search.substring(1),r=n.split("&"),o,s,a;for(a=0;a<r.length;a++)if(o=r[a],s=o.indexOf("="),s>0){var l=o.substring(0,s),c=o.substring(s+1);try{URLPARAMS[l]=decodeURIComponent(c)}catch{$.console.error("Ignoring malformed URL parameter: %s=%s",l,c)}}$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)})(),function(e){var t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame,i=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.msCancelAnimationFrame;if(t&&i)$.requestAnimationFrame=function(){return t.apply(e,arguments)},$.cancelAnimationFrame=function(){return i.apply(e,arguments)};else{var n=[],r=[],o=0,s;$.requestAnimationFrame=function(a){return n.push([++o,a]),s||(s=setInterval(function(){if(n.length){var l=$.now(),c=r;for(r=n,n=c;r.length;)r.shift()[1](l)}else clearInterval(s),s=void 0},1e3/50)),o},$.cancelAnimationFrame=function(a){var l,c;for(l=0,c=n.length;l<c;l+=1)if(n[l][0]===a){n.splice(l,1);return}for(l=0,c=r.length;l<c;l+=1)if(r[l][0]===a){r.splice(l,1);return}}}}(window);function getOffsetParent(e,t){return t&&e!=document.body?document.body:e.offsetParent}}(OpenSeadragon),function(e,t){module.exports?module.exports=t():e.OpenSeadragon=t()}(commonjsGlobal,function(){return OpenSeadragon}),function(e){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.fullscreenElement},t.requestFullScreen=function(i){return i.requestFullscreen()},t.exitFullScreen=function(){document.exitFullscreen()},t.fullScreenEventName="fullscreenchange",t.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.msFullscreenElement},t.requestFullScreen=function(i){return i.msRequestFullscreen()},t.exitFullScreen=function(){document.msExitFullscreen()},t.fullScreenEventName="MSFullscreenChange",t.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitFullscreenElement},t.requestFullScreen=function(i){return i.webkitRequestFullscreen()},t.exitFullScreen=function(){document.webkitExitFullscreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},t.requestFullScreen=function(i){return i.webkitRequestFullScreen()},t.exitFullScreen=function(){document.webkitCancelFullScreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.mozFullScreenElement},t.requestFullScreen=function(i){return i.mozRequestFullScreen()},t.exitFullScreen=function(){document.mozCancelFullScreen()},t.fullScreenEventName="mozfullscreenchange",t.fullScreenErrorEventName="mozfullscreenerror"),t.isFullScreen=function(){return t.getFullScreenElement()!==null},t.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),t.exitFullScreen()},e.extend(e,t)}(OpenSeadragon),function(e){e.EventSource=function(){this.events={}},e.EventSource.prototype={addOnceHandler:function(t,i,n,r){var o=this;r=r||1;var s=0,a=function(l){s++,s===r&&o.removeHandler(t,a),i(l)};this.addHandler(t,a,n)},addHandler:function(t,i,n){var r=this.events[t];r||(this.events[t]=r=[]),i&&e.isFunction(i)&&(r[r.length]={handler:i,userData:n||null})},removeHandler:function(t,i){var n=this.events[t],r=[],o;if(!!n&&e.isArray(n)){for(o=0;o<n.length;o++)n[o].handler!==i&&r.push(n[o]);this.events[t]=r}},removeAllHandlers:function(t){if(t)this.events[t]=[];else for(var i in this.events)this.events[i]=[]},getHandler:function(t){var i=this.events[t];return!i||!i.length?null:(i=i.length===1?[i[0]]:Array.apply(null,i),function(n,r){var o,s=i.length;for(o=0;o<s;o++)i[o]&&(r.eventSource=n,r.userData=i[o].userData,i[o].handler(r))})},raiseEvent:function(t,i){var n=this.getHandler(t);n&&(i||(i={}),n(this,i))}}}(OpenSeadragon),function(e){var t=[],i={};e.MouseTracker=function(f){t.push(this);var d=arguments;e.isPlainObject(f)||(f={element:d[0],clickTimeThreshold:d[1],clickDistThreshold:d[2]}),this.hash=Math.random(),this.element=e.getElement(f.element),this.clickTimeThreshold=f.clickTimeThreshold||e.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=f.clickDistThreshold||e.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=f.dblClickTimeThreshold||e.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=f.dblClickDistThreshold||e.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=f.userData||null,this.stopDelay=f.stopDelay||50,this.enterHandler=f.enterHandler||null,this.exitHandler=f.exitHandler||null,this.pressHandler=f.pressHandler||null,this.nonPrimaryPressHandler=f.nonPrimaryPressHandler||null,this.releaseHandler=f.releaseHandler||null,this.nonPrimaryReleaseHandler=f.nonPrimaryReleaseHandler||null,this.moveHandler=f.moveHandler||null,this.scrollHandler=f.scrollHandler||null,this.clickHandler=f.clickHandler||null,this.dblClickHandler=f.dblClickHandler||null,this.dragHandler=f.dragHandler||null,this.dragEndHandler=f.dragEndHandler||null,this.pinchHandler=f.pinchHandler||null,this.stopHandler=f.stopHandler||null,this.keyDownHandler=f.keyDownHandler||null,this.keyUpHandler=f.keyUpHandler||null,this.keyHandler=f.keyHandler||null,this.focusHandler=f.focusHandler||null,this.blurHandler=f.blurHandler||null;var T=this;i[this.hash]={click:function(_){E(T,_)},dblclick:function(_){b(T,_)},keydown:function(_){u(T,_)},keyup:function(_){m(T,_)},keypress:function(_){S(T,_)},focus:function(_){x(T,_)},blur:function(_){D(T,_)},wheel:function(_){I(T,_)},mousewheel:function(_){M(T,_)},DOMMouseScroll:function(_){M(T,_)},MozMousePixelScroll:function(_){M(T,_)},mouseenter:function(_){G(T,_)},mouseleave:function(_){J(T,_)},mouseover:function(_){U(T,_)},mouseout:function(_){te(T,_)},mousedown:function(_){he(T,_)},mouseup:function(_){Y(T,_)},mouseupcaptured:function(_){we(T,_)},mousemove:function(_){Ae(T,_)},mousemovecaptured:function(_){Ce(T,_)},touchstart:function(_){Se(T,_)},touchend:function(_){be(T,_)},touchendcaptured:function(_){Le(T,_)},touchmove:function(_){Oe(T,_)},touchmovecaptured:function(_){Be(T,_)},touchcancel:function(_){Ne(T,_)},gesturestart:function(_){Ie(T,_)},gesturechange:function(_){h(T,_)},pointerover:function(_){y(T,_)},MSPointerOver:function(_){y(T,_)},pointerout:function(_){O(T,_)},MSPointerOut:function(_){O(T,_)},pointerdown:function(_){N(T,_)},MSPointerDown:function(_){N(T,_)},pointerup:function(_){H(T,_)},MSPointerUp:function(_){H(T,_)},pointermove:function(_){le(T,_)},MSPointerMove:function(_){le(T,_)},pointercancel:function(_){Q(T,_)},MSPointerCancel:function(_){Q(T,_)},pointerupcaptured:function(_){ne(T,_)},pointermovecaptured:function(_){ge(T,_)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},f.startDisabled||this.setTracking(!0)},e.MouseTracker.prototype={destroy:function(){var f;for(o(this),this.element=null,f=0;f<t.length;f++)if(t[f]===this){t.splice(f,1);break}i[this.hash]=null,delete i[this.hash]},isTracking:function(){return i[this.hash].tracking},setTracking:function(f){return f?r(this):o(this),this},getActivePointersListsExceptType:function(f){for(var d=i[this.hash],T=[],_=0;_<d.activePointersLists.length;++_)d.activePointersLists[_].type!==f&&T.push(d.activePointersLists[_]);return T},getActivePointersListByType:function(f){var d=i[this.hash],T,_=d.activePointersLists.length,F;for(T=0;T<_;T++)if(d.activePointersLists[T].type===f)return d.activePointersLists[T];return F=new e.MouseTracker.GesturePointList(f),d.activePointersLists.push(F),F},getActivePointerCount:function(){var f=i[this.hash],d,T=f.activePointersLists.length,_=0;for(d=0;d<T;d++)_+=f.activePointersLists[d].getLength();return _},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},e.MouseTracker.resetAllMouseTrackers=function(){for(var f=0;f<t.length;f++)t[f].isTracking()&&(t[f].setTracking(!1),t[f].setTracking(!0))},e.MouseTracker.gesturePointVelocityTracker=function(){var f=[],d=0,T=0,_=function(Z,ee){return Z.hash.toString()+ee.type+ee.id.toString()},F=function(){var Z,ee=f.length,oe,se,me=e.now(),ie,ke,Fe;for(ie=me-T,T=me,Z=0;Z<ee;Z++)oe=f[Z],se=oe.gPoint,se.direction=Math.atan2(se.currentPos.y-oe.lastPos.y,se.currentPos.x-oe.lastPos.x),ke=oe.lastPos.distanceTo(se.currentPos),oe.lastPos=se.currentPos,Fe=1e3*ke/(ie+1),se.speed=.75*Fe+.25*se.speed},K=function(Z,ee){var oe=_(Z,ee);f.push({guid:oe,gPoint:ee,lastPos:ee.currentPos}),f.length===1&&(T=e.now(),d=window.setInterval(F,50))},V=function(Z,ee){var oe=_(Z,ee),se,me=f.length;for(se=0;se<me;se++)if(f[se].guid===oe){f.splice(se,1),me--,me===0&&window.clearInterval(d);break}};return{addPoint:K,removePoint:V}}(),e.MouseTracker.captureElement=document,e.MouseTracker.wheelEventName=e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",e.MouseTracker.supportsMouseCapture=function(){var f=document.createElement("div");return e.isFunction(f.setCapture)&&e.isFunction(f.releaseCapture)}(),e.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",e.MouseTracker.wheelEventName],e.MouseTracker.wheelEventName=="DOMMouseScroll"&&e.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||e.Browser.vendor!==e.BROWSERS.IE)?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),e.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?e.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:e.MouseTracker.maxTouchPoints=0,e.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),e.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?e.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:e.MouseTracker.maxTouchPoints=0,e.MouseTracker.haveMouseEnter=!1):(e.MouseTracker.havePointerEvents=!1,e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?(e.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),e.MouseTracker.haveMouseEnter=!0):(e.MouseTracker.subscribeEvents.push("mouseover","mouseout"),e.MouseTracker.haveMouseEnter=!1),e.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&e.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&e.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),e.MouseTracker.mousePointerId="legacy-mouse",e.MouseTracker.maxTouchPoints=10),e.MouseTracker.GesturePointList=function(f){this._gPoints=[],this.type=f,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},e.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(f){return this._gPoints.push(f)},removeById:function(f){var d,T=this._gPoints.length;for(d=0;d<T;d++)if(this._gPoints[d].id===f){this._gPoints.splice(d,1);break}return this._gPoints.length},getByIndex:function(f){return f<this._gPoints.length?this._gPoints[f]:null},getById:function(f){var d,T=this._gPoints.length;for(d=0;d<T;d++)if(this._gPoints[d].id===f)return this._gPoints[d];return null},getPrimary:function(f){var d,T=this._gPoints.length;for(d=0;d<T;d++)if(this._gPoints[d].isPrimary)return this._gPoints[d];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function n(f){var d=i[f.hash],T,_=d.activePointersLists.length;for(T=0;T<_;T++)d.activePointersLists[T].captureCount>0&&(e.removeEvent(e.MouseTracker.captureElement,"mousemove",d.mousemovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"mouseup",d.mouseupcaptured,!0),e.removeEvent(e.MouseTracker.captureElement,e.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",d.pointermovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,e.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",d.pointerupcaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"touchmove",d.touchmovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"touchend",d.touchendcaptured,!0),d.activePointersLists[T].captureCount=0);for(T=0;T<_;T++)d.activePointersLists.pop()}function r(f){var d=i[f.hash],T,_;if(!d.tracking){for(_=0;_<e.MouseTracker.subscribeEvents.length;_++)T=e.MouseTracker.subscribeEvents[_],e.addEvent(f.element,T,d[T],!1);n(f),d.tracking=!0}}function o(f){var d=i[f.hash],T,_;if(d.tracking){for(_=0;_<e.MouseTracker.subscribeEvents.length;_++)T=e.MouseTracker.subscribeEvents[_],e.removeEvent(f.element,T,d[T],!1);n(f),d.tracking=!1}}function s(f,d){var T=i[f.hash];if(d==="pointerevent")return{upName:e.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:T.pointerupcaptured,moveName:e.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:T.pointermovecaptured};if(d==="mouse")return{upName:"mouseup",upHandler:T.mouseupcaptured,moveName:"mousemove",moveHandler:T.mousemovecaptured};if(d==="touch")return{upName:"touchend",upHandler:T.touchendcaptured,moveName:"touchmove",moveHandler:T.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function a(f,d,T){var _=f.getActivePointersListByType(d),F;_.captureCount+=T||1,_.captureCount===1&&(e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?f.element.setCapture(!0):(F=s(f,e.MouseTracker.havePointerEvents?"pointerevent":d),Ye&&Ve(window.top)&&e.addEvent(window.top,F.upName,F.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,F.upName,F.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,F.moveName,F.moveHandler,!0)))}function l(f,d,T){var _=f.getActivePointersListByType(d),F;_.captureCount-=T||1,_.captureCount===0&&(e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?f.element.releaseCapture():(F=s(f,e.MouseTracker.havePointerEvents?"pointerevent":d),Ye&&Ve(window.top)&&e.removeEvent(window.top,F.upName,F.upHandler,!0),e.removeEvent(e.MouseTracker.captureElement,F.moveName,F.moveHandler,!0),e.removeEvent(e.MouseTracker.captureElement,F.upName,F.upHandler,!0)))}function c(f){var d;if(e.MouseTracker.unprefixedPointerEvents)d=f.pointerType;else switch(f.pointerType){case 2:d="touch";break;case 3:d="pen";break;case 4:d="mouse";break;default:d=""}return d}function g(f){return e.getMousePosition(f)}function v(f,d){return p(g(f),d)}function p(f,d){var T=e.getElementOffset(d);return f.minus(T)}function w(f,d){return new e.Point((f.x+d.x)/2,(f.y+d.y)/2)}function E(f,d){f.clickHandler&&e.cancelEvent(d)}function b(f,d){f.dblClickHandler&&e.cancelEvent(d)}function u(f,d){var T;f.keyDownHandler&&(d=e.getEvent(d),T=f.keyDownHandler({eventSource:f,keyCode:d.keyCode?d.keyCode:d.charCode,ctrl:d.ctrlKey,shift:d.shiftKey,alt:d.altKey,meta:d.metaKey,originalEvent:d,preventDefaultAction:!1,userData:f.userData}),T||e.cancelEvent(d))}function m(f,d){var T;f.keyUpHandler&&(d=e.getEvent(d),T=f.keyUpHandler({eventSource:f,keyCode:d.keyCode?d.keyCode:d.charCode,ctrl:d.ctrlKey,shift:d.shiftKey,alt:d.altKey,meta:d.metaKey,originalEvent:d,preventDefaultAction:!1,userData:f.userData}),T||e.cancelEvent(d))}function S(f,d){var T;f.keyHandler&&(d=e.getEvent(d),T=f.keyHandler({eventSource:f,keyCode:d.keyCode?d.keyCode:d.charCode,ctrl:d.ctrlKey,shift:d.shiftKey,alt:d.altKey,meta:d.metaKey,originalEvent:d,preventDefaultAction:!1,userData:f.userData}),T||e.cancelEvent(d))}function x(f,d){var T;f.focusHandler&&(d=e.getEvent(d),T=f.focusHandler({eventSource:f,originalEvent:d,preventDefaultAction:!1,userData:f.userData}),T===!1&&e.cancelEvent(d))}function D(f,d){var T;f.blurHandler&&(d=e.getEvent(d),T=f.blurHandler({eventSource:f,originalEvent:d,preventDefaultAction:!1,userData:f.userData}),T===!1&&e.cancelEvent(d))}function I(f,d){R(f,d,d)}function M(f,d){d=e.getEvent(d);var T={target:d.target||d.srcElement,type:"wheel",shiftKey:d.shiftKey||!1,clientX:d.clientX,clientY:d.clientY,pageX:d.pageX?d.pageX:d.clientX,pageY:d.pageY?d.pageY:d.clientY,deltaMode:d.type=="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};e.MouseTracker.wheelEventName=="mousewheel"?T.deltaY=-d.wheelDelta/e.DEFAULT_SETTINGS.pixelsPerWheelLine:T.deltaY=d.detail,R(f,T,d)}function R(f,d,T){var _=0,F;_=d.deltaY<0?1:-1,f.scrollHandler&&(F=f.scrollHandler({eventSource:f,pointerType:"mouse",position:v(d,f.element),scroll:_,shift:d.shiftKey,isTouchEvent:!1,originalEvent:T,preventDefaultAction:!1,userData:f.userData}),F===!1&&e.cancelEvent(T))}function L(f,d){if(f===d)return!1;for(;d&&d!==f;)d=d.parentNode;return d===f}function G(f,d){d=e.getEvent(d),k(f,d)}function U(f,d){d=e.getEvent(d),!(d.currentTarget===d.relatedTarget||L(d.currentTarget,d.relatedTarget))&&k(f,d)}function k(f,d){var T={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(d),currentTime:e.now()};pe(f,d,[T])}function J(f,d){d=e.getEvent(d),ce(f,d)}function te(f,d){d=e.getEvent(d),!(d.currentTarget===d.relatedTarget||L(d.currentTarget,d.relatedTarget))&&ce(f,d)}function ce(f,d){var T={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(d),currentTime:e.now()};ue(f,d,[T])}function fe(f){return e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?f===1?0:f===2?2:f===4?1:-1:f}function he(f,d){var T;d=e.getEvent(d),T={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(d),currentTime:e.now()},_e(f,d,[T],fe(d.button))&&(e.stopEvent(d),a(f,"mouse")),(f.clickHandler||f.dblClickHandler||f.pressHandler||f.dragHandler||f.dragEndHandler)&&e.cancelEvent(d)}function Y(f,d){Ee(f,d)}function we(f,d){Ee(f,d),e.stopEvent(d)}function Ee(f,d){var T;d=e.getEvent(d),T={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(d),currentTime:e.now()},He(f,d,[T],fe(d.button))&&l(f,"mouse")}function Ae(f,d){Me(f,d)}function Ce(f,d){Me(f,d),e.stopEvent(d)}function Me(f,d){var T;d=e.getEvent(d),T={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:g(d),currentTime:e.now()},qe(f,d,[T])}function xe(f,d,T){var _,F=T.getLength(),K=[];if(T.type==="touch"||T.contacts>0){for(_=0;_<F;_++)K.push(T.getByIndex(_));K.length>0&&(He(f,d,K,0),T.captureCount=1,l(f,T.type),ue(f,d,K))}}function Se(f,d){var T,_,F,K=d.changedTouches.length,V=[],Z,ee=f.getActivePointersListByType("touch");for(T=e.now(),ee.getLength()>d.touches.length-K&&(e.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),xe(f,d,ee)),_=0;_<K;_++)V.push({id:d.changedTouches[_].identifier,type:"touch",currentPos:g(d.changedTouches[_]),currentTime:T});for(pe(f,d,V),_=0;_<t.length;_++)if(t[_]!==f&&t[_].isTracking()&&L(t[_].element,f.element)){for(Z=[],F=0;F<K;F++)Z.push({id:d.changedTouches[F].identifier,type:"touch",currentPos:g(d.changedTouches[F]),currentTime:T});pe(t[_],d,Z)}_e(f,d,V,0)&&(e.stopEvent(d),a(f,"touch",K)),e.cancelEvent(d)}function be(f,d){ze(f,d)}function Le(f,d){ze(f,d),e.stopEvent(d)}function ze(f,d){var T,_,F,K=d.changedTouches.length,V=[],Z;for(T=e.now(),_=0;_<K;_++)V.push({id:d.changedTouches[_].identifier,type:"touch",currentPos:g(d.changedTouches[_]),currentTime:T});for(He(f,d,V,0)&&l(f,"touch",K),ue(f,d,V),_=0;_<t.length;_++)if(t[_]!==f&&t[_].isTracking()&&L(t[_].element,f.element)){for(Z=[],F=0;F<K;F++)Z.push({id:d.changedTouches[F].identifier,type:"touch",currentPos:g(d.changedTouches[F]),currentTime:T});ue(t[_],d,Z)}e.cancelEvent(d)}function Oe(f,d){De(f,d)}function Be(f,d){De(f,d),e.stopEvent(d)}function De(f,d){var T,_=d.changedTouches.length,F=[];for(T=0;T<_;T++)F.push({id:d.changedTouches[T].identifier,type:"touch",currentPos:g(d.changedTouches[T]),currentTime:e.now()});qe(f,d,F),e.cancelEvent(d)}function Ne(f,d){var T=f.getActivePointersListByType("touch");xe(f,d,T)}function Ie(f,d){return d.stopPropagation(),d.preventDefault(),!1}function h(f,d){return d.stopPropagation(),d.preventDefault(),!1}function y(f,d){var T;d.currentTarget===d.relatedTarget||L(d.currentTarget,d.relatedTarget)||(T={id:d.pointerId,type:c(d),isPrimary:d.isPrimary,currentPos:g(d),currentTime:e.now()},pe(f,d,[T]))}function O(f,d){var T;d.currentTarget===d.relatedTarget||L(d.currentTarget,d.relatedTarget)||(T={id:d.pointerId,type:c(d),isPrimary:d.isPrimary,currentPos:g(d),currentTime:e.now()},ue(f,d,[T]))}function N(f,d){var T;T={id:d.pointerId,type:c(d),isPrimary:d.isPrimary,currentPos:g(d),currentTime:e.now()},_e(f,d,[T],d.button)&&(e.stopEvent(d),a(f,T.type)),(f.clickHandler||f.dblClickHandler||f.pressHandler||f.dragHandler||f.dragEndHandler||f.pinchHandler)&&e.cancelEvent(d)}function H(f,d){j(f,d)}function ne(f,d){var T=f.getActivePointersListByType(c(d));T.getById(d.pointerId)&&j(f,d),e.stopEvent(d)}function j(f,d){var T;T={id:d.pointerId,type:c(d),isPrimary:d.isPrimary,currentPos:g(d),currentTime:e.now()},He(f,d,[T],d.button)&&l(f,T.type)}function le(f,d){ae(f,d)}function ge(f,d){var T=f.getActivePointersListByType(c(d));T.getById(d.pointerId)&&ae(f,d),e.stopEvent(d)}function ae(f,d){var T;T={id:d.pointerId,type:c(d),isPrimary:d.isPrimary,currentPos:g(d),currentTime:e.now()},qe(f,d,[T])}function Q(f,d){var T;T={id:d.pointerId,type:c(d)},Xe(f,d,[T])}function z(f,d){return Object.prototype.hasOwnProperty.call(d,"isPrimary")||(f.getLength()===0?d.isPrimary=!0:d.isPrimary=!1),d.speed=0,d.direction=0,d.contactPos=d.currentPos,d.contactTime=d.currentTime,d.lastPos=d.currentPos,d.lastTime=d.currentTime,f.add(d)}function re(f,d){var T,_;return f.getById(d.id)?(T=f.removeById(d.id),Object.prototype.hasOwnProperty.call(d,"isPrimary")||(_=f.getPrimary(),_||(_=f.getByIndex(0),_&&(_.isPrimary=!0)))):T=f.getLength(),T}function pe(f,d,T){var _=f.getActivePointersListByType(T[0].type),F,K=T.length,V,Z,ee;for(F=0;F<K;F++)V=T[F],Z=_.getById(V.id),Z?(Z.insideElement=!0,Z.lastPos=Z.currentPos,Z.lastTime=Z.currentTime,Z.currentPos=V.currentPos,Z.currentTime=V.currentTime,V=Z):(V.captured=!1,V.insideElementPressed=!1,V.insideElement=!0,z(_,V)),f.enterHandler&&(ee=f.enterHandler({eventSource:f,pointerType:V.type,position:p(V.currentPos,f.element),buttons:_.buttons,pointers:f.getActivePointerCount(),insideElementPressed:V.insideElementPressed,buttonDownAny:_.buttons!==0,isTouchEvent:V.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),ee===!1&&e.cancelEvent(d))}function ue(f,d,T){var _=f.getActivePointersListByType(T[0].type),F,K=T.length,V,Z,ee;for(F=0;F<K;F++)V=T[F],Z=_.getById(V.id),Z&&(Z.captured?(Z.insideElement=!1,Z.lastPos=Z.currentPos,Z.lastTime=Z.currentTime,Z.currentPos=V.currentPos,Z.currentTime=V.currentTime):re(_,Z),V=Z),f.exitHandler&&(ee=f.exitHandler({eventSource:f,pointerType:V.type,position:V.currentPos&&p(V.currentPos,f.element),buttons:_.buttons,pointers:f.getActivePointerCount(),insideElementPressed:Z?Z.insideElementPressed:!1,buttonDownAny:_.buttons!==0,isTouchEvent:V.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),ee===!1&&e.cancelEvent(d))}function _e(f,d,T,_){var F=i[f.hash],K,V=f.getActivePointersListByType(T[0].type),Z,ee=T.length,oe,se;typeof d.buttons!="undefined"?V.buttons=d.buttons:e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?_===0?V.buttons+=1:_===1?V.buttons+=4:_===2?V.buttons+=2:_===3?V.buttons+=8:_===4?V.buttons+=16:_===5&&(V.buttons+=32):_===0?V.buttons|=1:_===1?V.buttons|=4:_===2?V.buttons|=2:_===3?V.buttons|=8:_===4?V.buttons|=16:_===5&&(V.buttons|=32);var me=f.getActivePointersListsExceptType(T[0].type);for(Z=0;Z<me.length;Z++)xe(f,d,me[Z]);if(_!==0)return f.nonPrimaryPressHandler&&(K=f.nonPrimaryPressHandler({eventSource:f,pointerType:T[0].type,position:p(T[0].currentPos,f.element),button:_,buttons:V.buttons,isTouchEvent:T[0].type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),K===!1&&e.cancelEvent(d)),!1;for(Z=0;Z<ee;Z++)oe=T[Z],se=V.getById(oe.id),se?(se.captured=!0,se.insideElementPressed=!0,se.insideElement=!0,se.contactPos=oe.currentPos,se.contactTime=oe.currentTime,se.lastPos=se.currentPos,se.lastTime=se.currentTime,se.currentPos=oe.currentPos,se.currentTime=oe.currentTime,oe=se):(oe.captured=!0,oe.insideElementPressed=!0,oe.insideElement=!0,z(V,oe)),V.addContact(),(f.dragHandler||f.dragEndHandler||f.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.addPoint(f,oe),V.contacts===1?f.pressHandler&&(K=f.pressHandler({eventSource:f,pointerType:oe.type,position:p(oe.contactPos,f.element),buttons:V.buttons,isTouchEvent:oe.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),K===!1&&e.cancelEvent(d)):V.contacts===2&&f.pinchHandler&&oe.type==="touch"&&(F.pinchGPoints=V.asArray(),F.lastPinchDist=F.currentPinchDist=F.pinchGPoints[0].currentPos.distanceTo(F.pinchGPoints[1].currentPos),F.lastPinchCenter=F.currentPinchCenter=w(F.pinchGPoints[0].currentPos,F.pinchGPoints[1].currentPos));return!0}function He(f,d,T,_){var F=i[f.hash],K=f.getActivePointersListByType(T[0].type),V,Z,ee,oe,se=T.length,me,ie,ke=!1,Fe=!1,Ge;if(typeof d.buttons!="undefined"?K.buttons=d.buttons:e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?_===0?K.buttons-=1:_===1?K.buttons-=4:_===2?K.buttons-=2:_===3?K.buttons-=8:_===4?K.buttons-=16:_===5&&(K.buttons-=32):_===0?K.buttons^=~1:_===1?K.buttons^=~4:_===2?K.buttons^=~2:_===3?K.buttons^=~8:_===4?K.buttons^=~16:_===5&&(K.buttons^=~32),_!==0){f.nonPrimaryReleaseHandler&&(V=f.nonPrimaryReleaseHandler({eventSource:f,pointerType:T[0].type,position:p(T[0].currentPos,f.element),button:_,buttons:K.buttons,isTouchEvent:T[0].type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),V===!1&&e.cancelEvent(d));var Re=f.getActivePointersListByType("mouse");return xe(f,d,Re),!1}if(typeof T[0].currentPos=="undefined")return xe(f,d,K),!1;for(oe=0;oe<se;oe++)me=T[oe],ie=K.getById(me.id),ie&&(ie.captured&&(ie.captured=!1,ke=!0,Fe=!0),ie.lastPos=ie.currentPos,ie.lastTime=ie.currentTime,ie.currentPos=me.currentPos,ie.currentTime=me.currentTime,ie.insideElement||re(K,ie),Z=ie.currentPos,ee=ie.currentTime,Fe?(K.removeContact(),(f.dragHandler||f.dragEndHandler||f.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.removePoint(f,ie),K.contacts===0?(f.releaseHandler&&(V=f.releaseHandler({eventSource:f,pointerType:ie.type,position:p(Z,f.element),buttons:K.buttons,insideElementPressed:ie.insideElementPressed,insideElementReleased:ie.insideElement,isTouchEvent:ie.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),V===!1&&e.cancelEvent(d)),f.dragEndHandler&&!ie.currentPos.equals(ie.contactPos)&&(V=f.dragEndHandler({eventSource:f,pointerType:ie.type,position:p(ie.currentPos,f.element),speed:ie.speed,direction:ie.direction,shift:d.shiftKey,isTouchEvent:ie.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),V===!1&&e.cancelEvent(d)),(f.clickHandler||f.dblClickHandler)&&ie.insideElement&&(Ge=ee-ie.contactTime<=f.clickTimeThreshold&&ie.contactPos.distanceTo(Z)<=f.clickDistThreshold,f.clickHandler&&(V=f.clickHandler({eventSource:f,pointerType:ie.type,position:p(ie.currentPos,f.element),quick:Ge,shift:d.shiftKey,isTouchEvent:ie.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),V===!1&&e.cancelEvent(d)),f.dblClickHandler&&Ge&&(K.clicks++,K.clicks===1?(F.lastClickPos=Z,F.dblClickTimeOut=setTimeout(function(){K.clicks=0},f.dblClickTimeThreshold)):K.clicks===2&&(clearTimeout(F.dblClickTimeOut),K.clicks=0,F.lastClickPos.distanceTo(Z)<=f.dblClickDistThreshold&&(V=f.dblClickHandler({eventSource:f,pointerType:ie.type,position:p(ie.currentPos,f.element),shift:d.shiftKey,isTouchEvent:ie.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),V===!1&&e.cancelEvent(d)),F.lastClickPos=null)))):K.contacts===2&&f.pinchHandler&&ie.type==="touch"&&(F.pinchGPoints=K.asArray(),F.lastPinchDist=F.currentPinchDist=F.pinchGPoints[0].currentPos.distanceTo(F.pinchGPoints[1].currentPos),F.lastPinchCenter=F.currentPinchCenter=w(F.pinchGPoints[0].currentPos,F.pinchGPoints[1].currentPos))):f.releaseHandler&&(V=f.releaseHandler({eventSource:f,pointerType:ie.type,position:p(Z,f.element),buttons:K.buttons,insideElementPressed:ie.insideElementPressed,insideElementReleased:ie.insideElement,isTouchEvent:ie.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),V===!1&&e.cancelEvent(d)));return ke}function qe(f,d,T){var _=i[f.hash],F=f.getActivePointersListByType(T[0].type),K,V=T.length,Z,ee,oe,se,me;for(typeof d.buttons!="undefined"&&(F.buttons=d.buttons),K=0;K<V;K++)Z=T[K],ee=F.getById(Z.id),ee?(Object.prototype.hasOwnProperty.call(Z,"isPrimary")&&(ee.isPrimary=Z.isPrimary),ee.lastPos=ee.currentPos,ee.lastTime=ee.currentTime,ee.currentPos=Z.currentPos,ee.currentTime=Z.currentTime):(Z.captured=!1,Z.insideElementPressed=!1,Z.insideElement=!0,z(F,Z));f.stopHandler&&T[0].type==="mouse"&&(clearTimeout(f.stopTimeOut),f.stopTimeOut=setTimeout(function(){tt(f,d,T[0].type)},f.stopDelay)),F.contacts===0?f.moveHandler&&(me=f.moveHandler({eventSource:f,pointerType:T[0].type,position:p(T[0].currentPos,f.element),buttons:F.buttons,isTouchEvent:T[0].type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),me===!1&&e.cancelEvent(d)):F.contacts===1?(f.moveHandler&&(ee=F.asArray()[0],me=f.moveHandler({eventSource:f,pointerType:ee.type,position:p(ee.currentPos,f.element),buttons:F.buttons,isTouchEvent:ee.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),me===!1&&e.cancelEvent(d)),f.dragHandler&&(ee=F.asArray()[0],se=ee.currentPos.minus(ee.lastPos),me=f.dragHandler({eventSource:f,pointerType:ee.type,position:p(ee.currentPos,f.element),buttons:F.buttons,delta:se,speed:ee.speed,direction:ee.direction,shift:d.shiftKey,isTouchEvent:ee.type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),me===!1&&e.cancelEvent(d))):F.contacts===2&&(f.moveHandler&&(oe=F.asArray(),me=f.moveHandler({eventSource:f,pointerType:oe[0].type,position:p(w(oe[0].currentPos,oe[1].currentPos),f.element),buttons:F.buttons,isTouchEvent:oe[0].type==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData}),me===!1&&e.cancelEvent(d)),f.pinchHandler&&T[0].type==="touch"&&(se=_.pinchGPoints[0].currentPos.distanceTo(_.pinchGPoints[1].currentPos),se!=_.currentPinchDist&&(_.lastPinchDist=_.currentPinchDist,_.currentPinchDist=se,_.lastPinchCenter=_.currentPinchCenter,_.currentPinchCenter=w(_.pinchGPoints[0].currentPos,_.pinchGPoints[1].currentPos),me=f.pinchHandler({eventSource:f,pointerType:"touch",gesturePoints:_.pinchGPoints,lastCenter:p(_.lastPinchCenter,f.element),center:p(_.currentPinchCenter,f.element),lastDistance:_.lastPinchDist,distance:_.currentPinchDist,shift:d.shiftKey,originalEvent:d,preventDefaultAction:!1,userData:f.userData}),me===!1&&e.cancelEvent(d))))}function Xe(f,d,T){He(f,d,T,0),ue(f,d,T)}function tt(f,d,T){f.stopHandler&&f.stopHandler({eventSource:f,pointerType:T,position:v(d,f.element),buttons:f.getActivePointersListByType(T).buttons,isTouchEvent:T==="touch",originalEvent:d,preventDefaultAction:!1,userData:f.userData})}var Ye=function(){try{return window.self!==window.top}catch{return!0}}();function Ve(f){try{return f.addEventListener&&f.removeEventListener}catch{return!1}}}(OpenSeadragon),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},e.Control=function(t,i,n){var r=t.parentNode;typeof i=="number"&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),i={anchor:i}),i.attachToViewer=typeof i.attachToViewer=="undefined"?!0:i.attachToViewer,this.autoFade=typeof i.autoFade=="undefined"?!0:i.autoFade,this.element=t,this.anchor=i.anchor,this.container=n,this.anchor==e.ControlAnchor.ABSOLUTE?(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof i.top=="number"?i.top+"px":i.top,this.wrapper.style.left=typeof i.left=="number"?i.left+"px":i.left,this.wrapper.style.height=typeof i.height=="number"?i.height+"px":i.height,this.wrapper.style.width=typeof i.width=="number"?i.width+"px":i.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),i.attachToViewer?this.anchor==e.ControlAnchor.TOP_RIGHT||this.anchor==e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):r.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!="none"},setVisible:function(t){this.wrapper.style.display=t?this.anchor==e.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(t){this.element[e.SIGNAL]&&e.Browser.vendor==e.BROWSERS.IE?e.setElementOpacity(this.element,t,!0):e.setElementOpacity(this.wrapper,t,!0)}}}(OpenSeadragon),function(e){e.ControlDock=function(i){var n=["topleft","topright","bottomright","bottomleft"],r,o;for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(Math.random()*1e6),container:e.makeNeutralElement("div"),controls:[]},i),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),o=0;o<n.length;o++)r=n[o],this.controls[r]=e.makeNeutralElement("div"),this.controls[r].style.position="absolute",r.match("left")&&(this.controls[r].style.left="0px"),r.match("right")&&(this.controls[r].style.right="0px"),r.match("top")&&(this.controls[r].style.top="0px"),r.match("bottom")&&(this.controls[r].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(i,n){i=e.getElement(i);var r=null;if(!(t(this,i)>=0)){switch(n.anchor){case e.ControlAnchor.TOP_RIGHT:r=this.controls.topright,i.style.position="relative",i.style.paddingRight="0px",i.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:r=this.controls.bottomright,i.style.position="relative",i.style.paddingRight="0px",i.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:r=this.controls.bottomleft,i.style.position="relative",i.style.paddingLeft="0px",i.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:r=this.controls.topleft,i.style.position="relative",i.style.paddingLeft="0px",i.style.paddingTop="0px";break;case e.ControlAnchor.ABSOLUTE:r=this.container,i.style.margin="0px",i.style.padding="0px";break;default:case e.ControlAnchor.NONE:r=this.container,i.style.margin="0px",i.style.padding="0px";break}this.controls.push(new e.Control(i,n,r)),i.style.display="inline-block"}},removeControl:function(i){i=e.getElement(i);var n=t(this,i);return n>=0&&(this.controls[n].destroy(),this.controls.splice(n,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var i;for(i=this.controls.length-1;i>=0;i--)if(this.controls[i].isVisible())return!0;return!1},setControlsEnabled:function(i){var n;for(n=this.controls.length-1;n>=0;n--)this.controls[n].setVisible(i);return this}};function t(i,n){var r=i.controls,o;for(o=r.length-1;o>=0;o--)if(r[o].element==n)return o;return-1}}(OpenSeadragon),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(e){var t={},i=1;e.Viewer=function(h){var y=arguments,O=this,N;if(e.isPlainObject(h)||(h={id:y[0],xmlPath:y.length>1?y[1]:void 0,prefixUrl:y.length>2?y[2]:void 0,controls:y.length>3?y[3]:void 0,overlays:y.length>4?y[4]:void 0}),h.config&&(e.extend(!0,h,h.config),delete h.config),e.extend(!0,this,{id:h.id,hash:h.hash||i++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},e.DEFAULT_SETTINGS,h),typeof this.hash=="undefined")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof t[this.hash]!="undefined"&&e.console.warn("Hash "+this.hash+" has already been used."),t[this.hash]={fsBoundsDelta:new e.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=e.now(),e.EventSource.call(this),this.addHandler("open-failed",function(H){var ne=e.getString("Errors.OpenFailed",H.eventSource,H.message);O._showMessage(ne)}),e.ControlDock.call(this,h),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=e.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(H){H.width="100%",H.height="100%",H.overflow="hidden",H.position="absolute",H.top="0px",H.left="0px"}(this.canvas.style),e.setElementTouchActionNone(this.canvas),h.tabIndex!==""&&(this.canvas.tabIndex=h.tabIndex===void 0?0:h.tabIndex),this.container.className="openseadragon-container",function(H){H.width="100%",H.height="100%",H.position="relative",H.overflow="hidden",H.left="0px",H.top="0px",H.textAlign="left"}(this.container.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new e.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:e.delegate(this,E),keyHandler:e.delegate(this,b),clickHandler:e.delegate(this,u),dblClickHandler:e.delegate(this,m),dragHandler:e.delegate(this,S),dragEndHandler:e.delegate(this,x),enterHandler:e.delegate(this,D),exitHandler:e.delegate(this,I),pressHandler:e.delegate(this,M),releaseHandler:e.delegate(this,R),nonPrimaryPressHandler:e.delegate(this,L),nonPrimaryReleaseHandler:e.delegate(this,G),scrollHandler:e.delegate(this,k),pinchHandler:e.delegate(this,U)}),this.outerTracker=new e.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:e.delegate(this,J),exitHandler:e.delegate(this,te)}),this.toolbar&&(this.toolbar=new e.ControlDock({element:this.toolbar})),this.bindStandardControls(),t[this.hash].prevContainerSize=n(this.container),this.world=new e.World({viewer:this}),this.world.addHandler("add-item",function(H){O.source=O.world.getItemAt(0).source,t[O.hash].forceRedraw=!0,O._updateRequestId||(O._updateRequestId=a(O,ce))}),this.world.addHandler("remove-item",function(H){O.world.getItemCount()?O.source=O.world.getItemAt(0).source:O.source=null,t[O.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(H){O.viewport&&O.viewport._setContentBounds(O.world.getHomeBounds(),O.world.getContentFactor())}),this.world.addHandler("item-index-change",function(H){O.source=O.world.getItemAt(0).source}),this.viewport=new e.Viewport({containerSize:t[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new e.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:h.timeout}),this.tileCache=new e.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new e.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=e.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(N=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(N,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(N=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(N,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new e.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),N=0;N<this.customControls.length;N++)this.addControl(this.customControls[N].id,{anchor:this.customControls[N].anchor});e.requestAnimationFrame(function(){c(O)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled)},e.extend(e.Viewer.prototype,e.EventSource.prototype,e.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(h){return e.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(h)},openTileSource:function(h){return e.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(h)},open:function(h,y){var O=this;if(this.close(),!!h){if(this.sequenceMode&&e.isArray(h)){this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof y!="undefined"&&!isNaN(y)&&(this.initialPage=y),this.tileSources=h,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex);return}if(e.isArray(h)||(h=[h]),!!h.length){this._opening=!0;for(var N=h.length,H=0,ne=0,j,le=function(){if(H+ne===N)if(H){(O._firstOpen||!O.preserveViewport)&&(O.viewport.goHome(!0),O.viewport.update()),O._firstOpen=!1;var Q=h[0];if(Q.tileSource&&(Q=Q.tileSource),O.overlays&&!O.preserveOverlays)for(var z=0;z<O.overlays.length;z++)O.currentOverlays[z]=o(O,O.overlays[z]);O._drawOverlays(),O._opening=!1,O.raiseEvent("open",{source:Q})}else O._opening=!1,O.raiseEvent("open-failed",j)},ge=function(Q){(!e.isPlainObject(Q)||!Q.tileSource)&&(Q={tileSource:Q}),Q.index!==void 0&&(e.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete Q.index),Q.collectionImmediately===void 0&&(Q.collectionImmediately=!0);var z=Q.success;Q.success=function(pe){if(H++,Q.tileSource.overlays)for(var ue=0;ue<Q.tileSource.overlays.length;ue++)O.addOverlay(Q.tileSource.overlays[ue]);z&&z(pe),le()};var re=Q.error;Q.error=function(pe){ne++,j||(j=pe),re&&re(pe),le()},O.addTiledImage(Q)},ae=0;ae<h.length;ae++)ge(h[ae]);return this}}},close:function(){return t[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),t[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(!!t[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(e.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),t[this.hash]=null,delete t[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(h){return this.innerTracker.setTracking(h),this.outerTracker.setTracking(h),this.raiseEvent("mouse-enabled",{enabled:h}),this},areControlsEnabled:function(){var h=this.controls.length,y;for(y=0;y<this.controls.length;y++)h=h&&this.controls[y].isVisible();return h},setControlsEnabled:function(h){return h?v(this):c(this),this.raiseEvent("controls-enabled",{enabled:h}),this},setDebugMode:function(h){for(var y=0;y<this.world.getItemCount();y++)this.world.getItemAt(y).debugMode=h;this.debugMode=h,this.forceRedraw()},isFullPage:function(){return t[this.hash].fullPage},setFullPage:function(h){var y=document.body,O=y.style,N=document.documentElement.style,H=this,ne,j;if(h==this.isFullPage())return this;var le={fullPage:h,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",le),le.preventDefaultAction)return this;if(h){for(this.elementSize=e.getElementSize(this.element),this.pageScroll=e.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=O.margin,this.docMargin=N.margin,O.margin="0",N.margin="0",this.bodyPadding=O.padding,this.docPadding=N.padding,O.padding="0",N.padding="0",this.bodyWidth=O.width,this.docWidth=N.width,O.width="100%",N.width="100%",this.bodyHeight=O.height,this.docHeight=N.height,O.height="100%",N.height="100%",this.previousBody=[],t[this.hash].prevElementParent=this.element.parentNode,t[this.hash].prevNextSibling=this.element.nextSibling,t[this.hash].prevElementWidth=this.element.style.width,t[this.hash].prevElementHeight=this.element.style.height,ne=y.childNodes.length,j=0;j<ne;j++)this.previousBody.push(y.childNodes[0]),y.removeChild(y.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,y.appendChild(this.toolbar.element),e.addClass(this.toolbar.element,"fullpage")),e.addClass(this.element,"fullpage"),y.appendChild(this.element),this.element.style.height=e.getWindowSize().y+"px",this.element.style.width=e.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=e.getElementSize(this.element).y-e.getElementSize(this.toolbar.element).y+"px"),t[this.hash].fullPage=!0,e.delegate(this,J)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,O.margin=this.bodyMargin,N.margin=this.docMargin,O.padding=this.bodyPadding,N.padding=this.docPadding,O.width=this.bodyWidth,N.width=this.docWidth,O.height=this.bodyHeight,N.height=this.docHeight,y.removeChild(this.element),ne=this.previousBody.length,j=0;j<ne;j++)y.appendChild(this.previousBody.shift());e.removeClass(this.element,"fullpage"),t[this.hash].prevElementParent.insertBefore(this.element,t[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(y.removeChild(this.toolbar.element),e.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=t[this.hash].prevElementWidth,this.element.style.height=t[this.hash].prevElementHeight;var ge=0,ae=function(){e.setPageScroll(H.pageScroll);var Q=e.getPageScroll();ge++,ge<10&&(Q.x!==H.pageScroll.x||Q.y!==H.pageScroll.y)&&e.requestAnimationFrame(ae)};e.requestAnimationFrame(ae),t[this.hash].fullPage=!1,e.delegate(this,te)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:h}),this},setFullScreen:function(h){var y=this;if(!e.supportsFullScreen)return this.setFullPage(h);if(e.isFullScreen()===h)return this;var O={fullScreen:h,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",O),O.preventDefaultAction)return this;if(h){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var N=function(){var H=e.isFullScreen();H||(e.removeEvent(document,e.fullScreenEventName,N),e.removeEvent(document,e.fullScreenErrorEventName,N),y.setFullPage(!1),y.isFullPage()&&(y.element.style.width=y.fullPageStyleWidth,y.element.style.height=y.fullPageStyleHeight)),y.navigator&&y.viewport&&setTimeout(function(){y.navigator.update(y.viewport)}),y.raiseEvent("full-screen",{fullScreen:H})};e.addEvent(document,e.fullScreenEventName,N),e.addEvent(document,e.fullScreenErrorEventName,N),e.requestFullScreen(document.body)}else e.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!="hidden"},setVisible:function(h){return this.container.style.visibility=h?"":"hidden",this.raiseEvent("visible",{visible:h}),this},addTiledImage:function(h){e.console.assert(h,"[Viewer.addTiledImage] options is required"),e.console.assert(h.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),e.console.assert(!h.replace||h.index>-1&&h.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var y=this;h.replace&&(h.replaceItem=y.world.getItemAt(h.index)),this._hideMessage(),h.placeholderFillStyle===void 0&&(h.placeholderFillStyle=this.placeholderFillStyle),h.opacity===void 0&&(h.opacity=this.opacity),h.preload===void 0&&(h.preload=this.preload),h.compositeOperation===void 0&&(h.compositeOperation=this.compositeOperation),h.crossOriginPolicy===void 0&&(h.crossOriginPolicy=h.tileSource.crossOriginPolicy!==void 0?h.tileSource.crossOriginPolicy:this.crossOriginPolicy),h.ajaxWithCredentials===void 0&&(h.ajaxWithCredentials=this.ajaxWithCredentials),h.loadTilesWithAjax===void 0&&(h.loadTilesWithAjax=this.loadTilesWithAjax),h.ajaxHeaders===void 0||h.ajaxHeaders===null?h.ajaxHeaders=this.ajaxHeaders:e.isPlainObject(h.ajaxHeaders)&&e.isPlainObject(this.ajaxHeaders)&&(h.ajaxHeaders=e.extend({},this.ajaxHeaders,h.ajaxHeaders));var O={options:h};function N(j){for(var le=0;le<y._loadQueue.length;le++)if(y._loadQueue[le]===O){y._loadQueue.splice(le,1);break}y._loadQueue.length===0&&H(O),y.raiseEvent("add-item-failed",j),h.error&&h.error(j)}function H(j){y.collectionMode&&(y.world.arrange({immediately:j.options.collectionImmediately,rows:y.collectionRows,columns:y.collectionColumns,layout:y.collectionLayout,tileSize:y.collectionTileSize,tileMargin:y.collectionTileMargin}),y.world.setAutoRefigureSizes(!0))}if(e.isArray(h.tileSource)){setTimeout(function(){N({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:h.tileSource,options:h})});return}this._loadQueue.push(O);function ne(){for(var j,le,ge;y._loadQueue.length&&(j=y._loadQueue[0],!!j.tileSource);){if(y._loadQueue.splice(0,1),j.options.replace){var ae=y.world.getIndexOfItem(j.options.replaceItem);ae!=-1&&(j.options.index=ae),y.world.removeItem(j.options.replaceItem)}le=new e.TiledImage({viewer:y,source:j.tileSource,viewport:y.viewport,drawer:y.drawer,tileCache:y.tileCache,imageLoader:y.imageLoader,x:j.options.x,y:j.options.y,width:j.options.width,height:j.options.height,fitBounds:j.options.fitBounds,fitBoundsPlacement:j.options.fitBoundsPlacement,clip:j.options.clip,placeholderFillStyle:j.options.placeholderFillStyle,opacity:j.options.opacity,preload:j.options.preload,degrees:j.options.degrees,compositeOperation:j.options.compositeOperation,springStiffness:y.springStiffness,animationTime:y.animationTime,minZoomImageRatio:y.minZoomImageRatio,wrapHorizontal:y.wrapHorizontal,wrapVertical:y.wrapVertical,immediateRender:y.immediateRender,blendTime:y.blendTime,alwaysBlend:y.alwaysBlend,minPixelRatio:y.minPixelRatio,smoothTileEdgesMinZoom:y.smoothTileEdgesMinZoom,iOSDevice:y.iOSDevice,crossOriginPolicy:j.options.crossOriginPolicy,ajaxWithCredentials:j.options.ajaxWithCredentials,loadTilesWithAjax:j.options.loadTilesWithAjax,ajaxHeaders:j.options.ajaxHeaders,debugMode:y.debugMode}),y.collectionMode&&y.world.setAutoRefigureSizes(!1),y.world.addItem(le,{index:j.options.index}),y._loadQueue.length===0&&H(j),y.world.getItemCount()===1&&!y.preserveViewport&&y.viewport.goHome(!0),y.navigator&&(ge=e.extend({},j.options,{replace:!1,originalTiledImage:le,tileSource:j.tileSource}),y.navigator.addTiledImage(ge)),j.options.success&&j.options.success({item:le})}}r(this,h.tileSource,h,function(j){O.tileSource=j,ne()},function(j){j.options=h,N(j),ne()})},addSimpleImage:function(h){e.console.assert(h,"[Viewer.addSimpleImage] options is required"),e.console.assert(h.url,"[Viewer.addSimpleImage] options.url is required");var y=e.extend({},h,{tileSource:{type:"image",url:h.url}});delete y.url,this.addTiledImage(y)},addLayer:function(h){var y=this;e.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var O=e.extend({},h,{success:function(N){y.raiseEvent("add-layer",{options:h,drawer:N.item})},error:function(N){y.raiseEvent("add-layer-failed",N)}});return this.addTiledImage(O),this},getLayerAtLevel:function(h){return e.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(h)},getLevelOfLayer:function(h){return e.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(h)},getLayersCount:function(){return e.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(h,y){return e.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(h,y)},removeLayer:function(h){return e.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(h)},forceRedraw:function(){return t[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var h=e.delegate(this,p),y=e.delegate(this,w),O=e.delegate(this,Ie),N=e.delegate(this,Ne),H=this.navImages,ne=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(ne=!1),this.previousButton=new e.Button({element:this.previousButton?e.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.PreviousPage"),srcRest:Y(this.prefixUrl,H.previous.REST),srcGroup:Y(this.prefixUrl,H.previous.GROUP),srcHover:Y(this.prefixUrl,H.previous.HOVER),srcDown:Y(this.prefixUrl,H.previous.DOWN),onRelease:N,onFocus:h,onBlur:y}),this.nextButton=new e.Button({element:this.nextButton?e.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.NextPage"),srcRest:Y(this.prefixUrl,H.next.REST),srcGroup:Y(this.prefixUrl,H.next.GROUP),srcHover:Y(this.prefixUrl,H.next.HOVER),srcDown:Y(this.prefixUrl,H.next.DOWN),onRelease:O,onFocus:h,onBlur:y}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),ne&&(this.paging=new e.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:e.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var h=e.delegate(this,we),y=e.delegate(this,Ae),O=e.delegate(this,xe),N=e.delegate(this,Ee),H=e.delegate(this,Se),ne=e.delegate(this,Le),j=e.delegate(this,ze),le=e.delegate(this,Oe),ge=e.delegate(this,Be),ae=e.delegate(this,De),Q=e.delegate(this,p),z=e.delegate(this,w),re=this.navImages,pe=[],ue=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(ue=!1),this.showZoomControl&&(pe.push(this.zoomInButton=new e.Button({element:this.zoomInButton?e.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomIn"),srcRest:Y(this.prefixUrl,re.zoomIn.REST),srcGroup:Y(this.prefixUrl,re.zoomIn.GROUP),srcHover:Y(this.prefixUrl,re.zoomIn.HOVER),srcDown:Y(this.prefixUrl,re.zoomIn.DOWN),onPress:h,onRelease:y,onClick:O,onEnter:h,onExit:y,onFocus:Q,onBlur:z})),pe.push(this.zoomOutButton=new e.Button({element:this.zoomOutButton?e.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomOut"),srcRest:Y(this.prefixUrl,re.zoomOut.REST),srcGroup:Y(this.prefixUrl,re.zoomOut.GROUP),srcHover:Y(this.prefixUrl,re.zoomOut.HOVER),srcDown:Y(this.prefixUrl,re.zoomOut.DOWN),onPress:N,onRelease:y,onClick:H,onEnter:N,onExit:y,onFocus:Q,onBlur:z}))),this.showHomeControl&&pe.push(this.homeButton=new e.Button({element:this.homeButton?e.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Home"),srcRest:Y(this.prefixUrl,re.home.REST),srcGroup:Y(this.prefixUrl,re.home.GROUP),srcHover:Y(this.prefixUrl,re.home.HOVER),srcDown:Y(this.prefixUrl,re.home.DOWN),onRelease:ne,onFocus:Q,onBlur:z})),this.showFullPageControl&&pe.push(this.fullPageButton=new e.Button({element:this.fullPageButton?e.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.FullPage"),srcRest:Y(this.prefixUrl,re.fullpage.REST),srcGroup:Y(this.prefixUrl,re.fullpage.GROUP),srcHover:Y(this.prefixUrl,re.fullpage.HOVER),srcDown:Y(this.prefixUrl,re.fullpage.DOWN),onRelease:j,onFocus:Q,onBlur:z})),this.showRotationControl&&(pe.push(this.rotateLeftButton=new e.Button({element:this.rotateLeftButton?e.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateLeft"),srcRest:Y(this.prefixUrl,re.rotateleft.REST),srcGroup:Y(this.prefixUrl,re.rotateleft.GROUP),srcHover:Y(this.prefixUrl,re.rotateleft.HOVER),srcDown:Y(this.prefixUrl,re.rotateleft.DOWN),onRelease:le,onFocus:Q,onBlur:z})),pe.push(this.rotateRightButton=new e.Button({element:this.rotateRightButton?e.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateRight"),srcRest:Y(this.prefixUrl,re.rotateright.REST),srcGroup:Y(this.prefixUrl,re.rotateright.GROUP),srcHover:Y(this.prefixUrl,re.rotateright.HOVER),srcDown:Y(this.prefixUrl,re.rotateright.DOWN),onRelease:ge,onFocus:Q,onBlur:z}))),this.showFlipControl&&pe.push(this.flipButton=new e.Button({element:this.flipButton?e.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Flip"),srcRest:Y(this.prefixUrl,re.flip.REST),srcGroup:Y(this.prefixUrl,re.flip.GROUP),srcHover:Y(this.prefixUrl,re.flip.HOVER),srcDown:Y(this.prefixUrl,re.flip.DOWN),onRelease:ae,onFocus:Q,onBlur:z})),ue&&(this.buttons=new e.ButtonGroup({buttons:pe,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",e.delegate(this,be)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(h){return this.tileSources&&h>=0&&h<this.tileSources.length&&(this._sequenceIndex=h,this._updateSequenceButtons(h),this.open(this.tileSources[h]),this.referenceStrip&&this.referenceStrip.setFocus(h),this.raiseEvent("page",{page:h})),this},addOverlay:function(h,y,O,N){var H;if(e.isPlainObject(h)?H=h:H={element:h,location:y,placement:O,onDraw:N},h=e.getElement(H.element),s(this.currentOverlays,h)>=0)return this;var ne=o(this,H);return this.currentOverlays.push(ne),ne.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:h,location:H.location,placement:H.placement}),this},updateOverlay:function(h,y,O){var N;return h=e.getElement(h),N=s(this.currentOverlays,h),N>=0&&(this.currentOverlays[N].update(y,O),t[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:h,location:y,placement:O})),this},removeOverlay:function(h){var y;return h=e.getElement(h),y=s(this.currentOverlays,h),y>=0&&(this.currentOverlays[y].destroy(),this.currentOverlays.splice(y,1),t[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:h})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return t[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(h){var y;return h=e.getElement(h),y=s(this.currentOverlays,h),y>=0?this.currentOverlays[y]:null},_updateSequenceButtons:function(h){this.nextButton&&(!this.tileSources||this.tileSources.length-1===h?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(h>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(h){this._hideMessage();var y=e.makeNeutralElement("div");y.appendChild(document.createTextNode(h)),this.messageDiv=e.makeCenteredNode(y),e.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var h=this.messageDiv;h&&(h.parentNode.removeChild(h),delete this.messageDiv)},gestureSettingsByDeviceType:function(h){switch(h){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var h,y=this.currentOverlays.length;for(h=0;h<y;h++)this.currentOverlays[h].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new e.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else e.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}});function n(h){return h=e.getElement(h),new e.Point(h.clientWidth===0?1:h.clientWidth,h.clientHeight===0?1:h.clientHeight)}function r(h,y,O,N,H){var ne=h;if(e.type(y)=="string"){if(y.match(/^\s*<.*>\s*$/))y=e.parseXml(y);else if(y.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var j=e.parseJSON(y);y=j}catch{}}function le(ge,ae){ge.ready?N(ge):(ge.addHandler("ready",function(){N(ge)}),ge.addHandler("open-failed",function(Q){H({message:Q.message,source:ae})}))}setTimeout(function(){if(e.type(y)=="string")y=new e.TileSource({url:y,crossOriginPolicy:O.crossOriginPolicy!==void 0?O.crossOriginPolicy:h.crossOriginPolicy,ajaxWithCredentials:h.ajaxWithCredentials,ajaxHeaders:h.ajaxHeaders,useCanvas:h.useCanvas,success:function(z){N(z.tileSource)}}),y.addHandler("open-failed",function(z){H(z)});else if(e.isPlainObject(y)||y.nodeType)if(y.crossOriginPolicy===void 0&&(O.crossOriginPolicy!==void 0||h.crossOriginPolicy!==void 0)&&(y.crossOriginPolicy=O.crossOriginPolicy!==void 0?O.crossOriginPolicy:h.crossOriginPolicy),y.ajaxWithCredentials===void 0&&(y.ajaxWithCredentials=h.ajaxWithCredentials),y.useCanvas===void 0&&(y.useCanvas=h.useCanvas),e.isFunction(y.getTileUrl)){var ge=new e.TileSource(y);ge.getTileUrl=y.getTileUrl,N(ge)}else{var ae=e.TileSource.determineType(ne,y);if(!ae){H({message:"Unable to load TileSource",source:y});return}var Q=ae.prototype.configure.apply(ne,[y]);le(new ae(Q),y)}else le(y,y)})}function o(h,y){if(y instanceof e.Overlay)return y;var O=null;if(y.element)O=e.getElement(y.element);else{var N=y.id?y.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);O=e.getElement(y.id),O||(O=document.createElement("a"),O.href="#/overlay/"+N),O.id=N,e.addClass(O,y.className?y.className:"openseadragon-overlay")}var H=y.location,ne=y.width,j=y.height;if(!H){var le=y.x,ge=y.y;if(y.px!==void 0){var ae=h.viewport.imageToViewportRectangle(new e.Rect(y.px,y.py,ne||0,j||0));le=ae.x,ge=ae.y,ne=ne!==void 0?ae.width:void 0,j=j!==void 0?ae.height:void 0}H=new e.Point(le,ge)}var Q=y.placement;return Q&&e.type(Q)==="string"&&(Q=e.Placement[y.placement.toUpperCase()]),new e.Overlay({element:O,location:H,placement:Q,onDraw:y.onDraw,checkResize:y.checkResize,width:ne,height:j,rotationMode:y.rotationMode})}function s(h,y){var O;for(O=h.length-1;O>=0;O--)if(h[O].element===y)return O;return-1}function a(h,y){return e.requestAnimationFrame(function(){y(h)})}function l(h){e.requestAnimationFrame(function(){g(h)})}function c(h){!h.autoHideControls||(h.controlsShouldFade=!0,h.controlsFadeBeginTime=e.now()+h.controlsFadeDelay,window.setTimeout(function(){l(h)},h.controlsFadeDelay))}function g(h){var y,O,N,H;if(h.controlsShouldFade){for(y=e.now(),O=y-h.controlsFadeBeginTime,N=1-O/h.controlsFadeLength,N=Math.min(1,N),N=Math.max(0,N),H=h.controls.length-1;H>=0;H--)h.controls[H].autoFade&&h.controls[H].setOpacity(N);N>0&&l(h)}}function v(h){var y;for(h.controlsShouldFade=!1,y=h.controls.length-1;y>=0;y--)h.controls[y].setOpacity(1)}function p(){v(this)}function w(){c(this)}function E(h){var y={originalEvent:h.originalEvent,preventDefaultAction:h.preventDefaultAction,preventVerticalPan:h.preventVerticalPan,preventHorizontalPan:h.preventHorizontalPan};if(this.raiseEvent("canvas-key",y),!y.preventDefaultAction&&!h.ctrl&&!h.alt&&!h.meta)switch(h.keyCode){case 38:return y.preventVerticalPan||(h.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return y.preventVerticalPan||(h.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return y.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return y.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}else return!0}function b(h){var y={originalEvent:h.originalEvent,preventDefaultAction:h.preventDefaultAction,preventVerticalPan:h.preventVerticalPan,preventHorizontalPan:h.preventHorizontalPan};if(this.raiseEvent("canvas-key",y),!y.preventDefaultAction&&!h.ctrl&&!h.alt&&!h.meta)switch(h.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return y.preventVerticalPan||(h.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return y.preventVerticalPan||(h.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return y.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return y.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 82:return this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}else return!0}function u(h){var y,O=document.activeElement==this.canvas;O||this.canvas.focus(),this.viewport.flipped&&(h.position.x=this.viewport.getContainerSize().x-h.position.x);var N={tracker:h.eventSource,position:h.position,quick:h.quick,shift:h.shift,originalEvent:h.originalEvent,preventDefaultAction:h.preventDefaultAction};this.raiseEvent("canvas-click",N),!N.preventDefaultAction&&this.viewport&&h.quick&&(y=this.gestureSettingsByDeviceType(h.pointerType),y.clickToZoom&&(this.viewport.zoomBy(h.shift?1/this.zoomPerClick:this.zoomPerClick,y.zoomToRefPoint?this.viewport.pointFromPixel(h.position,!0):null),this.viewport.applyConstraints()))}function m(h){var y,O={tracker:h.eventSource,position:h.position,shift:h.shift,originalEvent:h.originalEvent,preventDefaultAction:h.preventDefaultAction};this.raiseEvent("canvas-double-click",O),!O.preventDefaultAction&&this.viewport&&(y=this.gestureSettingsByDeviceType(h.pointerType),y.dblClickToZoom&&(this.viewport.zoomBy(h.shift?1/this.zoomPerClick:this.zoomPerClick,y.zoomToRefPoint?this.viewport.pointFromPixel(h.position,!0):null),this.viewport.applyConstraints()))}function S(h){var y,O={tracker:h.eventSource,position:h.position,delta:h.delta,speed:h.speed,direction:h.direction,shift:h.shift,originalEvent:h.originalEvent,preventDefaultAction:h.preventDefaultAction};if(this.raiseEvent("canvas-drag",O),!O.preventDefaultAction&&this.viewport){if(y=this.gestureSettingsByDeviceType(h.pointerType),this.panHorizontal||(h.delta.x=0),this.panVertical||(h.delta.y=0),this.viewport.flipped&&(h.delta.x=-h.delta.x),this.constrainDuringPan){var N=this.viewport.deltaPointsFromPixels(h.delta.negate());this.viewport.centerSpringX.target.value+=N.x,this.viewport.centerSpringY.target.value+=N.y;var H=this.viewport.getBounds(),ne=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=N.x,this.viewport.centerSpringY.target.value-=N.y,H.x!=ne.x&&(h.delta.x=0),H.y!=ne.y&&(h.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(h.delta.negate()),y.flickEnabled&&!this.constrainDuringPan)}}function x(h){if(!h.preventDefaultAction&&this.viewport){var y=this.gestureSettingsByDeviceType(h.pointerType);if(y.flickEnabled&&h.speed>=y.flickMinSpeed){var O=0;this.panHorizontal&&(O=y.flickMomentum*h.speed*Math.cos(h.direction));var N=0;this.panVertical&&(N=y.flickMomentum*h.speed*Math.sin(h.direction));var H=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),ne=this.viewport.pointFromPixel(new e.Point(H.x-O,H.y-N));this.viewport.panTo(ne,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:h.eventSource,position:h.position,speed:h.speed,direction:h.direction,shift:h.shift,originalEvent:h.originalEvent})}function D(h){this.raiseEvent("canvas-enter",{tracker:h.eventSource,pointerType:h.pointerType,position:h.position,buttons:h.buttons,pointers:h.pointers,insideElementPressed:h.insideElementPressed,buttonDownAny:h.buttonDownAny,originalEvent:h.originalEvent})}function I(h){window.location!=window.parent.location&&e.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:h.eventSource,pointerType:h.pointerType,position:h.position,buttons:h.buttons,pointers:h.pointers,insideElementPressed:h.insideElementPressed,buttonDownAny:h.buttonDownAny,originalEvent:h.originalEvent})}function M(h){this.raiseEvent("canvas-press",{tracker:h.eventSource,pointerType:h.pointerType,position:h.position,insideElementPressed:h.insideElementPressed,insideElementReleased:h.insideElementReleased,originalEvent:h.originalEvent})}function R(h){this.raiseEvent("canvas-release",{tracker:h.eventSource,pointerType:h.pointerType,position:h.position,insideElementPressed:h.insideElementPressed,insideElementReleased:h.insideElementReleased,originalEvent:h.originalEvent})}function L(h){this.raiseEvent("canvas-nonprimary-press",{tracker:h.eventSource,position:h.position,pointerType:h.pointerType,button:h.button,buttons:h.buttons,originalEvent:h.originalEvent})}function G(h){this.raiseEvent("canvas-nonprimary-release",{tracker:h.eventSource,position:h.position,pointerType:h.pointerType,button:h.button,buttons:h.buttons,originalEvent:h.originalEvent})}function U(h){var y,O,N,H;if(!h.preventDefaultAction&&this.viewport&&(y=this.gestureSettingsByDeviceType(h.pointerType),y.pinchToZoom&&(O=this.viewport.pointFromPixel(h.center,!0),N=this.viewport.pointFromPixel(h.lastCenter,!0),H=N.minus(O),this.panHorizontal||(H.x=0),this.panVertical||(H.y=0),this.viewport.zoomBy(h.distance/h.lastDistance,O,!0),y.zoomToRefPoint&&this.viewport.panBy(H,!0),this.viewport.applyConstraints()),y.pinchRotate)){var ne=Math.atan2(h.gesturePoints[0].currentPos.y-h.gesturePoints[1].currentPos.y,h.gesturePoints[0].currentPos.x-h.gesturePoints[1].currentPos.x),j=Math.atan2(h.gesturePoints[0].lastPos.y-h.gesturePoints[1].lastPos.y,h.gesturePoints[0].lastPos.x-h.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(ne-j)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:h.eventSource,gesturePoints:h.gesturePoints,lastCenter:h.lastCenter,center:h.center,lastDistance:h.lastDistance,distance:h.distance,shift:h.shift,originalEvent:h.originalEvent}),!1}function k(h){var y,O,N,H;if(N=e.now(),H=N-this._lastScrollTime,H>this.minScrollDeltaTime){if(this._lastScrollTime=N,this.viewport.flipped&&(h.position.x=this.viewport.getContainerSize().x-h.position.x),!h.preventDefaultAction&&this.viewport&&(y=this.gestureSettingsByDeviceType(h.pointerType),y.scrollToZoom&&(O=Math.pow(this.zoomPerScroll,h.scroll),this.viewport.zoomBy(O,y.zoomToRefPoint?this.viewport.pointFromPixel(h.position,!0):null),this.viewport.applyConstraints())),this.raiseEvent("canvas-scroll",{tracker:h.eventSource,position:h.position,scroll:h.scroll,shift:h.shift,originalEvent:h.originalEvent}),y&&y.scrollToZoom)return!1}else if(y=this.gestureSettingsByDeviceType(h.pointerType),y&&y.scrollToZoom)return!1}function J(h){t[this.hash].mouseInside=!0,v(this),this.raiseEvent("container-enter",{tracker:h.eventSource,position:h.position,buttons:h.buttons,pointers:h.pointers,insideElementPressed:h.insideElementPressed,buttonDownAny:h.buttonDownAny,originalEvent:h.originalEvent})}function te(h){h.pointers<1&&(t[this.hash].mouseInside=!1,t[this.hash].animating||c(this)),this.raiseEvent("container-exit",{tracker:h.eventSource,position:h.position,buttons:h.buttons,pointers:h.pointers,insideElementPressed:h.insideElementPressed,buttonDownAny:h.buttonDownAny,originalEvent:h.originalEvent})}function ce(h){fe(h),h.isOpen()?h._updateRequestId=a(h,ce):h._updateRequestId=!1}function fe(h){if(!h._opening){if(h.autoResize){var y=n(h.container),O=t[h.hash].prevContainerSize;if(!y.equals(O)){var N=h.viewport;if(h.preserveImageSizeOnResize){var H=O.x/y.x,ne=N.getZoom()*H,j=N.getCenter();N.resize(y,!1),N.zoomTo(ne,null,!0),N.panTo(j,!0)}else{var le=N.getBounds();N.resize(y,!0),N.fitBoundsWithConstraints(le,!0)}t[h.hash].prevContainerSize=y,t[h.hash].forceRedraw=!0}}var ge=h.viewport.update(),ae=h.world.update()||ge;ge&&h.raiseEvent("viewport-change"),h.referenceStrip&&(ae=h.referenceStrip.update(h.viewport)||ae),!t[h.hash].animating&&ae&&(h.raiseEvent("animation-start"),v(h)),(ae||t[h.hash].forceRedraw||h.world.needsDraw())&&(he(h),h._drawOverlays(),h.navigator&&h.navigator.update(h.viewport),t[h.hash].forceRedraw=!1,ae&&h.raiseEvent("animation")),t[h.hash].animating&&!ae&&(h.raiseEvent("animation-finish"),t[h.hash].mouseInside||c(h)),t[h.hash].animating=ae}}function he(h){h.imageLoader.clear(),h.drawer.clear(),h.world.draw(),h.raiseEvent("update-viewport",{})}function Y(h,y){return h?h+y:y}function we(){t[this.hash].lastZoomTime=e.now(),t[this.hash].zoomFactor=this.zoomPerSecond,t[this.hash].zooming=!0,Ce(this)}function Ee(){t[this.hash].lastZoomTime=e.now(),t[this.hash].zoomFactor=1/this.zoomPerSecond,t[this.hash].zooming=!0,Ce(this)}function Ae(){t[this.hash].zooming=!1}function Ce(h){e.requestAnimationFrame(e.delegate(h,Me))}function Me(){var h,y,O;t[this.hash].zooming&&this.viewport&&(h=e.now(),y=h-t[this.hash].lastZoomTime,O=Math.pow(t[this.hash].zoomFactor,y/1e3),this.viewport.zoomBy(O),this.viewport.applyConstraints(),t[this.hash].lastZoomTime=h,Ce(this))}function xe(){this.viewport&&(t[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function Se(){this.viewport&&(t[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function be(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function Le(){this.viewport&&this.viewport.goHome()}function ze(){this.isFullPage()&&!e.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function Oe(){if(this.viewport){var h=this.viewport.getRotation();this.viewport.flipped?h=e.positiveModulo(h+this.rotationIncrement,360):h=e.positiveModulo(h-this.rotationIncrement,360),this.viewport.setRotation(h)}}function Be(){if(this.viewport){var h=this.viewport.getRotation();this.viewport.flipped?h=e.positiveModulo(h-this.rotationIncrement,360):h=e.positiveModulo(h+this.rotationIncrement,360),this.viewport.setRotation(h)}}function De(){this.viewport.toggleFlip()}function Ne(){var h=this._sequenceIndex-1;this.navPrevNextWrap&&h<0&&(h+=this.tileSources.length),this.goToPage(h)}function Ie(){var h=this._sequenceIndex+1;this.navPrevNextWrap&&h>=this.tileSources.length&&(h=0),this.goToPage(h)}}(OpenSeadragon),function(e){e.Navigator=function(a){var l=a.viewer,c=this,g,v;a.id?(this.element=document.getElementById(a.id),a.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(a.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),a.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:a.autoFade},a.position&&(a.position=="BOTTOM_RIGHT"?a.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:a.position=="BOTTOM_LEFT"?a.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:a.position=="TOP_RIGHT"?a.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:a.position=="TOP_LEFT"?a.controlOptions.anchor=e.ControlAnchor.TOP_LEFT:a.position=="ABSOLUTE"&&(a.controlOptions.anchor=e.ControlAnchor.ABSOLUTE,a.controlOptions.top=a.top,a.controlOptions.left=a.left,a.controlOptions.height=a.height,a.controlOptions.width=a.width))),this.element.id=a.id,this.element.className+=" navigator",a=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},a,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:a.autoResize,minZoomImageRatio:1,background:a.background,opacity:a.opacity,borderColor:a.borderColor,displayRegionColor:a.displayRegionColor}),a.minPixelRatio=this.minPixelRatio=l.minPixelRatio,e.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),a.controlOptions.anchor!=e.ControlAnchor.NONE&&function(E,b){E.margin="0px",E.border=b+"px solid "+a.borderColor,E.padding="0px",E.background=a.background,E.opacity=a.opacity,E.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(E,b){E.position="relative",E.top="0px",E.left="0px",E.fontSize="0px",E.overflow="hidden",E.border=b+"px solid "+a.displayRegionColor,E.margin="0px",E.padding="0px",E.background="transparent",E.float="left",E.cssFloat="left",E.styleFloat="left",E.zIndex=999999999,E.cursor="default"}(this.displayRegion.style,this.borderWidth),this.displayRegionContainer=e.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",l.addControl(this.element,a.controlOptions),this._resizeWithViewer=a.controlOptions.anchor!=e.ControlAnchor.ABSOLUTE&&a.controlOptions.anchor!=e.ControlAnchor.NONE,a.width&&a.height?(this.setWidth(a.width),this.setHeight(a.height)):this._resizeWithViewer&&(g=e.getElementSize(l.element),this.element.style.height=Math.round(g.y*a.sizeRatio)+"px",this.element.style.width=Math.round(g.x*a.sizeRatio)+"px",this.oldViewerSize=g,v=e.getElementSize(this.element),this.elementArea=v.x*v.y),this.oldContainerSize=new e.Point(0,0),e.Viewer.apply(this,[a]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function p(E){o(c.displayRegionContainer,E),o(c.displayRegion,-E),c.viewport.setRotation(E)}if(a.navigatorRotate){var w=a.viewer.viewport?a.viewer.viewport.getRotation():a.viewer.degrees||0;p(w),a.viewer.addHandler("rotate",function(E){p(E.degrees)})}this.innerTracker.destroy(),this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,i),clickHandler:e.delegate(this,t),releaseHandler:e.delegate(this,n),scrollHandler:e.delegate(this,r)}),this.addHandler("reset-size",function(){c.viewport&&c.viewport.goHome(!0)}),l.world.addHandler("item-index-change",function(E){window.setTimeout(function(){var b=c.world.getItemAt(E.previousIndex);c.world.setItemIndex(b,E.newIndex)},1)}),l.world.addHandler("remove-item",function(E){var b=E.item,u=c._getMatchingItem(b);u&&c.world.removeItem(u)}),this.update(l.viewport)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{updateSize:function(){if(this.viewport){var a=new e.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);a.equals(this.oldContainerSize)||(this.viewport.resize(a,!0),this.viewport.goHome(!0),this.oldContainerSize=a,this.drawer.clear(),this.world.draw())}},setWidth:function(a){this.width=a,this.element.style.width=typeof a=="number"?a+"px":a,this._resizeWithViewer=!1},setHeight:function(a){this.height=a,this.element.style.height=typeof a=="number"?a+"px":a,this._resizeWithViewer=!1},setFlip:function(a){return this.viewport.setFlip(a),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(a){s(this.displayRegion,a),s(this.canvas,a),s(this.element,a)},update:function(a){var l,c,g,v,p,w;if(l=e.getElementSize(this.viewer.element),this._resizeWithViewer&&l.x&&l.y&&!l.equals(this.oldViewerSize)&&(this.oldViewerSize=l,this.maintainSizeRatio||!this.elementArea?(c=l.x*this.sizeRatio,g=l.y*this.sizeRatio):(c=Math.sqrt(this.elementArea*(l.x/l.y)),g=this.elementArea/c),this.element.style.width=Math.round(c)+"px",this.element.style.height=Math.round(g)+"px",this.elementArea||(this.elementArea=c*g),this.updateSize()),a&&this.viewport){v=a.getBoundsNoRotate(!0),p=this.viewport.pixelFromPointNoRotate(v.getTopLeft(),!1),w=this.viewport.pixelFromPointNoRotate(v.getBottomRight(),!1).minus(this.totalBorderWidths);var E=this.displayRegion.style;E.display=this.world.getItemCount()?"block":"none",E.top=Math.round(p.y)+"px",E.left=Math.round(p.x)+"px";var b=Math.abs(p.x-w.x),u=Math.abs(p.y-w.y);E.width=Math.round(Math.max(b,0))+"px",E.height=Math.round(Math.max(u,0))+"px"}},addTiledImage:function(a){var l=this,c=a.originalTiledImage;delete a.original;var g=e.extend({},a,{success:function(v){var p=v.item;p._originalForNavigator=c,l._matchBounds(p,c,!0);function w(){l._matchBounds(p,c)}function E(){l._matchOpacity(p,c)}function b(){l._matchCompositeOperation(p,c)}c.addHandler("bounds-change",w),c.addHandler("clip-change",w),c.addHandler("opacity-change",E),c.addHandler("composite-operation-change",b)}});return e.Viewer.prototype.addTiledImage.apply(this,[g])},_getMatchingItem:function(a){for(var l=this.world.getItemCount(),c,g=0;g<l;g++)if(c=this.world.getItemAt(g),c._originalForNavigator===a)return c;return null},_matchBounds:function(a,l,c){var g=l.getBoundsNoRotate();a.setPosition(g.getTopLeft(),c),a.setWidth(g.width,c),a.setRotation(l.getRotation(),c),a.setClip(l.getClip())},_matchOpacity:function(a,l){a.setOpacity(l.opacity)},_matchCompositeOperation:function(a,l){a.setCompositeOperation(l.compositeOperation)}});function t(a){var l={tracker:a.eventSource,position:a.position,quick:a.quick,shift:a.shift,originalEvent:a.originalEvent,preventDefaultAction:a.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",l),!l.preventDefaultAction&&a.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(a.position.x=this.viewport.getContainerSize().x-a.position.x);var c=this.viewport.pointFromPixel(a.position);this.panVertical?this.panHorizontal||(c.x=this.viewer.viewport.getCenter(!0).x):c.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(c),this.viewer.viewport.applyConstraints()}}function i(a){var l={tracker:a.eventSource,position:a.position,delta:a.delta,speed:a.speed,direction:a.direction,shift:a.shift,originalEvent:a.originalEvent,preventDefaultAction:a.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",l),!l.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(a.delta.x=0),this.panVertical||(a.delta.y=0),this.viewer.viewport.flipped&&(a.delta.x=-a.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(a.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function n(a){a.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function r(a){return this.viewer.raiseEvent("navigator-scroll",{tracker:a.eventSource,position:a.position,scroll:a.scroll,shift:a.shift,originalEvent:a.originalEvent}),!1}function o(a,l){s(a,"rotate("+l+"deg)")}function s(a,l){a.style.webkitTransform=l,a.style.mozTransform=l,a.style.msTransform=l,a.style.oTransform=l,a.style.transform=l}}(OpenSeadragon),function(e){var t={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};e.extend(e,{getString:function(i){var n=i.split("."),r=null,o=arguments,s=t,a;for(a=0;a<n.length-1;a++)s=s[n[a]]||{};return r=s[n[a]],typeof r!="string"&&(e.console.log("Untranslated source string:",i),r=""),r.replace(/\{\d+\}/g,function(l){var c=parseInt(l.match(/\d+/),10)+1;return c<o.length?o[c]:""})},setString:function(i,n){var r=i.split("."),o=t,s;for(s=0;s<r.length-1;s++)o[r[s]]||(o[r[s]]={}),o=o[r[s]];o[r[s]]=n}})}(OpenSeadragon),function(e){e.Point=function(t,i){this.x=typeof t=="number"?t:0,this.y=typeof i=="number"?i:0},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},plus:function(t){return new e.Point(this.x+t.x,this.y+t.y)},minus:function(t){return new e.Point(this.x-t.x,this.y-t.y)},times:function(t){return new e.Point(this.x*t,this.y*t)},divide:function(t){return new e.Point(this.x/t,this.y/t)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},squaredDistanceTo:function(t){return Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)},apply:function(t){return new e.Point(t(this.x),t(this.y))},equals:function(t){return t instanceof e.Point&&this.x===t.x&&this.y===t.y},rotate:function(t,i){i=i||new e.Point(0,0);var n,r;if(t%90==0){var o=e.positiveModulo(t,360);switch(o){case 0:n=1,r=0;break;case 90:n=0,r=1;break;case 180:n=-1,r=0;break;case 270:n=0,r=-1;break}}else{var s=t*Math.PI/180;n=Math.cos(s),r=Math.sin(s)}var a=n*(this.x-i.x)-r*(this.y-i.y)+i.x,l=r*(this.x-i.x)+n*(this.y-i.y)+i.y;return new e.Point(a,l)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(OpenSeadragon),function(e){e.TileSource=function(i,n,r,o,s,a){var l=this,c=arguments,g,v;if(e.isPlainObject(i)?g=i:g={width:c[0],height:c[1],tileSize:c[2],tileOverlap:c[3],minLevel:c[4],maxLevel:c[5]},e.EventSource.call(this),e.extend(!0,this,g),!this.success){for(v=0;v<arguments.length;v++)if(e.isFunction(arguments[v])){this.success=arguments[v];break}}this.success&&this.addHandler("ready",function(p){l.success(p)}),e.type(arguments[0])=="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new e.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=g.width&&g.height?g.width/g.height:1,this.dimensions=new e.Point(g.width,g.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=g.tileOverlap?g.tileOverlap:0,this.minLevel=g.minLevel?g.minLevel:0,this.maxLevel=g.maxLevel!==void 0&&g.maxLevel!==null?g.maxLevel:g.width&&g.height?Math.ceil(Math.log(Math.max(g.width,g.height))/Math.log(2)):0,this.success&&e.isFunction(this.success)&&this.success(this))},e.TileSource.prototype={getTileSize:function(i){return e.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(i){return this._tileWidth?this._tileWidth:this.getTileSize(i)},getTileHeight:function(i){return this._tileHeight?this._tileHeight:this.getTileSize(i)},getLevelScale:function(i){var n={},r;for(r=0;r<=this.maxLevel;r++)n[r]=1/Math.pow(2,this.maxLevel-r);return this.getLevelScale=function(o){return n[o]},this.getLevelScale(i)},getNumTiles:function(i){var n=this.getLevelScale(i),r=Math.ceil(n*this.dimensions.x/this.getTileWidth(i)),o=Math.ceil(n*this.dimensions.y/this.getTileHeight(i));return new e.Point(r,o)},getPixelRatio:function(i){var n=this.dimensions.times(this.getLevelScale(i)),r=1/n.x,o=1/n.y;return new e.Point(r,o)},getClosestLevel:function(){var i,n;for(i=this.minLevel+1;i<=this.maxLevel&&(n=this.getNumTiles(i),!(n.x>1||n.y>1));i++);return i-1},getTileAtPoint:function(i,n){var r=n.x>=0&&n.x<=1&&n.y>=0&&n.y<=1/this.aspectRatio;e.console.assert(r,"[TileSource.getTileAtPoint] must be called with a valid point.");var o=this.dimensions.x*this.getLevelScale(i),s=n.x*o,a=n.y*o,l=Math.floor(s/this.getTileWidth(i)),c=Math.floor(a/this.getTileHeight(i));n.x>=1&&(l=this.getNumTiles(i).x-1);var g=1e-15;return n.y>=1/this.aspectRatio-g&&(c=this.getNumTiles(i).y-1),new e.Point(l,c)},getTileBounds:function(i,n,r,o){var s=this.dimensions.times(this.getLevelScale(i)),a=this.getTileWidth(i),l=this.getTileHeight(i),c=n===0?0:a*n-this.tileOverlap,g=r===0?0:l*r-this.tileOverlap,v=a+(n===0?1:2)*this.tileOverlap,p=l+(r===0?1:2)*this.tileOverlap,w=1/s.x;return v=Math.min(v,s.x-c),p=Math.min(p,s.y-g),o?new e.Rect(0,0,v,p):new e.Rect(c*w,g*w,v*w,p*w)},getImageInfo:function(i){var n=this,r,o,s,a,l,c,g;i&&(l=i.split("/"),c=l[l.length-1],g=c.lastIndexOf("."),g>-1&&(l[l.length-1]=c.slice(0,g))),o=function(v){typeof v=="string"&&(v=e.parseXml(v));var p=e.TileSource.determineType(n,v,i);if(!p){n.raiseEvent("open-failed",{message:"Unable to load TileSource",source:i});return}a=p.prototype.configure.apply(n,[v,i]),a.ajaxWithCredentials===void 0&&(a.ajaxWithCredentials=n.ajaxWithCredentials),s=new p(a),n.ready=!0,n.raiseEvent("ready",{tileSource:s})},i.match(/\.js$/)?(r=i.split("/").pop().replace(".js",""),e.jsonp({url:i,async:!1,callbackName:r,callback:o})):e.makeAjaxRequest({url:i,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(v){var p=t(v);o(p)},error:function(v,p){var w;try{w="HTTP "+v.status+" attempting to load TileSource"}catch{var E;typeof p=="undefined"||!p.toString?E="Unknown error":E=p.toString(),w=E+" attempting to load TileSource"}n.raiseEvent("open-failed",{message:w,source:i})}})},supports:function(i,n){return!1},configure:function(i,n){throw new Error("Method not implemented.")},getTileUrl:function(i,n,r){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(i,n,r){return{}},tileExists:function(i,n,r){var o=this.getNumTiles(i);return i>=this.minLevel&&i<=this.maxLevel&&n>=0&&r>=0&&n<o.x&&r<o.y}},e.extend(!0,e.TileSource.prototype,e.EventSource.prototype);function t(i){var n=i.responseText,r=i.status,o,s;if(i){if(i.status!==200&&i.status!==0)throw r=i.status,o=r==404?"Not Found":i.statusText,new Error(e.getString("Errors.Status",r,o))}else throw new Error(e.getString("Errors.Security"));if(n.match(/\s*<.*/))try{s=i.responseXML&&i.responseXML.documentElement?i.responseXML:e.parseXml(n)}catch{s=i.responseText}else if(n.match(/\s*[\{\[].*/))try{s=e.parseJSON(n)}catch{s=n}else s=n;return s}e.TileSource.determineType=function(i,n,r){var o;for(o in OpenSeadragon)if(o.match(/.+TileSource$/)&&e.isFunction(OpenSeadragon[o])&&e.isFunction(OpenSeadragon[o].prototype.supports)&&OpenSeadragon[o].prototype.supports.call(i,n,r))return OpenSeadragon[o];e.console.error("No TileSource was able to open %s %s",r,n)}}(OpenSeadragon),function(e){e.DziTileSource=function(n,r,o,s,a,l,c,g,v){var p,w,E,b;if(e.isPlainObject(n)?b=n:b={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=b.tilesUrl,this.fileFormat=b.fileFormat,this.displayRects=b.displayRects,this.displayRects)for(p=this.displayRects.length-1;p>=0;p--)for(w=this.displayRects[p],E=w.minLevel;E<=w.maxLevel;E++)this._levelRects[E]||(this._levelRects[E]=[]),this._levelRects[E].push(w);e.TileSource.apply(this,[b])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(n,r){var o;return n.Image?o=n.Image.xmlns:n.documentElement&&(n.documentElement.localName=="Image"||n.documentElement.tagName=="Image")&&(o=n.documentElement.namespaceURI),o=(o||"").toLowerCase(),o.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||o.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(n,r){var o;return e.isPlainObject(n)?o=i(this,n):o=t(this,n),r&&!o.tilesUrl&&(o.tilesUrl=r.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),r.search(/\.(dzi|xml|js)\?/)!=-1?o.queryParams=r.match(/\?.*/):o.queryParams=""),o},getTileUrl:function(n,r,o){return[this.tilesUrl,n,"/",r,"_",o,".",this.fileFormat,this.queryParams].join("")},tileExists:function(n,r,o){var s=this._levelRects[n],a,l,c,g,v,p,w;if(this.minLevel&&n<this.minLevel||this.maxLevel&&n>this.maxLevel)return!1;if(!s||!s.length)return!0;for(w=s.length-1;w>=0;w--)if(a=s[w],!(n<a.minLevel||n>a.maxLevel)&&(l=this.getLevelScale(n),c=a.x*l,g=a.y*l,v=c+a.width*l,p=g+a.height*l,c=Math.floor(c/this._tileWidth),g=Math.floor(g/this._tileWidth),v=Math.ceil(v/this._tileWidth),p=Math.ceil(p/this._tileWidth),c<=r&&r<v&&g<=o&&o<p))return!0;return!1}});function t(n,r){if(!r||!r.documentElement)throw new Error(e.getString("Errors.Xml"));var o=r.documentElement,s=o.localName||o.tagName,a=r.documentElement.namespaceURI,l=null,c=[],g,v,p,w,E;if(s=="Image")try{if(w=o.getElementsByTagName("Size")[0],w===void 0&&(w=o.getElementsByTagNameNS(a,"Size")[0]),l={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:o.getAttribute("Url"),Format:o.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(o.getAttribute("Overlap"),10),TileSize:parseInt(o.getAttribute("TileSize"),10),Size:{Height:parseInt(w.getAttribute("Height"),10),Width:parseInt(w.getAttribute("Width"),10)}}},!e.imageFormatSupported(l.Image.Format))throw new Error(e.getString("Errors.ImageFormat",l.Image.Format.toUpperCase()));for(g=o.getElementsByTagName("DisplayRect"),g===void 0&&(g=o.getElementsByTagNameNS(a,"DisplayRect")[0]),E=0;E<g.length;E++)v=g[E],p=v.getElementsByTagName("Rect")[0],p===void 0&&(p=v.getElementsByTagNameNS(a,"Rect")[0]),c.push({Rect:{X:parseInt(p.getAttribute("X"),10),Y:parseInt(p.getAttribute("Y"),10),Width:parseInt(p.getAttribute("Width"),10),Height:parseInt(p.getAttribute("Height"),10),MinLevel:parseInt(v.getAttribute("MinLevel"),10),MaxLevel:parseInt(v.getAttribute("MaxLevel"),10)}});return c.length&&(l.Image.DisplayRect=c),i(n,l)}catch(m){throw m instanceof Error?m:new Error(e.getString("Errors.Dzi"))}else{if(s=="Collection")throw new Error(e.getString("Errors.Dzc"));if(s=="Error"){var b=o.getElementsByTagName("Message")[0],u=b.firstChild.nodeValue;throw new Error(u)}}throw new Error(e.getString("Errors.Dzi"))}function i(n,r){var o=r.Image,s=o.Url,a=o.Format,l=o.Size,c=o.DisplayRect||[],g=parseInt(l.Width,10),v=parseInt(l.Height,10),p=parseInt(o.TileSize,10),w=parseInt(o.Overlap,10),E=[],b,u;for(u=0;u<c.length;u++)b=c[u].Rect,E.push(new e.DisplayRect(parseInt(b.X,10),parseInt(b.Y,10),parseInt(b.Width,10),parseInt(b.Height,10),parseInt(b.MinLevel,10),parseInt(b.MaxLevel,10)));return e.extend(!0,{width:g,height:v,tileSize:p,tileOverlap:w,minLevel:null,maxLevel:null,tilesUrl:s,fileFormat:a,displayRects:E},r)}}(OpenSeadragon),function(e){e.IIIFTileSource=function(o){if(e.extend(!0,this,o),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(o.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=o.version,this.tile_width&&this.tile_height)o.tileWidth=this.tile_width,o.tileHeight=this.tile_height;else if(this.tile_width)o.tileSize=this.tile_width;else if(this.tile_height)o.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length==1)o.tileWidth=this.tiles[0].width,o.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var s=0;s<this.tiles.length;s++)for(var a=0;a<this.tiles[s].scaleFactors.length;a++){var l=this.tiles[s].scaleFactors[a];this.scale_factors.push(l),o.tileSizePerScaleFactor[l]={width:this.tiles[s].width,height:this.tiles[s].height||this.tiles[s].width}}}else if(t(o)){for(var c=Math.min(this.height,this.width),g=[256,512,1024],v=[],p=0;p<g.length;p++)g[p]<=c&&v.push(g[p]);v.length>0?o.tileSize=Math.max.apply(null,v):o.tileSize=c}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,o.levels=i(this),e.extend(!0,o,{width:o.levels[o.levels.length-1].width,height:o.levels[o.levels.length-1].height,tileSize:Math.max(o.height,o.width),tileOverlap:0,minLevel:0,maxLevel:o.levels.length-1}),this.levels=o.levels):e.console.error("Nothing in the info.json to construct image pyramids from");if(!o.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)o.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));else{var w=Math.max.apply(null,this.scale_factors);o.maxLevel=Math.round(Math.log(w)*Math.LOG2E)}e.TileSource.apply(this,[o])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(o,s){return o.protocol&&o.protocol=="http://iiif.io/api/image"||o["@context"]&&(o["@context"]=="http://library.stanford.edu/iiif/image-api/1.1/context.json"||o["@context"]=="http://iiif.io/api/image/1/context.json")||o.profile&&o.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||o.identifier&&o.width&&o.height?!0:!!(o.documentElement&&o.documentElement.tagName=="info"&&o.documentElement.namespaceURI=="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(o,s){if(e.isPlainObject(o)){if(!o["@context"])o["@context"]="http://iiif.io/api/image/1.0/context.json",o["@id"]=s.replace("/info.json",""),o.version=1;else{var l=o["@context"];if(Array.isArray(l)){for(var c=0;c<l.length;c++)if(typeof l[c]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(l[c])||l[c]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){l=l[c];break}}switch(l){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":o.version=1;break;case"http://iiif.io/api/image/2/context.json":o.version=2;break;case"http://iiif.io/api/image/3/context.json":o.version=3;break;default:e.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(!o["@id"]&&o.id&&(o["@id"]=o.id),o.preferredFormats){for(var g=0;g<o.preferredFormats.length;g++)if(OpenSeadragon.imageFormatSupported(o.preferredFormats[g])){o.tileFormat=o.preferredFormats[g];break}}return o}else{var a=n(o);return a["@context"]="http://iiif.io/api/image/1.0/context.json",a["@id"]=s.replace("/info.xml",""),a.version=1,a}},getTileWidth:function(o){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileWidth.call(this,o);var s=Math.pow(2,this.maxLevel-o);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[s]?this.tileSizePerScaleFactor[s].width:this._tileWidth},getTileHeight:function(o){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileHeight.call(this,o);var s=Math.pow(2,this.maxLevel-o);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[s]?this.tileSizePerScaleFactor[s].height:this._tileHeight},getLevelScale:function(o){if(this.emulateLegacyImagePyramid){var s=NaN;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(s=this.levels[o].width/this.levels[this.maxLevel].width),s}return e.TileSource.prototype.getLevelScale.call(this,o)},getNumTiles:function(o){if(this.emulateLegacyImagePyramid){var s=this.getLevelScale(o);return s?new e.Point(1,1):new e.Point(0,0)}return e.TileSource.prototype.getNumTiles.call(this,o)},getTileAtPoint:function(o,s){return this.emulateLegacyImagePyramid?new e.Point(0,0):e.TileSource.prototype.getTileAtPoint.call(this,o,s)},getTileUrl:function(o,s,a){if(this.emulateLegacyImagePyramid){var l=null;return this.levels.length>0&&o>=this.minLevel&&o<=this.maxLevel&&(l=this.levels[o].url),l}var c="0",g=Math.pow(.5,this.maxLevel-o),v=Math.ceil(this.width*g),p=Math.ceil(this.height*g),w,E,b,u,m,S,x,D,I,M,R,L,G,U;return w=this.getTileWidth(o),E=this.getTileHeight(o),b=Math.ceil(w/g),u=Math.ceil(E/g),this.version===1?G="native."+this.tileFormat:G="default."+this.tileFormat,v<w&&p<E?(this.version===2&&v===this.width||this.version===3&&v===this.width&&p===this.height?M="max":this.version===3?M=v+","+p:M=v+",",m="full"):(S=s*b,x=a*u,D=Math.min(b,this.width-S),I=Math.min(u,this.height-x),s===0&&a===0&&D===this.width&&I===this.height?m="full":m=[S,x,D,I].join(","),R=Math.ceil(D*g),L=Math.ceil(I*g),this.version===2&&R===this.width||this.version===3&&R===this.width&&L===this.height?M="max":this.version===3?M=R+","+L:M=R+","),U=[this["@id"],m,M,c,G].join("/"),U},__testonly__:{canBeTiled:t,constructLevels:i}});function t(o){var s=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],a=Array.isArray(o.profile)?o.profile[0]:o.profile,l=s.indexOf(a)!==-1,c=!1;return o.version===2&&o.profile.length>1&&o.profile[1].supports&&(c=o.profile[1].supports.indexOf("sizeByW")!==-1),o.version===3&&o.extraFeatures&&(c=o.extraFeatures.indexOf("sizeByWh")!==-1),!l||c}function i(o){for(var s=[],a=0;a<o.sizes.length;a++)s.push({url:o["@id"]+"/full/"+o.sizes[a].width+","+(o.version===3?o.sizes[a].height:"")+"/0/default."+o.tileFormat,width:o.sizes[a].width,height:o.sizes[a].height});return s.sort(function(l,c){return l.width-c.width})}function n(o){if(!o||!o.documentElement)throw new Error(e.getString("Errors.Xml"));var s=o.documentElement,a=s.tagName,l=null;if(a=="info")try{return l={},r(s,l),l}catch(c){throw c instanceof Error?c:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}function r(o,s,a){var l,c;if(o.nodeType==3&&a)c=o.nodeValue.trim(),c.match(/^\d*$/)&&(c=Number(c)),s[a]?(e.isArray(s[a])||(s[a]=[s[a]]),s[a].push(c)):s[a]=c;else if(o.nodeType==1)for(l=0;l<o.childNodes.length;l++)r(o.childNodes[l],s,o.nodeName)}}(OpenSeadragon),function(e){e.OsmTileSource=function(t,i,n,r,o){var s;e.isPlainObject(t)?s=t:s={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!s.width||!s.height)&&(s.width=65572864,s.height=65572864),s.tileSize||(s.tileSize=256,s.tileOverlap=0),s.tilesUrl||(s.tilesUrl="http://tile.openstreetmap.org/"),s.minLevel=8,e.TileSource.apply(this,[s])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(t,i){return t.type&&t.type=="openstreetmaps"},configure:function(t,i){return t},getTileUrl:function(t,i,n){return this.tilesUrl+(t-8)+"/"+i+"/"+n+".png"}})}(OpenSeadragon),function(e){e.TmsTileSource=function(t,i,n,r,o){var s;e.isPlainObject(t)?s=t:s={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var a=Math.ceil(s.width/256)*256,l=Math.ceil(s.height/256)*256,c;a>l?c=a/256:c=l/256,s.maxLevel=Math.ceil(Math.log(c)/Math.log(2))-1,s.tileSize=256,s.width=a,s.height=l,e.TileSource.apply(this,[s])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(t,i){return t.type&&t.type=="tiledmapservice"},configure:function(t,i){return t},getTileUrl:function(t,i,n){var r=this.getNumTiles(t).y-1;return this.tilesUrl+t+"/"+i+"/"+(r-n)+".png"}})}(OpenSeadragon),function(e){e.ZoomifyTileSource=function(t){t.tileSize=256;var i={x:t.width,y:t.height};for(t.imageSizes=[{x:t.width,y:t.height}],t.gridSize=[this._getGridSize(t.width,t.height,t.tileSize)];parseInt(i.x,10)>t.tileSize||parseInt(i.y,10)>t.tileSize;)i.x=Math.floor(i.x/2),i.y=Math.floor(i.y/2),t.imageSizes.push({x:i.x,y:i.y}),t.gridSize.push(this._getGridSize(i.x,i.y,t.tileSize));t.imageSizes.reverse(),t.gridSize.reverse(),t.minLevel=0,t.maxLevel=t.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[t])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(t,i,n){return{x:Math.ceil(t/n),y:Math.ceil(i/n)}},_calculateAbsoluteTileNumber:function(t,i,n){for(var r=0,o={},s=0;s<t;s++)o=this.gridSize[s],r+=o.x*o.y;return o=this.gridSize[t],r+=o.x*n+i,r},supports:function(t,i){return t.type&&t.type=="zoomifytileservice"},configure:function(t,i){return t},getTileUrl:function(t,i,n){var r=0,o=this._calculateAbsoluteTileNumber(t,i,n);return r=Math.floor(o/256),this.tilesUrl+"TileGroup"+r+"/"+t+"-"+i+"-"+n+".jpg"}})}(OpenSeadragon),function(e){e.LegacyTileSource=function(r){var o,s,a;e.isArray(r)&&(o={type:"legacy-image-pyramid",levels:r}),o.levels=t(o.levels),o.levels.length>0?(s=o.levels[o.levels.length-1].width,a=o.levels[o.levels.length-1].height):(s=0,a=0,e.console.error("No supported image formats found")),e.extend(!0,o,{width:s,height:a,tileSize:Math.max(a,s),tileOverlap:0,minLevel:0,maxLevel:o.levels.length>0?o.levels.length-1:0}),e.TileSource.apply(this,[o]),this.levels=o.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(r,o){return r.type&&r.type=="legacy-image-pyramid"||r.documentElement&&r.documentElement.getAttribute("type")=="legacy-image-pyramid"},configure:function(r,o){var s;return e.isPlainObject(r)?s=n(this,r):s=i(this,r),s},getLevelScale:function(r){var o=NaN;return this.levels.length>0&&r>=this.minLevel&&r<=this.maxLevel&&(o=this.levels[r].width/this.levels[this.maxLevel].width),o},getNumTiles:function(r){var o=this.getLevelScale(r);return o?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(r,o,s){var a=null;return this.levels.length>0&&r>=this.minLevel&&r<=this.maxLevel&&(a=this.levels[r].url),a}});function t(r){var o=[],s,a;for(a=0;a<r.length;a++)s=r[a],s.height&&s.width&&s.url?o.push({url:s.url,width:Number(s.width),height:Number(s.height)}):e.console.error("Unsupported image format: %s",s.url?s.url:"<no URL>");return o.sort(function(l,c){return l.height-c.height})}function i(r,o){if(!o||!o.documentElement)throw new Error(e.getString("Errors.Xml"));var s=o.documentElement,a=s.tagName,l=null,c=[],g,v;if(a=="image")try{for(l={type:s.getAttribute("type"),levels:[]},c=s.getElementsByTagName("level"),v=0;v<c.length;v++)g=c[v],l.levels.push({url:g.getAttribute("url"),width:parseInt(g.getAttribute("width"),10),height:parseInt(g.getAttribute("height"),10)});return n(r,l)}catch(p){throw p instanceof Error?p:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(a=="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(a=="error")throw new Error("Error: "+o)}throw new Error("Unknown element "+a)}function n(r,o){return o.levels}}(OpenSeadragon),function(e){e.ImageTileSource=function(t){t=e.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},t),e.TileSource.apply(this,[t])},e.extend(e.ImageTileSource.prototype,e.TileSource.prototype,{supports:function(t,i){return t.type&&t.type==="image"},configure:function(t,i){return t},getImageInfo:function(t){var i=this._image=new Image,n=this;this.crossOriginPolicy&&(i.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(i.useCredentials=this.ajaxWithCredentials),e.addEvent(i,"load",function(){n.width=Object.prototype.hasOwnProperty.call(i,"naturalWidth")?i.naturalWidth:i.width,n.height=Object.prototype.hasOwnProperty.call(i,"naturalHeight")?i.naturalHeight:i.height,n.aspectRatio=n.width/n.height,n.dimensions=new e.Point(n.width,n.height),n._tileWidth=n.width,n._tileHeight=n.height,n.tileOverlap=0,n.minLevel=0,n.levels=n._buildLevels(),n.maxLevel=n.levels.length-1,n.ready=!0,n.raiseEvent("ready",{tileSource:n})}),e.addEvent(i,"error",function(){n.raiseEvent("open-failed",{message:"Error loading image at "+t,source:t})}),i.src=t},getLevelScale:function(t){var i=NaN;return t>=this.minLevel&&t<=this.maxLevel&&(i=this.levels[t].width/this.levels[this.maxLevel].width),i},getNumTiles:function(t){var i=this.getLevelScale(t);return i?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(t,i,n){var r=null;return t>=this.minLevel&&t<=this.maxLevel&&(r=this.levels[t].url),r},getContext2D:function(t,i,n){var r=null;return t>=this.minLevel&&t<=this.maxLevel&&(r=this.levels[t].context2D),r},_buildLevels:function(){var t=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!e.supportsCanvas||!this.useCanvas)return delete this._image,t;var i=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,n=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,r=document.createElement("canvas"),o=r.getContext("2d");if(r.width=i,r.height=n,o.drawImage(this._image,0,0,i,n),t[0].context2D=o,delete this._image,e.isCanvasTainted(r))return t;for(;i>=2&&n>=2;){i=Math.floor(i/2),n=Math.floor(n/2);var s=document.createElement("canvas"),a=s.getContext("2d");s.width=i,s.height=n,a.drawImage(r,0,0,i,n),t.splice(0,0,{context2D:a,width:i,height:n}),r=s,o=a}return t}})}(OpenSeadragon),function(e){e.TileSourceCollection=function(t,i,n,r){e.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(e){e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(a){var l=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},a),this.element=a.element||e.makeNeutralElement("div"),a.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",e.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",e.Browser.vendor==e.BROWSERS.FIREFOX&&e.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(c){c.insideElementPressed?(o(l,e.ButtonState.DOWN),l.raiseEvent("enter",{originalEvent:c.originalEvent})):c.buttonDownAny||o(l,e.ButtonState.HOVER)},focusHandler:function(c){this.enterHandler(c),l.raiseEvent("focus",{originalEvent:c.originalEvent})},exitHandler:function(c){s(l,e.ButtonState.GROUP),c.insideElementPressed&&l.raiseEvent("exit",{originalEvent:c.originalEvent})},blurHandler:function(c){this.exitHandler(c),l.raiseEvent("blur",{originalEvent:c.originalEvent})},pressHandler:function(c){o(l,e.ButtonState.DOWN),l.raiseEvent("press",{originalEvent:c.originalEvent})},releaseHandler:function(c){c.insideElementPressed&&c.insideElementReleased?(s(l,e.ButtonState.HOVER),l.raiseEvent("release",{originalEvent:c.originalEvent})):c.insideElementPressed?s(l,e.ButtonState.GROUP):o(l,e.ButtonState.HOVER)},clickHandler:function(c){c.quick&&l.raiseEvent("click",{originalEvent:c.originalEvent})},keyHandler:function(c){return c.keyCode===13?(l.raiseEvent("click",{originalEvent:c.originalEvent}),l.raiseEvent("release",{originalEvent:c.originalEvent}),!1):!0}}),s(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){o(this,e.ButtonState.GROUP)},notifyGroupExit:function(){s(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}});function t(a){e.requestAnimationFrame(function(){i(a)})}function i(a){var l,c,g;a.shouldFade&&(l=e.now(),c=l-a.fadeBeginTime,g=1-c/a.fadeLength,g=Math.min(1,g),g=Math.max(0,g),a.imgGroup&&e.setElementOpacity(a.imgGroup,g,!0),g>0&&t(a))}function n(a){a.shouldFade=!0,a.fadeBeginTime=e.now()+a.fadeDelay,window.setTimeout(function(){t(a)},a.fadeDelay)}function r(a){a.shouldFade=!1,a.imgGroup&&e.setElementOpacity(a.imgGroup,1,!0)}function o(a,l){a.element.disabled||(l>=e.ButtonState.GROUP&&a.currentState==e.ButtonState.REST&&(r(a),a.currentState=e.ButtonState.GROUP),l>=e.ButtonState.HOVER&&a.currentState==e.ButtonState.GROUP&&(a.imgHover&&(a.imgHover.style.visibility=""),a.currentState=e.ButtonState.HOVER),l>=e.ButtonState.DOWN&&a.currentState==e.ButtonState.HOVER&&(a.imgDown&&(a.imgDown.style.visibility=""),a.currentState=e.ButtonState.DOWN))}function s(a,l){a.element.disabled||(l<=e.ButtonState.HOVER&&a.currentState==e.ButtonState.DOWN&&(a.imgDown&&(a.imgDown.style.visibility="hidden"),a.currentState=e.ButtonState.HOVER),l<=e.ButtonState.GROUP&&a.currentState==e.ButtonState.HOVER&&(a.imgHover&&(a.imgHover.style.visibility="hidden"),a.currentState=e.ButtonState.GROUP),l<=e.ButtonState.REST&&a.currentState==e.ButtonState.GROUP&&(n(a),a.currentState=e.ButtonState.REST))}}(OpenSeadragon),function(e){e.ButtonGroup=function(t){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},t);var i=this.buttons.concat([]),n=this,r;if(this.element=t.element||e.makeNeutralElement("div"),!t.group)for(this.element.style.display="inline-block",r=0;r<i.length;r++)this.element.appendChild(i[r].element);e.setElementTouchActionNone(this.element),this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(o){var s;for(s=0;s<n.buttons.length;s++)n.buttons[s].notifyGroupEnter()},exitHandler:function(o){var s;if(!o.insideElementPressed)for(s=0;s<n.buttons.length;s++)n.buttons[s].notifyGroupExit()}})},e.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(e){e.Rect=function(t,i,n,r,o){this.x=typeof t=="number"?t:0,this.y=typeof i=="number"?i:0,this.width=typeof n=="number"?n:0,this.height=typeof r=="number"?r:0,this.degrees=typeof o=="number"?o:0,this.degrees=e.positiveModulo(this.degrees,360);var s,a;this.degrees>=270?(s=this.getTopRight(),this.x=s.x,this.y=s.y,a=this.height,this.height=this.width,this.width=a,this.degrees-=270):this.degrees>=180?(s=this.getBottomRight(),this.x=s.x,this.y=s.y,this.degrees-=180):this.degrees>=90&&(s=this.getBottomLeft(),this.x=s.x,this.y=s.y,a=this.height,this.height=this.width,this.width=a,this.degrees-=90)},e.Rect.fromSummits=function(t,i,n){var r=t.distanceTo(i),o=t.distanceTo(n),s=i.minus(t),a=Math.atan(s.y/s.x);return s.x<0?a+=Math.PI:s.y<0&&(a+=2*Math.PI),new e.Rect(t.x,t.y,r,o,a/Math.PI*180)},e.Rect.prototype={clone:function(){return new e.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new e.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new e.Point(this.width,this.height)},equals:function(t){return t instanceof e.Rect&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height&&this.degrees===t.degrees},times:function(t){return new e.Rect(this.x*t,this.y*t,this.width*t,this.height*t,this.degrees)},translate:function(t){return new e.Rect(this.x+t.x,this.y+t.y,this.width,this.height,this.degrees)},union:function(t){var i=this.getBoundingBox(),n=t.getBoundingBox(),r=Math.min(i.x,n.x),o=Math.min(i.y,n.y),s=Math.max(i.x+i.width,n.x+n.width),a=Math.max(i.y+i.height,n.y+n.height);return new e.Rect(r,o,s-r,a-o)},intersection:function(t){var i=1e-10,n=[],r=this.getTopLeft();t.containsPoint(r,i)&&n.push(r);var o=this.getTopRight();t.containsPoint(o,i)&&n.push(o);var s=this.getBottomLeft();t.containsPoint(s,i)&&n.push(s);var a=this.getBottomRight();t.containsPoint(a,i)&&n.push(a);var l=t.getTopLeft();this.containsPoint(l,i)&&n.push(l);var c=t.getTopRight();this.containsPoint(c,i)&&n.push(c);var g=t.getBottomLeft();this.containsPoint(g,i)&&n.push(g);var v=t.getBottomRight();this.containsPoint(v,i)&&n.push(v);for(var p=this._getSegments(),w=t._getSegments(),E=0;E<p.length;E++)for(var b=p[E],u=0;u<w.length;u++){var m=w[u],S=x(b[0],b[1],m[0],m[1]);S&&n.push(S)}function x(U,k,J,te){var ce=k.minus(U),fe=te.minus(J),he=-fe.x*ce.y+ce.x*fe.y;if(he===0)return null;var Y=(ce.x*(U.y-J.y)-ce.y*(U.x-J.x))/he,we=(fe.x*(U.y-J.y)-fe.y*(U.x-J.x))/he;return-i<=Y&&Y<=1-i&&-i<=we&&we<=1-i?new e.Point(U.x+we*ce.x,U.y+we*ce.y):null}if(n.length===0)return null;for(var D=n[0].x,I=n[0].x,M=n[0].y,R=n[0].y,L=1;L<n.length;L++){var G=n[L];G.x<D&&(D=G.x),G.x>I&&(I=G.x),G.y<M&&(M=G.y),G.y>R&&(R=G.y)}return new e.Rect(D,M,I-D,R-M)},_getSegments:function(){var t=this.getTopLeft(),i=this.getTopRight(),n=this.getBottomLeft(),r=this.getBottomRight();return[[t,i],[i,r],[r,n],[n,t]]},rotate:function(t,i){if(t=e.positiveModulo(t,360),t===0)return this.clone();i=i||this.getCenter();var n=this.getTopLeft().rotate(t,i),r=this.getTopRight().rotate(t,i),o=r.minus(n);o=o.apply(function(a){var l=1e-15;return Math.abs(a)<l?0:a});var s=Math.atan(o.y/o.x);return o.x<0?s+=Math.PI:o.y<0&&(s+=2*Math.PI),new e.Rect(n.x,n.y,this.width,this.height,s/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var t=this.getTopLeft(),i=this.getTopRight(),n=this.getBottomLeft(),r=this.getBottomRight(),o=Math.min(t.x,i.x,n.x,r.x),s=Math.max(t.x,i.x,n.x,r.x),a=Math.min(t.y,i.y,n.y,r.y),l=Math.max(t.y,i.y,n.y,r.y);return new e.Rect(o,a,s-o,l-a)},getIntegerBoundingBox:function(){var t=this.getBoundingBox(),i=Math.floor(t.x),n=Math.floor(t.y),r=Math.ceil(t.width+t.x-i),o=Math.ceil(t.height+t.y-n);return new e.Rect(i,n,r,o)},containsPoint:function(t,i){i=i||0;var n=this.getTopLeft(),r=this.getTopRight(),o=this.getBottomLeft(),s=r.minus(n),a=o.minus(n);return(t.x-n.x)*s.x+(t.y-n.y)*s.y>=-i&&(t.x-r.x)*s.x+(t.y-r.y)*s.y<=i&&(t.x-n.x)*a.x+(t.y-n.y)*a.y>=-i&&(t.x-o.x)*a.x+(t.y-o.y)*a.y<=i},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(OpenSeadragon),function(e){var t={};e.ReferenceStrip=function(c){var g=this,v=c.viewer,p=e.getElementSize(v.element),w,E,b;for(c.id||(c.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=c.id,this.element.className="referencestrip"),c=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},c,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),e.extend(this,c),t[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,E=this.element.style,E.marginTop="0px",E.marginRight="0px",E.marginBottom="0px",E.marginLeft="0px",E.left="0px",E.bottom="0px",E.border="0px",E.background="#000",E.position="relative",e.setElementTouchActionNone(this.element),e.setElementOpacity(this.element,.8),this.viewer=v,this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,i),scrollHandler:e.delegate(this,n),enterHandler:e.delegate(this,o),exitHandler:e.delegate(this,s),keyDownHandler:e.delegate(this,a),keyHandler:e.delegate(this,l)}),c.width&&c.height?(this.element.style.width=c.width+"px",this.element.style.height=c.height+"px",v.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):c.scroll=="horizontal"?(this.element.style.width=p.x*c.sizeRatio*v.tileSources.length+12*v.tileSources.length+"px",this.element.style.height=p.y*c.sizeRatio+"px",v.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=p.y*c.sizeRatio*v.tileSources.length+12*v.tileSources.length+"px",this.element.style.width=p.x*c.sizeRatio+"px",v.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=p.x*this.sizeRatio+8,this.panelHeight=p.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},b=0;b<v.tileSources.length;b++)w=e.makeNeutralElement("div"),w.id=this.element.id+"-"+b,w.style.width=g.panelWidth+"px",w.style.height=g.panelHeight+"px",w.style.display="inline",w.style.float="left",w.style.cssFloat="left",w.style.styleFloat="left",w.style.padding="2px",e.setElementTouchActionNone(w),w.innerTracker=new e.MouseTracker({element:w,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(u){u.eventSource.dragging=e.now()},releaseHandler:function(u){var m=u.eventSource,S=m.element.id,x=Number(S.split("-")[2]),D=e.now();u.insideElementPressed&&u.insideElementReleased&&m.dragging&&D-m.dragging<m.clickTimeThreshold&&(m.dragging=null,v.goToPage(x))}}),this.element.appendChild(w),w.activePanel=!1,this.panels.push(w);r(this,this.scroll=="vertical"?p.y:p.x,0),this.setFocus(0)},e.extend(e.ReferenceStrip.prototype,e.EventSource.prototype,e.Viewer.prototype,{setFocus:function(c){var g=this.element.querySelector("#"+this.element.id+"-"+c),v=e.getElementSize(this.viewer.canvas),p=Number(this.element.style.width.replace("px","")),w=Number(this.element.style.height.replace("px","")),E=-Number(this.element.style.marginLeft.replace("px","")),b=-Number(this.element.style.marginTop.replace("px","")),u;this.currentSelected!==g&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=g,this.currentSelected.style.background="#999",this.scroll=="horizontal"?(u=Number(c)*(this.panelWidth+3),u>E+v.x-this.panelWidth?(u=Math.min(u,p-v.x),this.element.style.marginLeft=-u+"px",r(this,v.x,-u)):u<E&&(u=Math.max(0,u-v.x/2),this.element.style.marginLeft=-u+"px",r(this,v.x,-u))):(u=Number(c)*(this.panelHeight+3),u>b+v.y-this.panelHeight?(u=Math.min(u,w-v.y),this.element.style.marginTop=-u+"px",r(this,v.y,-u)):u<b&&(u=Math.max(0,u-v.y/2),this.element.style.marginTop=-u+"px",r(this,v.y,-u))),this.currentPage=c,o.call(this,{eventSource:this.innerTracker}))},update:function(){return t[this.id].animating?(e.console.log("image reference strip update"),!0):!1},destroy:function(){if(this.miniViewers)for(var c in this.miniViewers)this.miniViewers[c].destroy();this.element&&this.element.parentNode.removeChild(this.element)}});function i(c){var g=Number(this.element.style.marginLeft.replace("px","")),v=Number(this.element.style.marginTop.replace("px","")),p=Number(this.element.style.width.replace("px","")),w=Number(this.element.style.height.replace("px","")),E=e.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&(this.scroll=="horizontal"?-c.delta.x>0?g>-(p-E.x)&&(this.element.style.marginLeft=g+c.delta.x*2+"px",r(this,E.x,g+c.delta.x*2)):-c.delta.x<0&&g<0&&(this.element.style.marginLeft=g+c.delta.x*2+"px",r(this,E.x,g+c.delta.x*2)):-c.delta.y>0?v>-(w-E.y)&&(this.element.style.marginTop=v+c.delta.y*2+"px",r(this,E.y,v+c.delta.y*2)):-c.delta.y<0&&v<0&&(this.element.style.marginTop=v+c.delta.y*2+"px",r(this,E.y,v+c.delta.y*2))),!1}function n(c){var g=Number(this.element.style.marginLeft.replace("px","")),v=Number(this.element.style.marginTop.replace("px","")),p=Number(this.element.style.width.replace("px","")),w=Number(this.element.style.height.replace("px","")),E=e.getElementSize(this.viewer.canvas);return this.element&&(this.scroll=="horizontal"?c.scroll>0?g>-(p-E.x)&&(this.element.style.marginLeft=g-c.scroll*60+"px",r(this,E.x,g-c.scroll*60)):c.scroll<0&&g<0&&(this.element.style.marginLeft=g-c.scroll*60+"px",r(this,E.x,g-c.scroll*60)):c.scroll<0?v>E.y-w&&(this.element.style.marginTop=v+c.scroll*60+"px",r(this,E.y,v+c.scroll*60)):c.scroll>0&&v<0&&(this.element.style.marginTop=v+c.scroll*60+"px",r(this,E.y,v+c.scroll*60))),!1}function r(c,g,v){var p,w,E,b,u,m,S;for(c.scroll=="horizontal"?p=c.panelWidth:p=c.panelHeight,w=Math.ceil(g/p)+5,E=Math.ceil((Math.abs(v)+g)/p)+1,w=E-w,w=w<0?0:w,m=w;m<E&&m<c.panels.length;m++)if(S=c.panels[m],!S.activePanel){var x,D=c.viewer.tileSources[m];D.referenceStripThumbnailUrl?x={type:"image",url:D.referenceStripThumbnailUrl}:x=D,b=new e.Viewer({id:S.id,tileSources:[x],element:S,navigatorSizeRatio:c.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:c.viewer.loadTilesWithAjax,ajaxHeaders:c.viewer.ajaxHeaders,useCanvas:c.useCanvas}),b.displayRegion=e.makeNeutralElement("div"),b.displayRegion.id=S.id+"-displayregion",b.displayRegion.className="displayregion",u=b.displayRegion.style,u.position="relative",u.top="0px",u.left="0px",u.fontSize="0px",u.overflow="hidden",u.float="left",u.cssFloat="left",u.styleFloat="left",u.zIndex=999999999,u.cursor="default",u.width=c.panelWidth-4+"px",u.height=c.panelHeight-4+"px",b.displayRegion.innerTracker=new e.MouseTracker({element:b.displayRegion,startDisabled:!0}),S.getElementsByTagName("div")[0].appendChild(b.displayRegion),c.miniViewers[S.id]=b,S.activePanel=!0}}function o(c){var g=c.eventSource.element;return this.scroll=="horizontal"?g.style.marginBottom="0px":g.style.marginLeft="0px",!1}function s(c){var g=c.eventSource.element;return this.scroll=="horizontal"?g.style.marginBottom="-"+e.getElementSize(g).y/2+"px":g.style.marginLeft="-"+e.getElementSize(g).x/2+"px",!1}function a(c){if(!c.preventDefaultAction&&!c.ctrl&&!c.alt&&!c.meta)switch(c.keyCode){case 38:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 37:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}else return!0}function l(c){if(!c.preventDefaultAction&&!c.ctrl&&!c.alt&&!c.meta)switch(c.keyCode){case 61:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 97:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}else return!0}}(OpenSeadragon),function(e){e.DisplayRect=function(t,i,n,r,o,s){e.Rect.apply(this,[t,i,n,r]),this.minLevel=o,this.maxLevel=s},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(OpenSeadragon),function(e){e.Spring=function(i){var n=arguments;typeof i!="object"&&(i={initial:n.length&&typeof n[0]=="number"?n[0]:void 0,springStiffness:n.length>1?n[1].springStiffness:5,animationTime:n.length>1?n[1].animationTime:1.5}),e.console.assert(typeof i.springStiffness=="number"&&i.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),e.console.assert(typeof i.animationTime=="number"&&i.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),i.exponential&&(this._exponential=!0,delete i.exponential),e.extend(!0,this,i),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:e.now()},e.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},e.Spring.prototype={resetTo:function(i){e.console.assert(!this._exponential||i!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=i,this.start.time=this.target.time=this.current.time=e.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(i){e.console.assert(!this._exponential||i!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=i,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(i){this.start.value+=i,this.target.value+=i,this._exponential&&(e.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(i){this._exponential=i,this._exponential&&(e.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=e.now();var i,n;this._exponential?(i=this.start._logValue,n=this.target._logValue):(i=this.start.value,n=this.target.value);var r=this.current.time>=this.target.time?n:i+(n-i)*t(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),o=this.current.value;return this._exponential?this.current.value=Math.exp(r):this.current.value=r,o!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function t(i,n){return(1-Math.exp(i*-n))/(1-Math.exp(-i))}}(OpenSeadragon),function(e){function t(n){e.extend(!0,this,{timeout:e.DEFAULT_SETTINGS.timeout,jobId:null},n),this.image=null}t.prototype={errorMsg:null,start:function(){var n=this,r=this.abort;this.image=new Image,this.image.onload=function(){n.finish(!0)},this.image.onabort=this.image.onerror=function(){n.errorMsg="Image load aborted",n.finish(!1)},this.jobId=window.setTimeout(function(){n.errorMsg="Image load exceeded timeout ("+n.timeout+" ms)",n.finish(!1)},this.timeout),this.loadWithAjax?(this.request=e.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(o){var s;try{s=new window.Blob([o.response])}catch(g){var a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(g.name==="TypeError"&&a){var l=new a;l.append(o.response),s=l.getBlob()}}s.size===0&&(n.errorMsg="Empty image response.",n.finish(!1));var c=(window.URL||window.webkitURL).createObjectURL(s);n.image.src=c},error:function(o){n.errorMsg="Image load aborted - XHR error",n.finish(!1)}}),this.abort=function(){n.request.abort(),typeof r=="function"&&r()}):(this.crossOriginPolicy!==!1&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(n){this.image.onload=this.image.onerror=this.image.onabort=null,n||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},e.ImageLoader=function(n){e.extend(!0,this,{jobLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,timeout:e.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},n)},e.ImageLoader.prototype={addJob:function(n){var r=this,o=function(l){i(r,l,n.callback)},s={src:n.src,loadWithAjax:n.loadWithAjax,ajaxHeaders:n.loadWithAjax?n.ajaxHeaders:null,crossOriginPolicy:n.crossOriginPolicy,ajaxWithCredentials:n.ajaxWithCredentials,callback:o,abort:n.abort,timeout:this.timeout},a=new t(s);!this.jobLimit||this.jobsInProgress<this.jobLimit?(a.start(),this.jobsInProgress++):this.jobQueue.push(a)},clear:function(){for(var n=0;n<this.jobQueue.length;n++){var r=this.jobQueue[n];typeof r.abort=="function"&&r.abort()}this.jobQueue=[]}};function i(n,r,o){var s;n.jobsInProgress--,(!n.jobLimit||n.jobsInProgress<n.jobLimit)&&n.jobQueue.length>0&&(s=n.jobQueue.shift(),s.start(),n.jobsInProgress++),o(r.image,r.errorMsg,r.request)}}(OpenSeadragon),function(e){e.Tile=function(t,i,n,r,o,s,a,l,c,g){this.level=t,this.x=i,this.y=n,this.bounds=r,this.sourceBounds=g,this.exists=o,this.url=s,this.context2D=a,this.loadWithAjax=l,this.ajaxHeaders=c,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(t){if(!this.cacheImageRecord){e.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}this.element||(this.element=e.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=t&&t.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",e.setElementOpacity(this.element,this.opacity)},drawCanvas:function(t,i,n,r){var o=this.position.times(e.pixelDensityRatio),s=this.size.times(e.pixelDensityRatio),a;if(!this.context2D&&!this.cacheImageRecord){e.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(a=this.context2D||this.cacheImageRecord.getRenderedContext(),!this.loaded||!a){e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}t.save(),t.globalAlpha=this.opacity,typeof n=="number"&&n!==1&&(o=o.times(n),s=s.times(n)),r instanceof e.Point&&(o=o.plus(r)),t.globalAlpha===1&&this._hasTransparencyChannel()&&t.clearRect(o.x,o.y,s.x,s.y),i({context:t,tile:this,rendered:a});var l,c;this.sourceBounds?(l=Math.min(this.sourceBounds.width,a.canvas.width),c=Math.min(this.sourceBounds.height,a.canvas.height)):(l=a.canvas.width,c=a.canvas.height),t.drawImage(a.canvas,0,0,l,c,o.x,o.y,s.x,s.y),t.restore()},getScaleForEdgeSmoothing:function(){var t;if(this.cacheImageRecord)t=this.cacheImageRecord.getRenderedContext();else if(this.context2D)t=this.context2D;else return e.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return t.canvas.width/(this.size.x*e.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(t,i,n){var r=Math.max(1,Math.ceil((n.x-i.x)/2)),o=Math.max(1,Math.ceil((n.y-i.y)/2));return new e.Point(r,o).minus(this.position.times(e.pixelDensityRatio).times(t||1).apply(function(s){return s%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(e){e.OverlayPlacement=e.Placement,e.OverlayRotationMode=e.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),e.Overlay=function(t,i,n){var r;e.isPlainObject(t)?r=t:r={element:t,location:i,placement:n},this.element=r.element,this.style=r.element.style,this._init(r)},e.Overlay.prototype={_init:function(t){this.location=t.location,this.placement=t.placement===void 0?e.Placement.TOP_LEFT:t.placement,this.onDraw=t.onDraw,this.checkResize=t.checkResize===void 0?!0:t.checkResize,this.width=t.width===void 0?null:t.width,this.height=t.height===void 0?null:t.height,this.rotationMode=t.rotationMode||e.OverlayRotationMode.EXACT,this.location instanceof e.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=e.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new e.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(t,i){var n=e.Placement.properties[this.placement];!n||(n.isHorizontallyCentered?t.x-=i.x/2:n.isRight&&(t.x-=i.x),n.isVerticallyCentered?t.y-=i.y/2:n.isBottom&&(t.y-=i.y))},destroy:function(){var t=this.element,i=this.style;t.parentNode&&(t.parentNode.removeChild(t),t.prevElementParent&&(i.display="none",document.body.appendChild(t))),this.onDraw=null,i.top="",i.left="",i.position="",this.width!==null&&(i.width=""),this.height!==null&&(i.height="");var n=e.getCssPropertyWithVendorPrefix("transformOrigin"),r=e.getCssPropertyWithVendorPrefix("transform");n&&r&&(i[n]="",i[r]="")},drawHTML:function(t,i){var n=this.element;n.parentNode!==t&&(n.prevElementParent=n.parentNode,n.prevNextSibling=n.nextSibling,t.appendChild(n),this.style.position="absolute",this.size=e.getElementSize(n));var r=this._getOverlayPositionAndSize(i),o=r.position,s=this.size=r.size,a=r.rotate;if(this.onDraw)this.onDraw(o,s,this.element);else{var l=this.style;l.left=o.x+"px",l.top=o.y+"px",this.width!==null&&(l.width=s.x+"px"),this.height!==null&&(l.height=s.y+"px");var c=e.getCssPropertyWithVendorPrefix("transformOrigin"),g=e.getCssPropertyWithVendorPrefix("transform");c&&g&&(a?(l[c]=this._getTransformOrigin(),l[g]="rotate("+a+"deg)"):(l[c]="",l[g]="")),l.display!=="none"&&(l.display="block")}},_getOverlayPositionAndSize:function(t){var i=t.pixelFromPoint(this.location,!0),n=this._getSizeInPixels(t);this.adjust(i,n);var r=0;if(t.degrees&&this.rotationMode!==e.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var o=new e.Rect(i.x,i.y,n.x,n.y),s=this._getBoundingBox(o,t.degrees);i=s.getTopLeft(),n=s.getSize()}else r=t.degrees;return{position:i,size:n,rotate:r}},_getSizeInPixels:function(t){var i=this.size.x,n=this.size.y;if(this.width!==null||this.height!==null){var r=t.deltaPixelsFromPointsNoRotate(new e.Point(this.width||0,this.height||0),!0);this.width!==null&&(i=r.x),this.height!==null&&(n=r.y)}if(this.checkResize&&(this.width===null||this.height===null)){var o=this.size=e.getElementSize(this.element);this.width===null&&(i=o.x),this.height===null&&(n=o.y)}return new e.Point(i,n)},_getBoundingBox:function(t,i){var n=this._getPlacementPoint(t);return t.rotate(i,n).getBoundingBox()},_getPlacementPoint:function(t){var i=new e.Point(t.x,t.y),n=e.Placement.properties[this.placement];return n&&(n.isHorizontallyCentered?i.x+=t.width/2:n.isRight&&(i.x+=t.width),n.isVerticallyCentered?i.y+=t.height/2:n.isBottom&&(i.y+=t.height)),i},_getTransformOrigin:function(){var t="",i=e.Placement.properties[this.placement];return i&&(i.isLeft?t="left":i.isRight&&(t="right"),i.isTop?t+=" top":i.isBottom&&(t+=" bottom")),t},update:function(t,i){var n=e.isPlainObject(t)?t:{location:t,placement:i};this._init({location:n.location||this.location,placement:n.placement!==void 0?n.placement:this.placement,onDraw:n.onDraw||this.onDraw,checkResize:n.checkResize||this.checkResize,width:n.width!==void 0?n.width:this.width,height:n.height!==void 0?n.height:this.height,rotationMode:n.rotationMode||this.rotationMode})},getBounds:function(t){e.console.assert(t,"A viewport must now be passed to Overlay.getBounds.");var i=this.width,n=this.height;if(i===null||n===null){var r=t.deltaPointsFromPixelsNoRotate(this.size,!0);i===null&&(i=r.x),n===null&&(n=r.y)}var o=this.location.clone();return this.adjust(o,new e.Point(i,n)),this._adjustBoundsForRotation(t,new e.Rect(o.x,o.y,i,n))},_adjustBoundsForRotation:function(t,i){if(!t||t.degrees===0||this.rotationMode===e.OverlayRotationMode.EXACT)return i;if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return i;var n=this._getOverlayPositionAndSize(t);return t.viewerElementToViewportRectangle(new e.Rect(n.position.x,n.position.y,n.size.x,n.size.y))}return i.rotate(-t.degrees,this._getPlacementPoint(i))}}}(OpenSeadragon),function(e){e.Drawer=function(t){e.console.assert(t.viewer,"[Drawer] options.viewer is required");var i=arguments;if(e.isPlainObject(t)||(t={source:i[0],viewport:i[1],element:i[2]}),e.console.assert(t.viewport,"[Drawer] options.viewport is required"),e.console.assert(t.element,"[Drawer] options.element is required"),t.source&&e.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=t.viewer,this.viewport=t.viewport,this.debugGridColor=typeof t.debugGridColor=="string"?[t.debugGridColor]:t.debugGridColor||e.DEFAULT_SETTINGS.debugGridColor,t.opacity&&e.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=e.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=e.getElement(t.element),this.canvas=e.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var n=this._calculateCanvasSize();this.canvas.width=n.x,this.canvas.height=n.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",e.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},e.Drawer.prototype={addOverlay:function(t,i,n,r){return e.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(t,i,n,r),this},updateOverlay:function(t,i,n){return e.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(t,i,n),this},removeOverlay:function(t){return e.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(t),this},clearOverlays:function(){return e.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(t){var i=this.viewport.pixelFromPointNoRotate(t,!0);return new e.Point(i.x*e.pixelDensityRatio,i.y*e.pixelDensityRatio)},clipWithPolygons:function(t,i){if(!!this.useCanvas){var n=this._getContext(i);n.beginPath(),t.forEach(function(r){r.forEach(function(o,s){n[s===0?"moveTo":"lineTo"](o.x,o.y)})}),n.clip()}},setOpacity:function(t){e.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var i=this.viewer.world,n=0;n<i.getItemCount();n++)i.getItemAt(n).setOpacity(t);return this},getOpacity:function(){e.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var t=this.viewer.world,i=0,n=0;n<t.getItemCount();n++){var r=t.getItemAt(n).getOpacity();r>i&&(i=r)}return i},needsUpdate:function(){return e.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return e.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return e.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return e.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var t=this._calculateCanvasSize();if((this.canvas.width!=t.x||this.canvas.height!=t.y)&&(this.canvas.width=t.x,this.canvas.height=t.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var i=this._calculateSketchCanvasSize();this.sketchCanvas.width=i.x,this.sketchCanvas.height=i.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(t,i){if(!!this.useCanvas){var n=this._getContext(t);if(i)n.clearRect(i.x,i.y,i.width,i.height);else{var r=n.canvas;n.clearRect(0,0,r.width,r.height)}}},viewportToDrawerRectangle:function(t){var i=this.viewport.pixelFromPointNoRotate(t.getTopLeft(),!0),n=this.viewport.deltaPixelsFromPointsNoRotate(t.getSize(),!0);return new e.Rect(i.x*e.pixelDensityRatio,i.y*e.pixelDensityRatio,n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio)},drawTile:function(t,i,n,r,o){if(e.console.assert(t,"[Drawer.drawTile] tile is required"),e.console.assert(i,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var s=this._getContext(n);r=r||1,t.drawCanvas(s,i,r,o)}else t.drawHTML(this.canvas)},_getContext:function(t){var i=this.context;if(t){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var n=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=n.x,this.sketchCanvas.height=n.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var r=this;this.viewer.addHandler("rotate",function o(){if(r.viewport.getRotation()!==0){r.viewer.removeHandler("rotate",o);var s=r._calculateSketchCanvasSize();r.sketchCanvas.width=s.x,r.sketchCanvas.height=s.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}i=this.sketchContext}return i},saveContext:function(t){!this.useCanvas||this._getContext(t).save()},restoreContext:function(t){!this.useCanvas||this._getContext(t).restore()},setClip:function(t,i){if(!!this.useCanvas){var n=this._getContext(i);n.beginPath(),n.rect(t.x,t.y,t.width,t.height),n.clip()}},drawRectangle:function(t,i,n){if(!!this.useCanvas){var r=this._getContext(n);r.save(),r.fillStyle=i,r.fillRect(t.x,t.y,t.width,t.height),r.restore()}},blendSketch:function(t,i,n,r){var o=t;if(e.isPlainObject(o)||(o={opacity:t,scale:i,translate:n,compositeOperation:r}),!(!this.useCanvas||!this.sketchCanvas)){t=o.opacity,r=o.compositeOperation;var s=o.bounds;if(this.context.save(),this.context.globalAlpha=t,r&&(this.context.globalCompositeOperation=r),s)s.x<0&&(s.width+=s.x,s.x=0),s.x+s.width>this.canvas.width&&(s.width=this.canvas.width-s.x),s.y<0&&(s.height+=s.y,s.y=0),s.y+s.height>this.canvas.height&&(s.height=this.canvas.height-s.y),this.context.drawImage(this.sketchCanvas,s.x,s.y,s.width,s.height,s.x,s.y,s.width,s.height);else{i=o.scale||1,n=o.translate;var a=n instanceof e.Point?n:new e.Point(0,0),l=0,c=0;if(n){var g=this.sketchCanvas.width-this.canvas.width,v=this.sketchCanvas.height-this.canvas.height;l=Math.round(g/2),c=Math.round(v/2)}this.context.drawImage(this.sketchCanvas,a.x-l*i,a.y-c*i,(this.canvas.width+2*l)*i,(this.canvas.height+2*c)*i,-l,-c,this.canvas.width+2*l,this.canvas.height+2*c)}this.context.restore()}},drawDebugInfo:function(t,i,n,r){if(!!this.useCanvas){var o=this.viewer.world.getIndexOfItem(r)%this.debugGridColor.length,s=this.context;s.save(),s.lineWidth=2*e.pixelDensityRatio,s.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",s.strokeStyle=this.debugGridColor[o],s.fillStyle=this.debugGridColor[o],this.viewport.degrees!==0&&this._offsetForRotation({degrees:this.viewport.degrees}),r.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:r.getRotation(!0),point:r.viewport.pixelFromPointNoRotate(r._getRotationPoint(!0),!0)}),r.viewport.degrees===0&&r.getRotation(!0)%360==0&&r._drawer.viewer.viewport.getFlip()&&r._drawer._flip(),s.strokeRect(t.position.x*e.pixelDensityRatio,t.position.y*e.pixelDensityRatio,t.size.x*e.pixelDensityRatio,t.size.y*e.pixelDensityRatio);var a=(t.position.x+t.size.x/2)*e.pixelDensityRatio,l=(t.position.y+t.size.y/2)*e.pixelDensityRatio;s.translate(a,l),s.rotate(Math.PI/180*-this.viewport.degrees),s.translate(-a,-l),t.x===0&&t.y===0&&(s.fillText("Zoom: "+this.viewport.getZoom(),t.position.x*e.pixelDensityRatio,(t.position.y-30)*e.pixelDensityRatio),s.fillText("Pan: "+this.viewport.getBounds().toString(),t.position.x*e.pixelDensityRatio,(t.position.y-20)*e.pixelDensityRatio)),s.fillText("Level: "+t.level,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+20)*e.pixelDensityRatio),s.fillText("Column: "+t.x,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+30)*e.pixelDensityRatio),s.fillText("Row: "+t.y,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+40)*e.pixelDensityRatio),s.fillText("Order: "+n+" of "+i,(t.position.x+10)*e.pixelDensityRatio,(t.position.y+50)*e.pixelDensityRatio),s.fillText("Size: "+t.size.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+60)*e.pixelDensityRatio),s.fillText("Position: "+t.position.toString(),(t.position.x+10)*e.pixelDensityRatio,(t.position.y+70)*e.pixelDensityRatio),this.viewport.degrees!==0&&this._restoreRotationChanges(),r.getRotation(!0)%360!=0&&this._restoreRotationChanges(),r.viewport.degrees===0&&r.getRotation(!0)%360==0&&r._drawer.viewer.viewport.getFlip()&&r._drawer._flip(),s.restore()}},debugRect:function(t){if(this.useCanvas){var i=this.context;i.save(),i.lineWidth=2*e.pixelDensityRatio,i.strokeStyle=this.debugGridColor[0],i.fillStyle=this.debugGridColor[0],i.strokeRect(t.x*e.pixelDensityRatio,t.y*e.pixelDensityRatio,t.width*e.pixelDensityRatio,t.height*e.pixelDensityRatio),i.restore()}},setImageSmoothingEnabled:function(t){this.useCanvas&&(this._imageSmoothingEnabled=t,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(t){t.msImageSmoothingEnabled=this._imageSmoothingEnabled,t.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(t){var i=this._getContext(t).canvas;return new e.Point(i.width,i.height)},getCanvasCenter:function(){return new e.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(t){var i=t.point?t.point.times(e.pixelDensityRatio):this.getCanvasCenter(),n=this._getContext(t.useSketch);n.save(),n.translate(i.x,i.y),this.viewer.viewport.flipped?(n.rotate(Math.PI/180*-t.degrees),n.scale(-1,1)):n.rotate(Math.PI/180*t.degrees),n.translate(-i.x,-i.y)},_flip:function(t){t=t||{};var i=t.point?t.point.times(e.pixelDensityRatio):this.getCanvasCenter(),n=this._getContext(t.useSketch);n.translate(i.x,0),n.scale(-1,1),n.translate(-i.x,0)},_restoreRotationChanges:function(t){var i=this._getContext(t);i.restore()},_calculateCanvasSize:function(){var t=e.pixelDensityRatio,i=this.viewport.getContainerSize();return{x:Math.round(i.x*t),y:Math.round(i.y*t)}},_calculateSketchCanvasSize:function(){var t=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return t;var i=Math.ceil(Math.sqrt(t.x*t.x+t.y*t.y));return{x:i,y:i}}}}(OpenSeadragon),function(e){e.Viewport=function(t){var i=arguments;i.length&&i[0]instanceof e.Point&&(t={containerSize:i[0],contentSize:i[1],config:i[2]}),t.config&&(e.extend(!0,t,t.config),delete t.config),this._margins=e.extend({left:0,top:0,right:0,bottom:0},t.margins||{}),delete t.margins,e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,degrees:e.DEFAULT_SETTINGS.degrees,flipped:e.DEFAULT_SETTINGS.flipped,homeFillsViewer:e.DEFAULT_SETTINGS.homeFillsViewer},t),this._updateContainerInnerSize(),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new e.Rect(0,0,1,1),1),this.goHome(!0),this.update()},e.Viewport.prototype={resetContentSize:function(t){return e.console.assert(t,"[Viewport.resetContentSize] contentSize is required"),e.console.assert(t instanceof e.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),e.console.assert(t.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),e.console.assert(t.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new e.Rect(0,0,1,t.y/t.x),t.x),this},setHomeBounds:function(t,i){e.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(t,i)},_setContentBounds:function(t,i){e.console.assert(t,"[Viewport._setContentBounds] bounds is required"),e.console.assert(t instanceof e.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),e.console.assert(t.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),e.console.assert(t.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=t.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(i),this._contentBounds=t.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(i),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:i,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var t=this._contentAspectRatio/this.getAspectRatio(),i;return this.homeFillsViewer?i=t>=1?t:1:i=t>=1?1:t,i/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var t=this._contentBounds.getCenter(),i=1/this.getHomeZoom(),n=i/this.getAspectRatio();return new e.Rect(t.x-i/2,t.y-n/2,i,n)},goHome:function(t){return this.viewer&&this.viewer.raiseEvent("home",{immediately:t}),this.fitBounds(this.getHomeBounds(),t)},getMinZoom:function(){var t=this.getHomeZoom(),i=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*t;return i},getMaxZoom:function(){var t=this.maxZoomLevel;return t||(t=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,t/=this._contentBounds.width),Math.max(t,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return e.extend({},this._margins)},setMargins:function(t){e.console.assert(e.type(t)==="object","[Viewport.setMargins] margins must be an object"),this._margins=e.extend({left:0,top:0,right:0,bottom:0},t),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(t){return this.getBoundsNoRotate(t).rotate(-this.getRotation())},getBoundsNoRotate:function(t){var i=this.getCenter(t),n=1/this.getZoom(t),r=n/this.getAspectRatio();return new e.Rect(i.x-n/2,i.y-r/2,n,r)},getBoundsWithMargins:function(t){return this.getBoundsNoRotateWithMargins(t).rotate(-this.getRotation(),this.getCenter(t))},getBoundsNoRotateWithMargins:function(t){var i=this.getBoundsNoRotate(t),n=this._containerInnerSize.x*this.getZoom(t);return i.x-=this._margins.left/n,i.y-=this._margins.top/n,i.width+=(this._margins.left+this._margins.right)/n,i.height+=(this._margins.top+this._margins.bottom)/n,i},getCenter:function(t){var i=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),n=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),r,o,s,a,l,c,g,v;return t?i:this.zoomPoint?(r=this.pixelFromPoint(this.zoomPoint,!0),o=this.getZoom(),s=1/o,a=s/this.getAspectRatio(),l=new e.Rect(i.x-s/2,i.y-a/2,s,a),c=this._pixelFromPoint(this.zoomPoint,l),g=c.minus(r),v=g.divide(this._containerInnerSize.x*o),n.plus(v)):n},getZoom:function(t){return t?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(t){return Math.max(Math.min(t,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(t){var i=new e.Rect(t.x,t.y,t.width,t.height);if(!this.wrapHorizontal){var n=this.visibilityRatio*i.width,r=i.x+i.width,o=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,s=this._contentBoundsNoRotate.x-r+n,a=o-i.x-n;n>this._contentBoundsNoRotate.width?i.x+=(s+a)/2:a<0?i.x+=a:s>0&&(i.x+=s)}if(!this.wrapVertical){var l=this.visibilityRatio*i.height,c=i.y+i.height,g=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,v=this._contentBoundsNoRotate.y-c+l,p=g-i.y-l;l>this._contentBoundsNoRotate.height?i.y+=(v+p)/2:p<0?i.y+=p:v>0&&(i.y+=v)}return i},_raiseConstraintsEvent:function(t){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:t})},applyConstraints:function(t){var i=this.getZoom(),n=this._applyZoomConstraints(i);i!==n&&this.zoomTo(n,this.zoomPoint,t);var r=this.getBoundsNoRotate(),o=this._applyBoundaryConstraints(r);return this._raiseConstraintsEvent(t),(r.x!==o.x||r.y!==o.y||t)&&this.fitBounds(o.rotate(-this.getRotation()),t),this},ensureVisible:function(t){return this.applyConstraints(t)},_fitBounds:function(t,i){i=i||{};var n=i.immediately||!1,r=i.constraints||!1,o=this.getAspectRatio(),s=t.getCenter(),a=new e.Rect(t.x,t.y,t.width,t.height,t.degrees+this.getRotation()).getBoundingBox();a.getAspectRatio()>=o?a.height=a.width/o:a.width=a.height*o,a.x=s.x-a.width/2,a.y=s.y-a.height/2;var l=1/a.width;if(r){var c=a.getAspectRatio(),g=this._applyZoomConstraints(l);l!==g&&(l=g,a.width=1/l,a.x=s.x-a.width/2,a.height=a.width/c,a.y=s.y-a.height/2),a=this._applyBoundaryConstraints(a),s=a.getCenter(),this._raiseConstraintsEvent(n)}if(n)return this.panTo(s,!0),this.zoomTo(l,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var v=this.getBounds(),p=this.getZoom();if(p===0||Math.abs(l/p-1)<1e-8)return this.zoomTo(l,!0),this.panTo(s,n);a=a.rotate(-this.getRotation());var w=a.getTopLeft().times(l).minus(v.getTopLeft().times(p)).divide(l-p);return this.zoomTo(l,w,n)},fitBounds:function(t,i){return this._fitBounds(t,{immediately:i,constraints:!1})},fitBoundsWithConstraints:function(t,i){return this._fitBounds(t,{immediately:i,constraints:!0})},fitVertically:function(t){var i=new e.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(i,t)},fitHorizontally:function(t){var i=new e.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(i,t)},getConstrainedBounds:function(t){var i,n;return i=this.getBounds(t),n=this._applyBoundaryConstraints(i),n},panBy:function(t,i){var n=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(n.plus(t),i)},panTo:function(t,i){return i?(this.centerSpringX.resetTo(t.x),this.centerSpringY.resetTo(t.y)):(this.centerSpringX.springTo(t.x),this.centerSpringY.springTo(t.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:t,immediately:i}),this},zoomBy:function(t,i,n){return this.zoomTo(this.zoomSpring.target.value*t,i,n)},zoomTo:function(t,i,n){var r=this;return this.zoomPoint=i instanceof e.Point&&!isNaN(i.x)&&!isNaN(i.y)?i:null,n?this._adjustCenterSpringsForZoomPoint(function(){r.zoomSpring.resetTo(t)}):this.zoomSpring.springTo(t),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:t,refPoint:i,immediately:n}),this},setRotation:function(t){return!this.viewer||!this.viewer.drawer.canRotate()?this:(this.degrees=e.positiveModulo(t,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:t}),this)},getRotation:function(){return this.degrees},resize:function(t,i){var n=this.getBoundsNoRotate(),r=n,o;return this.containerSize.x=t.x,this.containerSize.y=t.y,this._updateContainerInnerSize(),i&&(o=t.x/this.containerSize.x,r.width=n.width*o,r.height=r.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:t,maintain:i}),this.fitBounds(r,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new e.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var t=this;this._adjustCenterSpringsForZoomPoint(function(){t.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var i=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,i},_adjustCenterSpringsForZoomPoint:function(t){if(this.zoomPoint){var i=this.pixelFromPoint(this.zoomPoint,!0);t();var n=this.pixelFromPoint(this.zoomPoint,!0),r=n.minus(i),o=this.deltaPointsFromPixels(r,!0);this.centerSpringX.shiftBy(o.x),this.centerSpringY.shiftBy(o.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else t()},deltaPixelsFromPointsNoRotate:function(t,i){return t.times(this._containerInnerSize.x*this.getZoom(i))},deltaPixelsFromPoints:function(t,i){return this.deltaPixelsFromPointsNoRotate(t.rotate(this.getRotation()),i)},deltaPointsFromPixelsNoRotate:function(t,i){return t.divide(this._containerInnerSize.x*this.getZoom(i))},deltaPointsFromPixels:function(t,i){return this.deltaPointsFromPixelsNoRotate(t,i).rotate(-this.getRotation())},pixelFromPointNoRotate:function(t,i){return this._pixelFromPointNoRotate(t,this.getBoundsNoRotate(i))},pixelFromPoint:function(t,i){return this._pixelFromPoint(t,this.getBoundsNoRotate(i))},_pixelFromPointNoRotate:function(t,i){return t.minus(i.getTopLeft()).times(this._containerInnerSize.x/i.width).plus(new e.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(t,i){return this._pixelFromPointNoRotate(t.rotate(this.getRotation(),this.getCenter(!0)),i)},pointFromPixelNoRotate:function(t,i){var n=this.getBoundsNoRotate(i);return t.minus(new e.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/n.width).plus(n.getTopLeft())},pointFromPixel:function(t,i){return this.pointFromPixelNoRotate(t,i).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(t,i){var n=this._contentBoundsNoRotate.width;return new e.Point(t*this._contentSizeNoRotate.x/n,i*this._contentSizeNoRotate.x/n)},viewportToImageCoordinates:function(t,i){if(t instanceof e.Point)return this.viewportToImageCoordinates(t.x,t.y);if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)e.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(n===1){var r=this.viewer.world.getItemAt(0);return r.viewportToImageCoordinates(t,i,!0)}}return this._viewportToImageDelta(t-this._contentBoundsNoRotate.x,i-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(t,i){var n=this._contentBoundsNoRotate.width;return new e.Point(t/this._contentSizeNoRotate.x*n,i/this._contentSizeNoRotate.x*n)},imageToViewportCoordinates:function(t,i){if(t instanceof e.Point)return this.imageToViewportCoordinates(t.x,t.y);if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)e.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(n===1){var r=this.viewer.world.getItemAt(0);return r.imageToViewportCoordinates(t,i,!0)}}var o=this._imageToViewportDelta(t,i);return o.x+=this._contentBoundsNoRotate.x,o.y+=this._contentBoundsNoRotate.y,o},imageToViewportRectangle:function(t,i,n,r){var o=t;if(o instanceof e.Rect||(o=new e.Rect(t,i,n,r)),this.viewer){var s=this.viewer.world.getItemCount();if(s>1)e.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(s===1){var a=this.viewer.world.getItemAt(0);return a.imageToViewportRectangle(t,i,n,r,!0)}}var l=this.imageToViewportCoordinates(o.x,o.y),c=this._imageToViewportDelta(o.width,o.height);return new e.Rect(l.x,l.y,c.x,c.y,o.degrees)},viewportToImageRectangle:function(t,i,n,r){var o=t;if(o instanceof e.Rect||(o=new e.Rect(t,i,n,r)),this.viewer){var s=this.viewer.world.getItemCount();if(s>1)e.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(s===1){var a=this.viewer.world.getItemAt(0);return a.viewportToImageRectangle(t,i,n,r,!0)}}var l=this.viewportToImageCoordinates(o.x,o.y),c=this._viewportToImageDelta(o.width,o.height);return new e.Rect(l.x,l.y,c.x,c.y,o.degrees)},viewerElementToImageCoordinates:function(t){var i=this.pointFromPixel(t,!0);return this.viewportToImageCoordinates(i)},imageToViewerElementCoordinates:function(t){var i=this.imageToViewportCoordinates(t);return this.pixelFromPoint(i,!0)},windowToImageCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var i=t.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(i)},imageToWindowCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var i=this.imageToViewerElementCoordinates(t);return i.plus(e.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(t){return this.pointFromPixel(t,!0)},viewportToViewerElementCoordinates:function(t){return this.pixelFromPoint(t,!0)},viewerElementToViewportRectangle:function(t){return e.Rect.fromSummits(this.pointFromPixel(t.getTopLeft(),!0),this.pointFromPixel(t.getTopRight(),!0),this.pointFromPixel(t.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(t){return e.Rect.fromSummits(this.pixelFromPoint(t.getTopLeft(),!0),this.pixelFromPoint(t.getTopRight(),!0),this.pixelFromPoint(t.getBottomLeft(),!0))},windowToViewportCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var i=t.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(i)},viewportToWindowCoordinates:function(t){e.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var i=this.viewportToViewerElementCoordinates(t);return i.plus(e.getElementPosition(this.viewer.element))},viewportToImageZoom:function(t){if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)e.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(i===1){var n=this.viewer.world.getItemAt(0);return n.viewportToImageZoom(t)}}var r=this._contentSizeNoRotate.x,o=this._containerInnerSize.x,s=this._contentBoundsNoRotate.width,a=o/r*s;return t*a},imageToViewportZoom:function(t){if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)e.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(i===1){var n=this.viewer.world.getItemAt(0);return n.imageToViewportZoom(t)}}var r=this._contentSizeNoRotate.x,o=this._containerInnerSize.x,s=this._contentBoundsNoRotate.width,a=r/o/s;return t*a},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(t){return this.flipped===t?this:(this.flipped=t,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:t}),this)}}}(OpenSeadragon),function(e){e.TiledImage=function(u){var m=this;e.console.assert(u.tileCache,"[TiledImage] options.tileCache is required"),e.console.assert(u.drawer,"[TiledImage] options.drawer is required"),e.console.assert(u.viewer,"[TiledImage] options.viewer is required"),e.console.assert(u.imageLoader,"[TiledImage] options.imageLoader is required"),e.console.assert(u.source,"[TiledImage] options.source is required"),e.console.assert(!u.clip||u.clip instanceof e.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),e.EventSource.call(this),this._tileCache=u.tileCache,delete u.tileCache,this._drawer=u.drawer,delete u.drawer,this._imageLoader=u.imageLoader,delete u.imageLoader,u.clip instanceof e.Rect&&(this._clip=u.clip.clone()),delete u.clip;var S=u.x||0;delete u.x;var x=u.y||0;delete u.y,this.normHeight=u.source.dimensions.y/u.source.dimensions.x,this.contentAspectX=u.source.dimensions.x/u.source.dimensions.y;var D=1;u.width?(D=u.width,delete u.width,u.height&&(e.console.error("specifying both width and height to a tiledImage is not supported"),delete u.height)):u.height&&(D=u.height/this.normHeight,delete u.height);var I=u.fitBounds;delete u.fitBounds;var M=u.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete u.fitBoundsPlacement;var R=u.degrees||0;delete u.degrees,e.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:e.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:e.DEFAULT_SETTINGS.iOSDevice,debugMode:e.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:e.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:e.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:e.DEFAULT_SETTINGS.placeholderFillStyle,opacity:e.DEFAULT_SETTINGS.opacity,preload:e.DEFAULT_SETTINGS.preload,compositeOperation:e.DEFAULT_SETTINGS.compositeOperation},u),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new e.Spring({initial:S,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new e.Spring({initial:x,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new e.Spring({initial:D,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new e.Spring({initial:R,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),I&&this.fitBounds(I,M,!0),this._drawingHandler=function(L){m.viewer.raiseEvent("tile-drawing",e.extend({tiledImage:m},L))}},e.extend(e.TiledImage.prototype,e.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(u){u!==this._fullyLoaded&&(this._fullyLoaded=u,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=e.now(),this._needsDraw=!0},update:function(){var u=this._xSpring.update(),m=this._ySpring.update(),S=this._scaleSpring.update(),x=this._degreesSpring.update();return u||m||S||x?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(u){return this.getBoundsNoRotate(u).rotate(this.getRotation(u),this._getRotationPoint(u))},getBoundsNoRotate:function(u){return u?new e.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new e.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return e.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(u){var m=this.getBoundsNoRotate(u);if(this._clip){var S=u?this._worldWidthCurrent:this._worldWidthTarget,x=S/this.source.dimensions.x,D=this._clip.times(x);m=new e.Rect(m.x+D.x,m.y+D.y,D.width,D.height)}return m.rotate(this.getRotation(u),this._getRotationPoint(u))},getContentSize:function(){return new e.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(u,m,S){var x=S?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(u*(this.source.dimensions.x/x),m*(this.source.dimensions.y*this.contentAspectX/x))},viewportToImageCoordinates:function(u,m,S){var x;return u instanceof e.Point?(S=m,x=u):x=new e.Point(u,m),x=x.rotate(-this.getRotation(S),this._getRotationPoint(S)),S?this._viewportToImageDelta(x.x-this._xSpring.current.value,x.y-this._ySpring.current.value):this._viewportToImageDelta(x.x-this._xSpring.target.value,x.y-this._ySpring.target.value)},_imageToViewportDelta:function(u,m,S){var x=S?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(u/this.source.dimensions.x*x,m/this.source.dimensions.y/this.contentAspectX*x)},imageToViewportCoordinates:function(u,m,S){u instanceof e.Point&&(S=m,m=u.y,u=u.x);var x=this._imageToViewportDelta(u,m);return S?(x.x+=this._xSpring.current.value,x.y+=this._ySpring.current.value):(x.x+=this._xSpring.target.value,x.y+=this._ySpring.target.value),x.rotate(this.getRotation(S),this._getRotationPoint(S))},imageToViewportRectangle:function(u,m,S,x,D){var I=u;I instanceof e.Rect?D=m:I=new e.Rect(u,m,S,x);var M=this.imageToViewportCoordinates(I.getTopLeft(),D),R=this._imageToViewportDelta(I.width,I.height,D);return new e.Rect(M.x,M.y,R.x,R.y,I.degrees+this.getRotation(D))},viewportToImageRectangle:function(u,m,S,x,D){var I=u;u instanceof e.Rect?D=m:I=new e.Rect(u,m,S,x);var M=this.viewportToImageCoordinates(I.getTopLeft(),D),R=this._viewportToImageDelta(I.width,I.height,D);return new e.Rect(M.x,M.y,R.x,R.y,I.degrees-this.getRotation(D))},viewerElementToImageCoordinates:function(u){var m=this.viewport.pointFromPixel(u,!0);return this.viewportToImageCoordinates(m)},imageToViewerElementCoordinates:function(u){var m=this.imageToViewportCoordinates(u);return this.viewport.pixelFromPoint(m,!0)},windowToImageCoordinates:function(u){var m=u.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(m)},imageToWindowCoordinates:function(u){var m=this.imageToViewerElementCoordinates(u);return m.plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(u){var m=this._scaleSpring.current.value;return u=u.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new e.Rect((u.x-this._xSpring.current.value)/m,(u.y-this._ySpring.current.value)/m,u.width/m,u.height/m,u.degrees)},viewportToImageZoom:function(u){var m=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return m*u},imageToViewportZoom:function(u){var m=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return u/m},setPosition:function(u,m){var S=this._xSpring.target.value===u.x&&this._ySpring.target.value===u.y;if(m){if(S&&this._xSpring.current.value===u.x&&this._ySpring.current.value===u.y)return;this._xSpring.resetTo(u.x),this._ySpring.resetTo(u.y),this._needsDraw=!0}else{if(S)return;this._xSpring.springTo(u.x),this._ySpring.springTo(u.y),this._needsDraw=!0}S||this._raiseBoundsChange()},setWidth:function(u,m){this._setScale(u,m)},setHeight:function(u,m){this._setScale(u/this.normHeight,m)},setCroppingPolygons:function(u){var m=function(x){return x instanceof e.Point||typeof x.x=="number"&&typeof x.y=="number"},S=function(x){return x.map(function(D){try{if(m(D))return{x:D.x,y:D.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!e.isArray(u))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=u.map(function(x){return S(x)})}catch(x){e.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),e.console.error(x),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(u,m,S){m=m||e.Placement.CENTER;var x=e.Placement.properties[m],D=this.contentAspectX,I=0,M=0,R=1,L=1;if(this._clip&&(D=this._clip.getAspectRatio(),R=this._clip.width/this.source.dimensions.x,L=this._clip.height/this.source.dimensions.y,u.getAspectRatio()>D?(I=this._clip.x/this._clip.height*u.height,M=this._clip.y/this._clip.height*u.height):(I=this._clip.x/this._clip.width*u.width,M=this._clip.y/this._clip.width*u.width)),u.getAspectRatio()>D){var G=u.height/L,U=0;x.isHorizontallyCentered?U=(u.width-u.height*D)/2:x.isRight&&(U=u.width-u.height*D),this.setPosition(new e.Point(u.x-I+U,u.y-M),S),this.setHeight(G,S)}else{var k=u.width/R,J=0;x.isVerticallyCentered?J=(u.height-u.width/D)/2:x.isBottom&&(J=u.height-u.width/D),this.setPosition(new e.Point(u.x-I,u.y-M+J),S),this.setWidth(k,S)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(u){e.console.assert(!u||u instanceof e.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),u instanceof e.Rect?this._clip=u.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(u){u!==this.opacity&&(this.opacity=u,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(u){this._preload=!!u,this._needsDraw=!0},getRotation:function(u){return u?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(u,m){this._degreesSpring.target.value===u&&this._degreesSpring.isAtTargetValue()||(m?this._degreesSpring.resetTo(u):this._degreesSpring.springTo(u),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(u){return this.getBoundsNoRotate(u).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(u){u!==this.compositeOperation&&(this.compositeOperation=u,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(u,m){var S=this._scaleSpring.target.value===u;if(m){if(S&&this._scaleSpring.current.value===u)return;this._scaleSpring.resetTo(u),this._updateForScale(),this._needsDraw=!0}else{if(S)return;this._scaleSpring.springTo(u),this._updateForScale(),this._needsDraw=!0}S||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var u=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),m=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,S=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(m/this.minPixelRatio)/Math.log(2))));return S=Math.max(S,this.source.minLevel||0),u=Math.min(u,S),{lowestLevel:u,highestLevel:S}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var u=this.lastDrawn.pop();u.beingDrawn=!1}var m=this.viewport,S=this._viewportToTiledImageRectangle(m.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var x=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(S=S.intersection(x),S===null)return}for(var D=this._getLevelsInterval(),I=D.lowestLevel,M=D.highestLevel,R=null,L=!1,G=e.now(),U=M;U>=I;U--){var k=!1,J=m.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(U),!0).x*this._scaleSpring.current.value;if(U===I||!L&&J>=this.minPixelRatio)k=!0,L=!0;else if(!L)continue;var te=m.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(U),!1).x*this._scaleSpring.current.value,ce=m.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,fe=this.immediateRender?1:ce,he=Math.min(1,(J-.5)/.5),Y=fe/Math.abs(fe-te);if(R=t(this,L,k,U,he,Y,S,G,R),c(this.coverage,U))break}E(this,this.lastDrawn),R&&!R.context2D?(r(this,R,G),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(u,m,S){var x,D;this.wrapHorizontal?(x=e.positiveModulo(m.x,1),D=e.positiveModulo(S.x,1)):(x=Math.max(0,m.x),D=Math.min(1,S.x));var I,M,R=1/this.source.aspectRatio;this.wrapVertical?(I=e.positiveModulo(m.y,R),M=e.positiveModulo(S.y,R)):(I=Math.max(0,m.y),M=Math.min(R,S.y));var L=this.source.getTileAtPoint(u,new e.Point(x,I)),G=this.source.getTileAtPoint(u,new e.Point(D,M)),U=this.source.getNumTiles(u);return this.wrapHorizontal&&(L.x+=U.x*Math.floor(m.x),G.x+=U.x*Math.floor(S.x)),this.wrapVertical&&(L.y+=U.y*Math.floor(m.y/R),G.y+=U.y*Math.floor(S.y/R)),{topLeft:L,bottomRight:G}}});function t(u,m,S,x,D,I,M,R,L){var G=M.getBoundingBox().getTopLeft(),U=M.getBoundingBox().getBottomRight();u.viewer&&u.viewer.raiseEvent("update-level",{tiledImage:u,havedrawn:m,level:x,opacity:D,visibility:I,drawArea:M,topleft:G,bottomright:U,currenttime:R,best:L}),p(u.coverage,x),p(u.loadingCoverage,x);for(var k=u._getCornerTiles(x,G,U),J=k.topLeft,te=k.bottomRight,ce=u.source.getNumTiles(x),fe=u.viewport.pixelFromPoint(u.viewport.getCenter()),he=J.x;he<=te.x;he++)for(var Y=J.y;Y<=te.y;Y++){if(!u.wrapHorizontal&&!u.wrapVertical){var we=u.source.getTileBounds(x,he,Y);if(M.intersection(we)===null)continue}L=i(u,S,m,he,Y,x,D,I,fe,ce,R,L)}return L}function i(u,m,S,x,D,I,M,R,L,G,U,k){var J=n(x,D,I,u,u.source,u.tilesMatrix,U,G,u._worldWidthCurrent,u._worldHeightCurrent),te=S;u.viewer&&u.viewer.raiseEvent("update-tile",{tiledImage:u,tile:J}),v(u.coverage,I,x,D,!1);var ce=J.loaded||J.loading||g(u.loadingCoverage,I,x,D);if(v(u.loadingCoverage,I,x,D,ce),!J.exists||(m&&!te&&(g(u.coverage,I,x,D)?v(u.coverage,I,x,D,!0):te=!0),!te))return k;if(a(J,u.source.tileOverlap,u.viewport,L,R,u),!J.loaded)if(J.context2D)s(u,J);else{var fe=u._tileCache.getImageRecord(J.cacheKey);if(fe){var he=fe.getImage();s(u,J,he)}}if(J.loaded){var Y=l(u,J,x,D,I,M,U);Y&&(u._needsDraw=!0)}else J.loading?u._tilesLoading++:ce||(k=w(k,J));return k}function n(u,m,S,x,D,I,M,R,L,G){var U,k,J,te,ce,fe,he,Y,we;return I[S]||(I[S]={}),I[S][u]||(I[S][u]={}),I[S][u][m]||(U=(R.x+u%R.x)%R.x,k=(R.y+m%R.y)%R.y,J=D.getTileBounds(S,U,k),te=D.getTileBounds(S,U,k,!0),ce=D.tileExists(S,U,k),fe=D.getTileUrl(S,U,k),x.loadTilesWithAjax?(he=D.getTileAjaxHeaders(S,U,k),e.isPlainObject(x.ajaxHeaders)&&(he=e.extend({},x.ajaxHeaders,he))):he=null,Y=D.getContext2D?D.getContext2D(S,U,k):void 0,J.x+=(u-U)/R.x,J.y+=G/L*((m-k)/R.y),we=new e.Tile(S,u,m,J,ce,fe,Y,x.loadTilesWithAjax,he,te),U===R.x-1&&(we.isRightMost=!0),k===R.y-1&&(we.isBottomMost=!0),I[S][u][m]=we),we=I[S][u][m],we.lastTouchTime=M,we}function r(u,m,S){m.loading=!0,u._imageLoader.addJob({src:m.url,loadWithAjax:m.loadWithAjax,ajaxHeaders:m.ajaxHeaders,crossOriginPolicy:u.crossOriginPolicy,ajaxWithCredentials:u.ajaxWithCredentials,callback:function(x,D,I){o(u,m,S,x,D,I)},abort:function(){m.loading=!1}})}function o(u,m,S,x,D,I){if(!x){e.console.log("Tile %s failed to load: %s - error: %s",m,m.url,D),u.viewer.raiseEvent("tile-load-failed",{tile:m,tiledImage:u,time:S,message:D,tileRequest:I}),m.loading=!1,m.exists=!1;return}if(S<u.lastResetTime){e.console.log("Ignoring tile %s loaded before reset: %s",m,m.url),m.loading=!1;return}var M=function(){var R=u.source.getClosestLevel();s(u,m,x,R,I)};u._midDraw?window.setTimeout(M,1):M()}function s(u,m,S,x,D){var I=0;function M(){return I++,R}function R(){I--,I===0&&(m.loading=!1,m.loaded=!0,m.context2D||u._tileCache.cacheTile({image:S,tile:m,cutoff:x,tiledImage:u}),u._needsDraw=!0)}u.viewer.raiseEvent("tile-loaded",{tile:m,tiledImage:u,tileRequest:D,image:S,getCompletionCallback:M}),M()()}function a(u,m,S,x,D,I){var M=u.bounds.getTopLeft();M.x*=I._scaleSpring.current.value,M.y*=I._scaleSpring.current.value,M.x+=I._xSpring.current.value,M.y+=I._ySpring.current.value;var R=u.bounds.getSize();R.x*=I._scaleSpring.current.value,R.y*=I._scaleSpring.current.value;var L=S.pixelFromPointNoRotate(M,!0),G=S.pixelFromPointNoRotate(M,!1),U=S.deltaPixelsFromPointsNoRotate(R,!0),k=S.deltaPixelsFromPointsNoRotate(R,!1),J=G.plus(k.divide(2)),te=x.squaredDistanceTo(J);m||(U=U.plus(new e.Point(1,1))),u.isRightMost&&I.wrapHorizontal&&(U.x+=.75),u.isBottomMost&&I.wrapVertical&&(U.y+=.75),u.position=L,u.size=U,u.squaredDistance=te,u.visibility=D}function l(u,m,S,x,D,I,M){var R=1e3*u.blendTime,L,G;if(m.blendStart||(m.blendStart=M),L=M-m.blendStart,G=R?Math.min(1,L/R):1,u.alwaysBlend&&(G*=I),m.opacity=G,u.lastDrawn.push(m),G===1)v(u.coverage,D,S,x,!0),u._hasOpaqueTile=!0;else if(L<R)return!0;return!1}function c(u,m,S,x){var D,I,M,R;if(!u[m])return!1;if(S===void 0||x===void 0){D=u[m];for(M in D)if(Object.prototype.hasOwnProperty.call(D,M)){I=D[M];for(R in I)if(Object.prototype.hasOwnProperty.call(I,R)&&!I[R])return!1}return!0}return u[m][S]===void 0||u[m][S][x]===void 0||u[m][S][x]===!0}function g(u,m,S,x){return S===void 0||x===void 0?c(u,m+1):c(u,m+1,2*S,2*x)&&c(u,m+1,2*S,2*x+1)&&c(u,m+1,2*S+1,2*x)&&c(u,m+1,2*S+1,2*x+1)}function v(u,m,S,x,D){if(!u[m]){e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",m);return}u[m][S]||(u[m][S]={}),u[m][S][x]=D}function p(u,m){u[m]={}}function w(u,m){return!u||m.visibility>u.visibility||m.visibility==u.visibility&&m.squaredDistance<u.squaredDistance?m:u}function E(u,m){if(!(u.opacity===0||m.length===0&&!u.placeholderFillStyle)){var S=m[0],x;S&&(x=u.opacity<1||u.compositeOperation&&u.compositeOperation!=="source-over"||!u._isBottomItem()&&S._hasTransparencyChannel());var D,I,M=u.viewport.getZoom(!0),R=u.viewportToImageZoom(M);m.length>1&&R>u.smoothTileEdgesMinZoom&&!u.iOSDevice&&u.getRotation(!0)%360==0&&e.supportsCanvas&&(x=!0,D=S.getScaleForEdgeSmoothing(),I=S.getTranslationForEdgeSmoothing(D,u._drawer.getCanvasSize(!1),u._drawer.getCanvasSize(!0)));var L;x&&(D||(L=u.viewport.viewportToViewerElementRectangle(u.getClippedBounds(!0)).getIntegerBoundingBox(),u._drawer.viewer.viewport.getFlip()&&(u.viewport.degrees!==0||u.getRotation(!0)%360!=0)&&(L.x=u._drawer.viewer.container.clientWidth-(L.x+L.width)),L=L.times(e.pixelDensityRatio)),u._drawer._clear(!0,L)),D||(u.viewport.degrees!==0&&u._drawer._offsetForRotation({degrees:u.viewport.degrees,useSketch:x}),u.getRotation(!0)%360!=0&&u._drawer._offsetForRotation({degrees:u.getRotation(!0),point:u.viewport.pixelFromPointNoRotate(u._getRotationPoint(!0),!0),useSketch:x}),u.viewport.degrees===0&&u.getRotation(!0)%360==0&&u._drawer.viewer.viewport.getFlip()&&u._drawer._flip());var G=!1;if(u._clip){u._drawer.saveContext(x);var U=u.imageToViewportRectangle(u._clip,!0);U=U.rotate(-u.getRotation(!0),u._getRotationPoint(!0));var k=u._drawer.viewportToDrawerRectangle(U);D&&(k=k.times(D)),I&&(k=k.translate(I)),u._drawer.setClip(k,x),G=!0}if(u._croppingPolygons){u._drawer.saveContext(x);try{var J=u._croppingPolygons.map(function(he){return he.map(function(Y){var we=u.imageToViewportCoordinates(Y.x,Y.y,!0).rotate(-u.getRotation(!0),u._getRotationPoint(!0)),Ee=u._drawer.viewportCoordToDrawerCoord(we);return D&&(Ee=Ee.times(D)),Ee})});u._drawer.clipWithPolygons(J,x)}catch(he){e.console.error(he)}G=!0}if(u.placeholderFillStyle&&u._hasOpaqueTile===!1){var te=u._drawer.viewportToDrawerRectangle(u.getBounds(!0));D&&(te=te.times(D)),I&&(te=te.translate(I));var ce=null;typeof u.placeholderFillStyle=="function"?ce=u.placeholderFillStyle(u,u._drawer.context):ce=u.placeholderFillStyle,u._drawer.drawRectangle(te,ce,x)}for(var fe=m.length-1;fe>=0;fe--)S=m[fe],u._drawer.drawTile(S,u._drawingHandler,x,D,I),S.beingDrawn=!0,u.viewer&&u.viewer.raiseEvent("tile-drawn",{tiledImage:u,tile:S});G&&u._drawer.restoreContext(x),D||(u.getRotation(!0)%360!=0&&u._drawer._restoreRotationChanges(x),u.viewport.degrees!==0&&u._drawer._restoreRotationChanges(x)),x&&(D&&(u.viewport.degrees!==0&&u._drawer._offsetForRotation({degrees:u.viewport.degrees,useSketch:!1}),u.getRotation(!0)%360!=0&&u._drawer._offsetForRotation({degrees:u.getRotation(!0),point:u.viewport.pixelFromPointNoRotate(u._getRotationPoint(!0),!0),useSketch:!1})),u._drawer.blendSketch({opacity:u.opacity,scale:D,translate:I,compositeOperation:u.compositeOperation,bounds:L}),D&&(u.getRotation(!0)%360!=0&&u._drawer._restoreRotationChanges(!1),u.viewport.degrees!==0&&u._drawer._restoreRotationChanges(!1))),D||u.viewport.degrees===0&&u.getRotation(!0)%360==0&&u._drawer.viewer.viewport.getFlip()&&u._drawer._flip(),b(u,m)}}function b(u,m){if(u.debugMode)for(var S=m.length-1;S>=0;S--){var x=m[S];try{u._drawer.drawDebugInfo(x,m.length,S,u)}catch(D){e.console.error(D)}}}}(OpenSeadragon),function(e){var t=function(n){e.console.assert(n,"[TileCache.cacheTile] options is required"),e.console.assert(n.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(n.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=n.tile,this.tiledImage=n.tiledImage},i=function(n){e.console.assert(n,"[ImageRecord] options is required"),e.console.assert(n.image,"[ImageRecord] options.image is required"),this._image=n.image,this._tiles=[]};i.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var n=document.createElement("canvas");n.width=this._image.width,n.height=this._image.height,this._renderedContext=n.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(n){e.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=n},addTile:function(n){e.console.assert(n,"[ImageRecord.addTile] tile is required"),this._tiles.push(n)},removeTile:function(n){for(var r=0;r<this._tiles.length;r++)if(this._tiles[r]===n){this._tiles.splice(r,1);return}e.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",n)},getTileCount:function(){return this._tiles.length}},e.TileCache=function(n){n=n||{},this._maxImageCacheCount=n.maxImageCacheCount||e.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},e.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(n){e.console.assert(n,"[TileCache.cacheTile] options is required"),e.console.assert(n.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(n.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),e.console.assert(n.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var r=n.cutoff||0,o=this._tilesLoaded.length,s=this._imagesLoaded[n.tile.cacheKey];if(s||(e.console.assert(n.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),s=this._imagesLoaded[n.tile.cacheKey]=new i({image:n.image}),this._imagesLoadedCount++),s.addTile(n.tile),n.tile.cacheImageRecord=s,this._imagesLoadedCount>this._maxImageCacheCount){for(var a=null,l=-1,c=null,g,v,p,w,E,b,u=this._tilesLoaded.length-1;u>=0;u--)if(b=this._tilesLoaded[u],g=b.tile,!(g.level<=r||g.beingDrawn)){if(!a){a=g,l=u,c=b;continue}w=g.lastTouchTime,v=a.lastTouchTime,E=g.level,p=a.level,(w<v||w==v&&E>p)&&(a=g,l=u,c=b)}a&&l>=0&&(this._unloadTile(c),o=l)}this._tilesLoaded[o]=new t({tile:n.tile,tiledImage:n.tiledImage})},clearTilesFor:function(n){e.console.assert(n,"[TileCache.clearTilesFor] tiledImage is required");for(var r,o=0;o<this._tilesLoaded.length;++o)r=this._tilesLoaded[o],r.tiledImage===n&&(this._unloadTile(r),this._tilesLoaded.splice(o,1),o--)},getImageRecord:function(n){return e.console.assert(n,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[n]},_unloadTile:function(n){e.console.assert(n,"[TileCache._unloadTile] tileRecord is required");var r=n.tile,o=n.tiledImage;r.unload(),r.cacheImageRecord=null;var s=this._imagesLoaded[r.cacheKey];s.removeTile(r),s.getTileCount()||(s.destroy(),delete this._imagesLoaded[r.cacheKey],this._imagesLoadedCount--),o.viewer.raiseEvent("tile-unloaded",{tile:r,tiledImage:o})}}}(OpenSeadragon),function(e){e.World=function(t){var i=this;e.console.assert(t.viewer,"[World] options.viewer is required"),e.EventSource.call(this),this.viewer=t.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(n){i._autoRefigureSizes?i._figureSizes():i._needsSizesFigured=!0},this._figureSizes()},e.extend(e.World.prototype,e.EventSource.prototype,{addItem:function(t,i){if(e.console.assert(t,"[World.addItem] item is required"),e.console.assert(t instanceof e.TiledImage,"[World.addItem] only TiledImages supported at this time"),i=i||{},i.index!==void 0){var n=Math.max(0,Math.min(this._items.length,i.index));this._items.splice(n,0,t)}else this._items.push(t);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,t.addHandler("bounds-change",this._delegatedFigureSizes),t.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:t})},getItemAt:function(t){return e.console.assert(t!==void 0,"[World.getItemAt] index is required"),this._items[t]},getIndexOfItem:function(t){return e.console.assert(t,"[World.getIndexOfItem] item is required"),e.indexOf(this._items,t)},getItemCount:function(){return this._items.length},setItemIndex:function(t,i){e.console.assert(t,"[World.setItemIndex] item is required"),e.console.assert(i!==void 0,"[World.setItemIndex] index is required");var n=this.getIndexOfItem(t);if(i>=this._items.length)throw new Error("Index bigger than number of layers.");i===n||n===-1||(this._items.splice(n,1),this._items.splice(i,0,t),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:t,previousIndex:n,newIndex:i}))},removeItem:function(t){e.console.assert(t,"[World.removeItem] item is required");var i=e.indexOf(this._items,t);i!==-1&&(t.removeHandler("bounds-change",this._delegatedFigureSizes),t.removeHandler("clip-change",this._delegatedFigureSizes),t.destroy(),this._items.splice(i,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(t))},removeAll:function(){this.viewer._cancelPendingImages();var t,i;for(i=0;i<this._items.length;i++)t=this._items[i],t.removeHandler("bounds-change",this._delegatedFigureSizes),t.removeHandler("clip-change",this._delegatedFigureSizes),t.destroy();var n=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,i=0;i<n.length;i++)t=n[i],this._raiseRemoveItem(t)},resetItems:function(){for(var t=0;t<this._items.length;t++)this._items[t].reset()},update:function(){for(var t=!1,i=0;i<this._items.length;i++)t=this._items[i].update()||t;return t},draw:function(){for(var t=0;t<this._items.length;t++)this._items[t].draw();this._needsDraw=!1},needsDraw:function(){for(var t=0;t<this._items.length;t++)if(this._items[t].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(t){this._autoRefigureSizes=t,t&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(t){t=t||{};var i=t.immediately||!1,n=t.layout||e.DEFAULT_SETTINGS.collectionLayout,r=t.rows||e.DEFAULT_SETTINGS.collectionRows,o=t.columns||e.DEFAULT_SETTINGS.collectionColumns,s=t.tileSize||e.DEFAULT_SETTINGS.collectionTileSize,a=t.tileMargin||e.DEFAULT_SETTINGS.collectionTileMargin,l=s+a,c;!t.rows&&o?c=o:c=Math.ceil(this._items.length/r);var g=0,v=0,p,w,E,b,u;this.setAutoRefigureSizes(!1);for(var m=0;m<this._items.length;m++)m&&m%c==0&&(n==="horizontal"?(v+=l,g=0):(g+=l,v=0)),p=this._items[m],w=p.getBounds(),w.width>w.height?E=s:E=s*(w.width/w.height),b=E*(w.height/w.width),u=new e.Point(g+(s-E)/2,v+(s-b)/2),p.setPosition(u,i),p.setWidth(E,i),n==="horizontal"?g+=l:v+=l;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var t=this._homeBounds?this._homeBounds.clone():null,i=this._contentSize?this._contentSize.clone():null,n=this._contentFactor||0;if(!this._items.length)this._homeBounds=new e.Rect(0,0,1,1),this._contentSize=new e.Point(1,1),this._contentFactor=1;else{var r=this._items[0],o=r.getBounds();this._contentFactor=r.getContentSize().x/o.width;for(var s=r.getClippedBounds().getBoundingBox(),a=s.x,l=s.y,c=s.x+s.width,g=s.y+s.height,v=1;v<this._items.length;v++)r=this._items[v],o=r.getBounds(),this._contentFactor=Math.max(this._contentFactor,r.getContentSize().x/o.width),s=r.getClippedBounds().getBoundingBox(),a=Math.min(a,s.x),l=Math.min(l,s.y),c=Math.max(c,s.x+s.width),g=Math.max(g,s.y+s.height);this._homeBounds=new e.Rect(a,l,c-a,g-l),this._contentSize=new e.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==n||!this._homeBounds.equals(t)||!this._contentSize.equals(i))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(t){this.raiseEvent("remove-item",{item:t})}})}(OpenSeadragon)})(openseadragon);var OpenSeadragon=openseadragon.exports;const FINALIZE_EVENT_NAME="finalize",CONSIDER_EVENT_NAME="consider";function dispatchFinalizeEvent(e,t,i){e.dispatchEvent(new CustomEvent(FINALIZE_EVENT_NAME,{detail:{items:t,info:i}}))}function dispatchConsiderEvent(e,t,i){e.dispatchEvent(new CustomEvent(CONSIDER_EVENT_NAME,{detail:{items:t,info:i}}))}const DRAGGED_ENTERED_EVENT_NAME="draggedEntered",DRAGGED_LEFT_EVENT_NAME="draggedLeft",DRAGGED_OVER_INDEX_EVENT_NAME="draggedOverIndex",DRAGGED_LEFT_DOCUMENT_EVENT_NAME="draggedLeftDocument",DRAGGED_LEFT_TYPES={LEFT_FOR_ANOTHER:"leftForAnother",OUTSIDE_OF_ANY:"outsideOfAny"};function dispatchDraggedElementEnteredContainer(e,t,i){e.dispatchEvent(new CustomEvent(DRAGGED_ENTERED_EVENT_NAME,{detail:{indexObj:t,draggedEl:i}}))}function dispatchDraggedElementLeftContainerForAnother(e,t,i){e.dispatchEvent(new CustomEvent(DRAGGED_LEFT_EVENT_NAME,{detail:{draggedEl:t,type:DRAGGED_LEFT_TYPES.LEFT_FOR_ANOTHER,theOtherDz:i}}))}function dispatchDraggedElementLeftContainerForNone(e,t){e.dispatchEvent(new CustomEvent(DRAGGED_LEFT_EVENT_NAME,{detail:{draggedEl:t,type:DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY}}))}function dispatchDraggedElementIsOverIndex(e,t,i){e.dispatchEvent(new CustomEvent(DRAGGED_OVER_INDEX_EVENT_NAME,{detail:{indexObj:t,draggedEl:i}}))}function dispatchDraggedLeftDocument(e){window.dispatchEvent(new CustomEvent(DRAGGED_LEFT_DOCUMENT_EVENT_NAME,{detail:{draggedEl:e}}))}const TRIGGERS={DRAG_STARTED:"dragStarted",DRAGGED_ENTERED:DRAGGED_ENTERED_EVENT_NAME,DRAGGED_ENTERED_ANOTHER:"dragEnteredAnother",DRAGGED_OVER_INDEX:DRAGGED_OVER_INDEX_EVENT_NAME,DRAGGED_LEFT:DRAGGED_LEFT_EVENT_NAME,DRAGGED_LEFT_ALL:"draggedLeftAll",DROPPED_INTO_ZONE:"droppedIntoZone",DROPPED_INTO_ANOTHER:"droppedIntoAnother",DROPPED_OUTSIDE_OF_ANY:"droppedOutsideOfAny",DRAG_STOPPED:"dragStopped"},SOURCES={POINTER:"pointer",KEYBOARD:"keyboard"},SHADOW_ITEM_MARKER_PROPERTY_NAME="isDndShadowItem",SHADOW_ELEMENT_ATTRIBUTE_NAME="data-is-dnd-shadow-item",SHADOW_PLACEHOLDER_ITEM_ID="id:dnd-shadow-placeholder-0000",DRAGGED_ELEMENT_ID="dnd-action-dragged-el";let ITEM_ID_KEY="id",activeDndZoneCount=0;function incrementActiveDropZoneCount(){activeDndZoneCount++}function decrementActiveDropZoneCount(){if(activeDndZoneCount===0)throw new Error("Bug! trying to decrement when there are no dropzones");activeDndZoneCount--}const isOnServer=typeof window=="undefined";function getBoundingRectNoTransforms(e){let t;const i=e.getBoundingClientRect(),n=getComputedStyle(e),r=n.transform;if(r){let o,s,a,l;if(r.startsWith("matrix3d("))t=r.slice(9,-1).split(/, /),o=+t[0],s=+t[5],a=+t[12],l=+t[13];else if(r.startsWith("matrix("))t=r.slice(7,-1).split(/, /),o=+t[0],s=+t[3],a=+t[4],l=+t[5];else return i;const c=n.transformOrigin,g=i.x-a-(1-o)*parseFloat(c),v=i.y-l-(1-s)*parseFloat(c.slice(c.indexOf(" ")+1)),p=o?i.width/o:e.offsetWidth,w=s?i.height/s:e.offsetHeight;return{x:g,y:v,width:p,height:w,top:v,right:g+p,bottom:v+w,left:g}}else return i}function getAbsoluteRectNoTransforms(e){const t=getBoundingRectNoTransforms(e);return{top:t.top+window.scrollY,bottom:t.bottom+window.scrollY,left:t.left+window.scrollX,right:t.right+window.scrollX}}function getAbsoluteRect(e){const t=e.getBoundingClientRect();return{top:t.top+window.scrollY,bottom:t.bottom+window.scrollY,left:t.left+window.scrollX,right:t.right+window.scrollX}}function findCenter(e){return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}function calcDistance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function isPointInsideRect(e,t){return e.y<=t.bottom&&e.y>=t.top&&e.x>=t.left&&e.x<=t.right}function findCenterOfElement(e){return findCenter(getAbsoluteRect(e))}function isCenterOfAInsideB(e,t){const i=findCenterOfElement(e),n=getAbsoluteRectNoTransforms(t);return isPointInsideRect(i,n)}function calcDistanceBetweenCenters(e,t){const i=findCenterOfElement(e),n=findCenterOfElement(t);return calcDistance(i,n)}function isElementOffDocument(e){const t=getAbsoluteRect(e);return t.right<0||t.left>document.documentElement.scrollWidth||t.bottom<0||t.top>document.documentElement.scrollHeight}function calcInnerDistancesBetweenPointAndSidesOfElement(e,t){const i=getAbsoluteRect(t);return isPointInsideRect(e,i)?{top:e.y-i.top,bottom:i.bottom-e.y,left:e.x-i.left,right:Math.min(i.right,document.documentElement.clientWidth)-e.x}:null}let dzToShadowIndexToRect;function resetIndexesCache(){dzToShadowIndexToRect=new Map}resetIndexesCache();function cacheShadowRect(e){const t=Array.from(e.children).findIndex(i=>i.getAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME));if(t>=0)return dzToShadowIndexToRect.has(e)||dzToShadowIndexToRect.set(e,new Map),dzToShadowIndexToRect.get(e).set(t,getAbsoluteRectNoTransforms(e.children[t])),t}function findWouldBeIndex(e,t){if(!isCenterOfAInsideB(e,t))return null;const i=t.children;if(i.length===0)return{index:0,isProximityBased:!0};const n=cacheShadowRect(t);for(let s=0;s<i.length;s++)if(isCenterOfAInsideB(e,i[s])){const a=dzToShadowIndexToRect.has(t)&&dzToShadowIndexToRect.get(t).get(s);return a&&!isPointInsideRect(findCenterOfElement(e),a)?{index:n,isProximityBased:!1}:{index:s,isProximityBased:!1}}let r=Number.MAX_VALUE,o;for(let s=0;s<i.length;s++){const a=calcDistanceBetweenCenters(e,i[s]);a<r&&(r=a,o=s)}return{index:o,isProximityBased:!0}}const SCROLL_ZONE_PX=25;function makeScroller(){let e;function t(){e={directionObj:void 0,stepPx:0}}t();function i(o){const{directionObj:s,stepPx:a}=e;s&&(o.scrollBy(s.x*a,s.y*a),window.requestAnimationFrame(()=>i(o)))}function n(o){return SCROLL_ZONE_PX-o}function r(o,s){if(!s)return!1;const a=calcInnerDistancesBetweenPointAndSidesOfElement(o,s);if(a===null)return t(),!1;const l=!!e.directionObj;let[c,g]=[!1,!1];return s.scrollHeight>s.clientHeight&&(a.bottom<SCROLL_ZONE_PX?(c=!0,e.directionObj={x:0,y:1},e.stepPx=n(a.bottom)):a.top<SCROLL_ZONE_PX&&(c=!0,e.directionObj={x:0,y:-1},e.stepPx=n(a.top)),!l&&c)||s.scrollWidth>s.clientWidth&&(a.right<SCROLL_ZONE_PX?(g=!0,e.directionObj={x:1,y:0},e.stepPx=n(a.right)):a.left<SCROLL_ZONE_PX&&(g=!0,e.directionObj={x:-1,y:0},e.stepPx=n(a.left)),!l&&g)?(i(s),!0):(t(),!1)}return{scrollIfNeeded:r,resetScrolling:t}}function toString(e){return JSON.stringify(e,null,2)}function getDepth(e){if(!e)throw new Error("cannot get depth of a falsy node");return _getDepth(e,0)}function _getDepth(e,t=0){return e.parentElement?_getDepth(e.parentElement,t+1):t-1}function areObjectsShallowEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!{}.hasOwnProperty.call(t,i)||t[i]!==e[i])return!1;return!0}function areArraysShallowEqualSameOrder(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}const INTERVAL_MS$1=200,TOLERANCE_PX=10,{scrollIfNeeded:scrollIfNeeded$1,resetScrolling:resetScrolling$1}=makeScroller();let next$1;function observe(e,t,i=INTERVAL_MS$1){let n,r,o=!1,s;const a=Array.from(t).sort((c,g)=>getDepth(g)-getDepth(c));function l(){const c=findCenterOfElement(e);if(!scrollIfNeeded$1(c,n)&&s&&Math.abs(s.x-c.x)<TOLERANCE_PX&&Math.abs(s.y-c.y)<TOLERANCE_PX){next$1=window.setTimeout(l,i);return}if(isElementOffDocument(e)){dispatchDraggedLeftDocument(e);return}s=c;let v=!1;for(const p of a){const w=findWouldBeIndex(e,p);if(w===null)continue;const{index:E}=w;v=!0,p!==n?(n&&dispatchDraggedElementLeftContainerForAnother(n,e,p),dispatchDraggedElementEnteredContainer(p,w,e),n=p):E!==r&&(dispatchDraggedElementIsOverIndex(p,w,e),r=E);break}!v&&o&&n?(dispatchDraggedElementLeftContainerForNone(n,e),n=void 0,r=void 0,o=!1):o=!0,next$1=window.setTimeout(l,i)}l()}function unobserve(){clearTimeout(next$1),resetScrolling$1(),resetIndexesCache()}const INTERVAL_MS=300;let mousePosition;function updateMousePosition(e){const t=e.touches?e.touches[0]:e;mousePosition={x:t.clientX,y:t.clientY}}const{scrollIfNeeded,resetScrolling}=makeScroller();let next;function loop(){mousePosition&&scrollIfNeeded(mousePosition,document.documentElement),next=window.setTimeout(loop,INTERVAL_MS)}function armWindowScroller(){window.addEventListener("mousemove",updateMousePosition),window.addEventListener("touchmove",updateMousePosition),loop()}function disarmWindowScroller(){window.removeEventListener("mousemove",updateMousePosition),window.removeEventListener("touchmove",updateMousePosition),mousePosition=void 0,window.clearTimeout(next),resetScrolling()}const TRANSITION_DURATION_SECONDS=.2;function trs(e){return`${e} ${TRANSITION_DURATION_SECONDS}s ease`}function createDraggedElementFrom(e,t){const i=e.getBoundingClientRect(),n=e.cloneNode(!0);copyStylesFromTo(e,n),n.id=DRAGGED_ELEMENT_ID,n.style.position="fixed";let r=i.top,o=i.left;if(n.style.top=`${r}px`,n.style.left=`${o}px`,t){const s=findCenter(i);r-=s.y-t.y,o-=s.x-t.x,window.setTimeout(()=>{n.style.top=`${r}px`,n.style.left=`${o}px`},0)}return n.style.margin="0",n.style.boxSizing="border-box",n.style.height=`${i.height}px`,n.style.width=`${i.width}px`,n.style.transition=`${trs("top")}, ${trs("left")}, ${trs("background-color")}, ${trs("opacity")}, ${trs("color")} `,window.setTimeout(()=>n.style.transition+=`, ${trs("width")}, ${trs("height")}`,0),n.style.zIndex="9999",n.style.cursor="grabbing",n}function moveDraggedElementToWasDroppedState(e){e.style.cursor="grab"}function morphDraggedElementToBeLike(e,t,i,n,r){const o=t.getBoundingClientRect(),s=e.getBoundingClientRect(),a=o.width-s.width,l=o.height-s.height;if(a||l){const c={left:(i-s.left)/s.width,top:(n-s.top)/s.height};e.style.height=`${o.height}px`,e.style.width=`${o.width}px`,e.style.left=`${parseFloat(e.style.left)-c.left*a}px`,e.style.top=`${parseFloat(e.style.top)-c.top*l}px`}copyStylesFromTo(t,e),r()}function copyStylesFromTo(e,t){const i=window.getComputedStyle(e);Array.from(i).filter(n=>n.startsWith("background")||n.startsWith("padding")||n.startsWith("font")||n.startsWith("text")||n.startsWith("align")||n.startsWith("justify")||n.startsWith("display")||n.startsWith("flex")||n.startsWith("border")||n==="opacity"||n==="color"||n==="list-style-type").forEach(n=>t.style.setProperty(n,i.getPropertyValue(n),i.getPropertyPriority(n)))}function styleDraggable(e,t){e.draggable=!1,e.ondragstart=()=>!1,t?(e.style.userSelect="",e.style.WebkitUserSelect="",e.style.cursor=""):(e.style.userSelect="none",e.style.WebkitUserSelect="none",e.style.cursor="grab")}function hideOriginalDragTarget(e){e.style.display="none",e.style.position="fixed",e.style.zIndex="-5"}function decorateShadowEl(e){e.style.visibility="hidden",e.setAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME,"true")}function unDecorateShadowElement(e){e.style.visibility="",e.removeAttribute(SHADOW_ELEMENT_ATTRIBUTE_NAME)}function styleActiveDropZones(e,t=()=>{},i=()=>[]){e.forEach(n=>{const r=t(n);Object.keys(r).forEach(o=>{n.style[o]=r[o]}),i(n).forEach(o=>n.classList.add(o))})}function styleInactiveDropZones(e,t=()=>{},i=()=>[]){e.forEach(n=>{const r=t(n);Object.keys(r).forEach(o=>{n.style[o]=""}),i(n).forEach(o=>n.classList.contains(o)&&n.classList.remove(o))})}function preventShrinking(e){const t=e.style.minHeight;e.style.minHeight=window.getComputedStyle(e).getPropertyValue("height");const i=e.style.minWidth;return e.style.minWidth=window.getComputedStyle(e).getPropertyValue("width"),function(){e.style.minHeight=t,e.style.minWidth=i}}const DEFAULT_DROP_ZONE_TYPE$1="--any--",MIN_OBSERVATION_INTERVAL_MS=100,MIN_MOVEMENT_BEFORE_DRAG_START_PX=3,DEFAULT_DROP_TARGET_STYLE$1={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let originalDragTarget,draggedEl,draggedElData,draggedElType,originDropZone,originIndex,shadowElData,shadowElDropZone,dragStartMousePosition,currentMousePosition,isWorkingOnPreviousDrag=!1,finalizingPreviousDrag=!1,unlockOriginDzMinDimensions,isDraggedOutsideOfAnyDz=!1;const typeToDropZones$1=new Map,dzToConfig$1=new Map,elToMouseDownListener=new WeakMap;function registerDropZone$1(e,t){typeToDropZones$1.has(t)||typeToDropZones$1.set(t,new Set),typeToDropZones$1.get(t).has(e)||(typeToDropZones$1.get(t).add(e),incrementActiveDropZoneCount())}function unregisterDropZone$1(e,t){typeToDropZones$1.get(t).delete(e),decrementActiveDropZoneCount(),typeToDropZones$1.get(t).size===0&&typeToDropZones$1.delete(t)}function watchDraggedElement(){armWindowScroller();const e=typeToDropZones$1.get(draggedElType);for(const i of e)i.addEventListener(DRAGGED_ENTERED_EVENT_NAME,handleDraggedEntered),i.addEventListener(DRAGGED_LEFT_EVENT_NAME,handleDraggedLeft),i.addEventListener(DRAGGED_OVER_INDEX_EVENT_NAME,handleDraggedIsOverIndex);window.addEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME,handleDrop$1);const t=Math.max(MIN_OBSERVATION_INTERVAL_MS,...Array.from(e.keys()).map(i=>dzToConfig$1.get(i).dropAnimationDurationMs));observe(draggedEl,e,t*1.07)}function unWatchDraggedElement(){disarmWindowScroller();const e=typeToDropZones$1.get(draggedElType);for(const t of e)t.removeEventListener(DRAGGED_ENTERED_EVENT_NAME,handleDraggedEntered),t.removeEventListener(DRAGGED_LEFT_EVENT_NAME,handleDraggedLeft),t.removeEventListener(DRAGGED_OVER_INDEX_EVENT_NAME,handleDraggedIsOverIndex);window.removeEventListener(DRAGGED_LEFT_DOCUMENT_EVENT_NAME,handleDrop$1),unobserve()}function findShadowPlaceHolderIdx(e){return e.findIndex(t=>t[ITEM_ID_KEY]===SHADOW_PLACEHOLDER_ITEM_ID)}function findShadowElementIdx(e){return e.findIndex(t=>!!t[SHADOW_ITEM_MARKER_PROPERTY_NAME]&&t[ITEM_ID_KEY]!==SHADOW_PLACEHOLDER_ITEM_ID)}function handleDraggedEntered(e){let{items:t,dropFromOthersDisabled:i}=dzToConfig$1.get(e.currentTarget);if(i&&e.currentTarget!==originDropZone)return;if(isDraggedOutsideOfAnyDz=!1,t=t.filter(s=>s[ITEM_ID_KEY]!==shadowElData[ITEM_ID_KEY]),originDropZone!==e.currentTarget){const a=dzToConfig$1.get(originDropZone).items.filter(l=>!l[SHADOW_ITEM_MARKER_PROPERTY_NAME]);dispatchConsiderEvent(originDropZone,a,{trigger:TRIGGERS.DRAGGED_ENTERED_ANOTHER,id:draggedElData[ITEM_ID_KEY],source:SOURCES.POINTER})}else{const s=findShadowPlaceHolderIdx(t);s!==-1&&t.splice(s,1)}const{index:n,isProximityBased:r}=e.detail.indexObj,o=r&&n===e.currentTarget.children.length-1?n+1:n;shadowElDropZone=e.currentTarget,t.splice(o,0,shadowElData),dispatchConsiderEvent(e.currentTarget,t,{trigger:TRIGGERS.DRAGGED_ENTERED,id:draggedElData[ITEM_ID_KEY],source:SOURCES.POINTER})}function handleDraggedLeft(e){if(!isWorkingOnPreviousDrag)return;const{items:t,dropFromOthersDisabled:i}=dzToConfig$1.get(e.currentTarget);if(i&&e.currentTarget!==originDropZone&&e.currentTarget!==shadowElDropZone)return;const n=findShadowElementIdx(t),r=t.splice(n,1)[0];shadowElDropZone=void 0;const{type:o,theOtherDz:s}=e.detail;if(o===DRAGGED_LEFT_TYPES.OUTSIDE_OF_ANY||o===DRAGGED_LEFT_TYPES.LEFT_FOR_ANOTHER&&s!==originDropZone&&dzToConfig$1.get(s).dropFromOthersDisabled){isDraggedOutsideOfAnyDz=!0,shadowElDropZone=originDropZone;const a=dzToConfig$1.get(originDropZone).items;a.splice(originIndex,0,r),dispatchConsiderEvent(originDropZone,a,{trigger:TRIGGERS.DRAGGED_LEFT_ALL,id:draggedElData[ITEM_ID_KEY],source:SOURCES.POINTER})}dispatchConsiderEvent(e.currentTarget,t,{trigger:TRIGGERS.DRAGGED_LEFT,id:draggedElData[ITEM_ID_KEY],source:SOURCES.POINTER})}function handleDraggedIsOverIndex(e){const{items:t,dropFromOthersDisabled:i}=dzToConfig$1.get(e.currentTarget);if(i&&e.currentTarget!==originDropZone)return;isDraggedOutsideOfAnyDz=!1;const{index:n}=e.detail.indexObj,r=findShadowElementIdx(t);t.splice(r,1),t.splice(n,0,shadowElData),dispatchConsiderEvent(e.currentTarget,t,{trigger:TRIGGERS.DRAGGED_OVER_INDEX,id:draggedElData[ITEM_ID_KEY],source:SOURCES.POINTER})}function handleMouseMove(e){e.preventDefault();const t=e.touches?e.touches[0]:e;currentMousePosition={x:t.clientX,y:t.clientY},draggedEl.style.transform=`translate3d(${currentMousePosition.x-dragStartMousePosition.x}px, ${currentMousePosition.y-dragStartMousePosition.y}px, 0)`}function handleDrop$1(){finalizingPreviousDrag=!0,window.removeEventListener("mousemove",handleMouseMove),window.removeEventListener("touchmove",handleMouseMove),window.removeEventListener("mouseup",handleDrop$1),window.removeEventListener("touchend",handleDrop$1),unWatchDraggedElement(),moveDraggedElementToWasDroppedState(draggedEl),shadowElDropZone||(shadowElDropZone=originDropZone);let{items:e,type:t}=dzToConfig$1.get(shadowElDropZone);styleInactiveDropZones(typeToDropZones$1.get(t),r=>dzToConfig$1.get(r).dropTargetStyle,r=>dzToConfig$1.get(r).dropTargetClasses);let i=findShadowElementIdx(e);i===-1&&(i=originIndex),e=e.map(r=>r[SHADOW_ITEM_MARKER_PROPERTY_NAME]?draggedElData:r);function n(){unlockOriginDzMinDimensions(),dispatchFinalizeEvent(shadowElDropZone,e,{trigger:isDraggedOutsideOfAnyDz?TRIGGERS.DROPPED_OUTSIDE_OF_ANY:TRIGGERS.DROPPED_INTO_ZONE,id:draggedElData[ITEM_ID_KEY],source:SOURCES.POINTER}),shadowElDropZone!==originDropZone&&dispatchFinalizeEvent(originDropZone,dzToConfig$1.get(originDropZone).items,{trigger:TRIGGERS.DROPPED_INTO_ANOTHER,id:draggedElData[ITEM_ID_KEY],source:SOURCES.POINTER}),unDecorateShadowElement(shadowElDropZone.children[i]),cleanupPostDrop()}animateDraggedToFinalPosition(i,n)}function animateDraggedToFinalPosition(e,t){const i=getBoundingRectNoTransforms(shadowElDropZone.children[e]),n={x:i.left-parseFloat(draggedEl.style.left),y:i.top-parseFloat(draggedEl.style.top)},{dropAnimationDurationMs:r}=dzToConfig$1.get(shadowElDropZone),o=`transform ${r}ms ease`;draggedEl.style.transition=draggedEl.style.transition?draggedEl.style.transition+","+o:o,draggedEl.style.transform=`translate3d(${n.x}px, ${n.y}px, 0)`,window.setTimeout(t,r)}function cleanupPostDrop(){draggedEl.remove(),originalDragTarget.remove(),draggedEl=void 0,originalDragTarget=void 0,draggedElData=void 0,draggedElType=void 0,originDropZone=void 0,originIndex=void 0,shadowElData=void 0,shadowElDropZone=void 0,dragStartMousePosition=void 0,currentMousePosition=void 0,isWorkingOnPreviousDrag=!1,finalizingPreviousDrag=!1,unlockOriginDzMinDimensions=void 0,isDraggedOutsideOfAnyDz=!1}function dndzone$2(e,t){const i={items:void 0,type:void 0,flipDurationMs:0,dragDisabled:!1,morphDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:DEFAULT_DROP_TARGET_STYLE$1,dropTargetClasses:[],transformDraggedElement:()=>{},centreDraggedOnCursor:!1};let n=new Map;function r(){window.addEventListener("mousemove",a,{passive:!1}),window.addEventListener("touchmove",a,{passive:!1,capture:!1}),window.addEventListener("mouseup",s,{passive:!1}),window.addEventListener("touchend",s,{passive:!1})}function o(){window.removeEventListener("mousemove",a),window.removeEventListener("touchmove",a),window.removeEventListener("mouseup",s),window.removeEventListener("touchend",s)}function s(){o(),originalDragTarget=void 0,dragStartMousePosition=void 0,currentMousePosition=void 0}function a(v){v.preventDefault();const p=v.touches?v.touches[0]:v;currentMousePosition={x:p.clientX,y:p.clientY},(Math.abs(currentMousePosition.x-dragStartMousePosition.x)>=MIN_MOVEMENT_BEFORE_DRAG_START_PX||Math.abs(currentMousePosition.y-dragStartMousePosition.y)>=MIN_MOVEMENT_BEFORE_DRAG_START_PX)&&(o(),c())}function l(v){if(v.target!==v.currentTarget&&(v.target.value!==void 0||v.target.isContentEditable)||v.button||isWorkingOnPreviousDrag)return;v.stopPropagation();const p=v.touches?v.touches[0]:v;dragStartMousePosition={x:p.clientX,y:p.clientY},currentMousePosition=Pe({},dragStartMousePosition),originalDragTarget=v.currentTarget,r()}function c(){isWorkingOnPreviousDrag=!0;const v=n.get(originalDragTarget);originIndex=v,originDropZone=originalDragTarget.parentElement;const p=originDropZone.getRootNode(),w=p.body||p,{items:E,type:b,centreDraggedOnCursor:u}=i;draggedElData=Pe({},E[v]),draggedElType=b,shadowElData=et(Pe({},draggedElData),{[SHADOW_ITEM_MARKER_PROPERTY_NAME]:!0});const m=et(Pe({},shadowElData),{[ITEM_ID_KEY]:SHADOW_PLACEHOLDER_ITEM_ID});draggedEl=createDraggedElementFrom(originalDragTarget,u&&currentMousePosition);function S(){draggedEl.parentElement?window.requestAnimationFrame(S):(w.appendChild(draggedEl),draggedEl.focus(),watchDraggedElement(),hideOriginalDragTarget(originalDragTarget),w.appendChild(originalDragTarget))}window.requestAnimationFrame(S),styleActiveDropZones(Array.from(typeToDropZones$1.get(i.type)).filter(x=>x===originDropZone||!dzToConfig$1.get(x).dropFromOthersDisabled),x=>dzToConfig$1.get(x).dropTargetStyle,x=>dzToConfig$1.get(x).dropTargetClasses),E.splice(v,1,m),unlockOriginDzMinDimensions=preventShrinking(originDropZone),dispatchConsiderEvent(originDropZone,E,{trigger:TRIGGERS.DRAG_STARTED,id:draggedElData[ITEM_ID_KEY],source:SOURCES.POINTER}),window.addEventListener("mousemove",handleMouseMove,{passive:!1}),window.addEventListener("touchmove",handleMouseMove,{passive:!1,capture:!1}),window.addEventListener("mouseup",handleDrop$1,{passive:!1}),window.addEventListener("touchend",handleDrop$1,{passive:!1})}function g({items:v=void 0,flipDurationMs:p=0,type:w=DEFAULT_DROP_ZONE_TYPE$1,dragDisabled:E=!1,morphDisabled:b=!1,dropFromOthersDisabled:u=!1,dropTargetStyle:m=DEFAULT_DROP_TARGET_STYLE$1,dropTargetClasses:S=[],transformDraggedElement:x=()=>{},centreDraggedOnCursor:D=!1}){i.dropAnimationDurationMs=p,i.type&&w!==i.type&&unregisterDropZone$1(e,i.type),i.type=w,registerDropZone$1(e,w),i.items=[...v],i.dragDisabled=E,i.morphDisabled=b,i.transformDraggedElement=x,i.centreDraggedOnCursor=D,isWorkingOnPreviousDrag&&!finalizingPreviousDrag&&(!areObjectsShallowEqual(m,i.dropTargetStyle)||!areArraysShallowEqualSameOrder(S,i.dropTargetClasses))&&(styleInactiveDropZones([e],()=>i.dropTargetStyle,()=>S),styleActiveDropZones([e],()=>m,()=>S)),i.dropTargetStyle=m,i.dropTargetClasses=[...S];function I(R,L){return dzToConfig$1.get(R)?dzToConfig$1.get(R)[L]:i[L]}isWorkingOnPreviousDrag&&i.dropFromOthersDisabled!==u&&(u?styleInactiveDropZones([e],R=>I(R,"dropTargetStyle"),R=>I(R,"dropTargetClasses")):styleActiveDropZones([e],R=>I(R,"dropTargetStyle"),R=>I(R,"dropTargetClasses"))),i.dropFromOthersDisabled=u,dzToConfig$1.set(e,i);const M=findShadowElementIdx(i.items);for(let R=0;R<e.children.length;R++){const L=e.children[R];if(styleDraggable(L,E),R===M){b||morphDraggedElementToBeLike(draggedEl,L,currentMousePosition.x,currentMousePosition.y,()=>i.transformDraggedElement(draggedEl,draggedElData,R)),decorateShadowEl(L);continue}L.removeEventListener("mousedown",elToMouseDownListener.get(L)),L.removeEventListener("touchstart",elToMouseDownListener.get(L)),E||(L.addEventListener("mousedown",l),L.addEventListener("touchstart",l),elToMouseDownListener.set(L,l)),n.set(L,R)}}return g(t),{update:v=>{g(v)},destroy:()=>{unregisterDropZone$1(e,i.type),dzToConfig$1.delete(e)}}}const INSTRUCTION_IDs$1={DND_ZONE_ACTIVE:"dnd-zone-active",DND_ZONE_DRAG_DISABLED:"dnd-zone-drag-disabled"},ID_TO_INSTRUCTION={[INSTRUCTION_IDs$1.DND_ZONE_ACTIVE]:"Tab to one the items and press space-bar or enter to start dragging it",[INSTRUCTION_IDs$1.DND_ZONE_DRAG_DISABLED]:"This is a disabled drag and drop list"},ALERT_DIV_ID="dnd-action-aria-alert";let alertsDiv;function initAriaOnBrowser(){alertsDiv=document.createElement("div"),function(){alertsDiv.id=ALERT_DIV_ID,alertsDiv.style.position="fixed",alertsDiv.style.bottom="0",alertsDiv.style.left="0",alertsDiv.style.zIndex="-5",alertsDiv.style.opacity="0",alertsDiv.style.height="0",alertsDiv.style.width="0",alertsDiv.setAttribute("role","alert")}(),document.body.prepend(alertsDiv),Object.entries(ID_TO_INSTRUCTION).forEach(([e,t])=>document.body.prepend(instructionToHiddenDiv(e,t)))}function initAria(){return isOnServer?null:(document.readyState==="complete"?initAriaOnBrowser():window.addEventListener("DOMContentLoaded",initAriaOnBrowser),Pe({},INSTRUCTION_IDs$1))}function instructionToHiddenDiv(e,t){const i=document.createElement("div");return i.id=e,i.innerHTML=`<p>${t}</p>`,i.style.display="none",i.style.position="fixed",i.style.zIndex="-5",i}function alertToScreenReader(e){alertsDiv.innerHTML="";const t=document.createTextNode(e);alertsDiv.appendChild(t),alertsDiv.style.display="none",alertsDiv.style.display="inline"}const DEFAULT_DROP_ZONE_TYPE="--any--",DEFAULT_DROP_TARGET_STYLE={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let isDragging=!1,draggedItemType,focusedDz,focusedDzLabel="",focusedItem,focusedItemId,focusedItemLabel="";const allDragTargets=new WeakSet,elToKeyDownListeners=new WeakMap,elToFocusListeners=new WeakMap,dzToHandles=new Map,dzToConfig=new Map,typeToDropZones=new Map,INSTRUCTION_IDs=initAria();function registerDropZone(e,t){typeToDropZones.size===0&&(window.addEventListener("keydown",globalKeyDownHandler),window.addEventListener("click",globalClickHandler)),typeToDropZones.has(t)||typeToDropZones.set(t,new Set),typeToDropZones.get(t).has(e)||(typeToDropZones.get(t).add(e),incrementActiveDropZoneCount())}function unregisterDropZone(e,t){focusedDz===e&&handleDrop(),typeToDropZones.get(t).delete(e),decrementActiveDropZoneCount(),typeToDropZones.get(t).size===0&&typeToDropZones.delete(t),typeToDropZones.size===0&&(window.removeEventListener("keydown",globalKeyDownHandler),window.removeEventListener("click",globalClickHandler))}function globalKeyDownHandler(e){if(!!isDragging)switch(e.key){case"Escape":{handleDrop();break}}}function globalClickHandler(){!isDragging||allDragTargets.has(document.activeElement)||handleDrop()}function handleZoneFocus(e){if(!isDragging)return;const t=e.currentTarget;if(t===focusedDz)return;focusedDzLabel=t.getAttribute("aria-label")||"";const{items:i}=dzToConfig.get(focusedDz),n=i.find(c=>c[ITEM_ID_KEY]===focusedItemId),r=i.indexOf(n),o=i.splice(r,1)[0],{items:s,autoAriaDisabled:a}=dzToConfig.get(t);t.getBoundingClientRect().top<focusedDz.getBoundingClientRect().top||t.getBoundingClientRect().left<focusedDz.getBoundingClientRect().left?(s.push(o),a||alertToScreenReader(`Moved item ${focusedItemLabel} to the end of the list ${focusedDzLabel}`)):(s.unshift(o),a||alertToScreenReader(`Moved item ${focusedItemLabel} to the beginning of the list ${focusedDzLabel}`)),dispatchFinalizeEvent(focusedDz,i,{trigger:TRIGGERS.DROPPED_INTO_ANOTHER,id:focusedItemId,source:SOURCES.KEYBOARD}),dispatchFinalizeEvent(t,s,{trigger:TRIGGERS.DROPPED_INTO_ZONE,id:focusedItemId,source:SOURCES.KEYBOARD}),focusedDz=t}function triggerAllDzsUpdate(){dzToHandles.forEach(({update:e},t)=>e(dzToConfig.get(t)))}function handleDrop(e=!0){dzToConfig.get(focusedDz).autoAriaDisabled||alertToScreenReader(`Stopped dragging item ${focusedItemLabel}`),allDragTargets.has(document.activeElement)&&document.activeElement.blur(),e&&dispatchConsiderEvent(focusedDz,dzToConfig.get(focusedDz).items,{trigger:TRIGGERS.DRAG_STOPPED,id:focusedItemId,source:SOURCES.KEYBOARD}),styleInactiveDropZones(typeToDropZones.get(draggedItemType),t=>dzToConfig.get(t).dropTargetStyle,t=>dzToConfig.get(t).dropTargetClasses),focusedItem=null,focusedItemId=null,focusedItemLabel="",draggedItemType=null,focusedDz=null,focusedDzLabel="",isDragging=!1,triggerAllDzsUpdate()}function dndzone$1(e,t){const i={items:void 0,type:void 0,dragDisabled:!1,zoneTabIndex:0,dropFromOthersDisabled:!1,dropTargetStyle:DEFAULT_DROP_TARGET_STYLE,dropTargetClasses:[],autoAriaDisabled:!1};function n(g,v,p){g.length<=1||g.splice(p,1,g.splice(v,1,g[p])[0])}function r(g){switch(g.key){case"Enter":case" ":{if((g.target.disabled!==void 0||g.target.href||g.target.isContentEditable)&&!allDragTargets.has(g.target))return;g.preventDefault(),g.stopPropagation(),isDragging?handleDrop():o(g);break}case"ArrowDown":case"ArrowRight":{if(!isDragging)return;g.preventDefault(),g.stopPropagation();const{items:v}=dzToConfig.get(e),p=Array.from(e.children),w=p.indexOf(g.currentTarget);w<p.length-1&&(i.autoAriaDisabled||alertToScreenReader(`Moved item ${focusedItemLabel} to position ${w+2} in the list ${focusedDzLabel}`),n(v,w,w+1),dispatchFinalizeEvent(e,v,{trigger:TRIGGERS.DROPPED_INTO_ZONE,id:focusedItemId,source:SOURCES.KEYBOARD}));break}case"ArrowUp":case"ArrowLeft":{if(!isDragging)return;g.preventDefault(),g.stopPropagation();const{items:v}=dzToConfig.get(e),w=Array.from(e.children).indexOf(g.currentTarget);w>0&&(i.autoAriaDisabled||alertToScreenReader(`Moved item ${focusedItemLabel} to position ${w} in the list ${focusedDzLabel}`),n(v,w,w-1),dispatchFinalizeEvent(e,v,{trigger:TRIGGERS.DROPPED_INTO_ZONE,id:focusedItemId,source:SOURCES.KEYBOARD}));break}}}function o(g){a(g.currentTarget),focusedDz=e,draggedItemType=i.type,isDragging=!0;const v=Array.from(typeToDropZones.get(i.type)).filter(p=>p===focusedDz||!dzToConfig.get(p).dropFromOthersDisabled);if(styleActiveDropZones(v,p=>dzToConfig.get(p).dropTargetStyle,p=>dzToConfig.get(p).dropTargetClasses),!i.autoAriaDisabled){let p=`Started dragging item ${focusedItemLabel}. Use the arrow keys to move it within its list ${focusedDzLabel}`;v.length>1&&(p+=", or tab to another list in order to move the item into it"),alertToScreenReader(p)}dispatchConsiderEvent(e,dzToConfig.get(e).items,{trigger:TRIGGERS.DRAG_STARTED,id:focusedItemId,source:SOURCES.KEYBOARD}),triggerAllDzsUpdate()}function s(g){!isDragging||g.currentTarget!==focusedItem&&(g.stopPropagation(),handleDrop(!1),o(g))}function a(g){const{items:v}=dzToConfig.get(e),p=Array.from(e.children),w=p.indexOf(g);focusedItem=g,focusedItem.tabIndex=0,focusedItemId=v[w][ITEM_ID_KEY],focusedItemLabel=p[w].getAttribute("aria-label")||""}function l({items:g=[],type:v=DEFAULT_DROP_ZONE_TYPE,dragDisabled:p=!1,zoneTabIndex:w=0,dropFromOthersDisabled:E=!1,dropTargetStyle:b=DEFAULT_DROP_TARGET_STYLE,dropTargetClasses:u=[],autoAriaDisabled:m=!1}){i.items=[...g],i.dragDisabled=p,i.dropFromOthersDisabled=E,i.zoneTabIndex=w,i.dropTargetStyle=b,i.dropTargetClasses=u,i.autoAriaDisabled=m,m||(e.setAttribute("aria-disabled",p),e.setAttribute("role","list"),e.setAttribute("aria-describedby",p?INSTRUCTION_IDs.DND_ZONE_DRAG_DISABLED:INSTRUCTION_IDs.DND_ZONE_ACTIVE)),i.type&&v!==i.type&&unregisterDropZone(e,i.type),i.type=v,registerDropZone(e,v),dzToConfig.set(e,i),isDragging?e.tabIndex=e===focusedDz||focusedItem.contains(e)||i.dropFromOthersDisabled||focusedDz&&i.type!==dzToConfig.get(focusedDz).type?-1:0:e.tabIndex=i.zoneTabIndex,e.addEventListener("focus",handleZoneFocus);for(let S=0;S<e.children.length;S++){const x=e.children[S];allDragTargets.add(x),x.tabIndex=isDragging?-1:0,m||x.setAttribute("role","listitem"),x.removeEventListener("keydown",elToKeyDownListeners.get(x)),x.removeEventListener("click",elToFocusListeners.get(x)),p||(x.addEventListener("keydown",r),elToKeyDownListeners.set(x,r),x.addEventListener("click",s),elToFocusListeners.set(x,s)),isDragging&&i.items[S][ITEM_ID_KEY]===focusedItemId&&(focusedItem=x,focusedItem.tabIndex=0,x.focus())}}l(t);const c={update:g=>{l(g)},destroy:()=>{unregisterDropZone(e,i.type),dzToConfig.delete(e),dzToHandles.delete(e)}};return dzToHandles.set(e,c),c}function dndzone(e,t){validateOptions(t);const i=dndzone$2(e,t),n=dndzone$1(e,t);return{update:r=>{validateOptions(r),i.update(r),n.update(r)},destroy:()=>{i.destroy(),n.destroy()}}}function validateOptions(e){const b=e,{items:t,flipDurationMs:i,type:n,dragDisabled:r,morphDisabled:o,dropFromOthersDisabled:s,zoneTabIndex:a,dropTargetStyle:l,dropTargetClasses:c,transformDraggedElement:g,autoAriaDisabled:v,centreDraggedOnCursor:p}=b,w=ct(b,["items","flipDurationMs","type","dragDisabled","morphDisabled","dropFromOthersDisabled","zoneTabIndex","dropTargetStyle","dropTargetClasses","transformDraggedElement","autoAriaDisabled","centreDraggedOnCursor"]);if(Object.keys(w).length>0&&console.warn("dndzone will ignore unknown options",w),!t)throw new Error("no 'items' key provided to dndzone");const E=t.find(u=>!{}.hasOwnProperty.call(u,ITEM_ID_KEY));if(E)throw new Error(`missing '${ITEM_ID_KEY}' property for item ${toString(E)}`);if(c&&!Array.isArray(c))throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof c}, ${toString(c)}`);if(a&&!isInt(a))throw new Error(`zoneTabIndex should be a number but instead it is a ${typeof a}, ${toString(a)}`)}function isInt(e){return!isNaN(e)&&function(t){return(t|0)===t}(parseFloat(e))}function flip(e,{from:t,to:i},n={}){const r=getComputedStyle(e),o=r.transform==="none"?"":r.transform,[s,a]=r.transformOrigin.split(" ").map(parseFloat),l=t.left+t.width*s/i.width-(i.left+s),c=t.top+t.height*a/i.height-(i.top+a),{delay:g=0,duration:v=w=>Math.sqrt(w)*120,easing:p=cubicOut}=n;return{delay:g,duration:is_function(v)?v(Math.sqrt(l*l+c*c)):v,easing:p,css:(w,E)=>{const b=E*l,u=E*c,m=w+E*t.width/i.width,S=w+E*t.height/i.height;return`transform: ${o} translate(${b}px, ${u}px) scale(${m}, ${S});`}}}export{photo as $,destroy_each as A,angleDoubleDown as B,run_all as C,onMount as D,binding_callbacks as E,afterUpdate as F,onDestroy as G,fix_position as H,Icon as I,create_animation as J,flip as K,action_destroyer as L,Modal as M,dndzone as N,OpenSeadragon as O,update_keyed_each as P,fix_and_destroy_block as Q,is_function as R,SvelteComponent as S,null_to_empty as T,destroy_block as U,set_input_value as V,getContext as W,bind$1 as X,add_flush_callback as Y,github as Z,home as _,attr as a,fileImageO as a0,fileText as a1,eyedropper as a2,cog as a3,insert as b,check_outros as c,text as d,element as e,append as f,group_outros as g,set_data as h,init as i,add_render_callback as j,create_in_transition as k,create_out_transition as l,detach as m,noop$3 as n,transition_in as o,empty as p,component_subscribe as q,fade as r,safe_not_equal as s,transition_out as t,create_component as u,space as v,writable as w,mount_component as x,listen as y,destroy_component as z};
